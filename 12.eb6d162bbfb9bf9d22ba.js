(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{1370:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(4),i=a(9),n=a(190),r=a(21);t.autoUpdateTimezone=function(e){var t=this;return function(a,o){return s.__awaiter(t,void 0,void 0,(function(){var t,l,c,d,u;return s.__generator(this,(function(m){return t=i.getCurrentUser(o()),l=n.getUserTimezone(o(),t.id),c=l.automaticTimezone!==e,l.useAutomaticTimezone&&c&&(d={useAutomaticTimezone:"true",automaticTimezone:e,manualTimezone:l.manualTimezone},u=s.__assign(s.__assign({},t),{timezone:d}),r.updateMe(u)(a,o)),[2]}))}))}}},1371:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return o}));var s=a(21),i=a(9);function n(e){return(t,a)=>{const n=Object(i.getCurrentUserId)(a());return t(s.updateUserMfa(n,!0,e))}}function r(){return(e,t)=>{const a=Object(i.getCurrentUserId)(t());return e(s.updateUserMfa(a,!1))}}function o(){return(e,t)=>{const a=Object(i.getCurrentUserId)(t());return e(s.generateMfaSecret(a))}}},1984:function(e,t,a){var s,i;
/*!
 * Bootstrap Colorpicker v2.5.2
 * https://itsjavi.com/bootstrap-colorpicker/
 *
 * Originally written by (c) 2012 Stefan Petre
 * Licensed under the Apache License v2.0
 * http://www.apache.org/licenses/LICENSE-2.0.txt
 *
 */s=[a(99)],void 0===(i=function(e){return function(e){"use strict";var t=function(a,s,i,n,r){this.fallbackValue=i?i&&void 0!==i.h?i:this.value={h:0,s:0,b:0,a:1}:null,this.fallbackFormat=n||"rgba",this.hexNumberSignPrefix=!0===r,this.value=this.fallbackValue,this.origFormat=null,this.predefinedColors=s||{},this.colors=e.extend({},t.webColors,this.predefinedColors),a&&(void 0!==a.h?this.value=a:this.setColor(String(a))),this.value||(this.value={h:0,s:0,b:0,a:1})};t.webColors={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32",transparent:"transparent"},t.prototype={constructor:t,colors:{},predefinedColors:{},getValue:function(){return this.value},setValue:function(e){this.value=e},_sanitizeNumber:function(e){return"number"==typeof e?e:isNaN(e)||null===e||""===e||void 0===e?1:""===e?0:void 0!==e.toLowerCase?(e.match(/^\./)&&(e="0"+e),Math.ceil(100*parseFloat(e))/100):1},isTransparent:function(e){return!(!e||!("string"==typeof e||e instanceof String))&&("transparent"===(e=e.toLowerCase().trim())||e.match(/#?00000000/)||e.match(/(rgba|hsla)\(0,0,0,0?\.?0\)/))},rgbaIsTransparent:function(e){return 0===e.r&&0===e.g&&0===e.b&&0===e.a},setColor:function(e){if(e=e.toLowerCase().trim()){if(this.isTransparent(e))return this.value={h:0,s:0,b:0,a:0},!0;var t=this.parse(e);t?(this.value=this.value={h:t.h,s:t.s,b:t.b,a:t.a},this.origFormat||(this.origFormat=t.format)):this.fallbackValue&&(this.value=this.fallbackValue)}return!1},setHue:function(e){this.value.h=1-e},setSaturation:function(e){this.value.s=e},setBrightness:function(e){this.value.b=1-e},setAlpha:function(e){this.value.a=Math.round(parseInt(100*(1-e),10)/100*100)/100},toRGB:function(e,t,a,s){var i,n,r,o,l;return 0===arguments.length&&(e=this.value.h,t=this.value.s,a=this.value.b,s=this.value.a),e=(e*=360)%360/60,i=n=r=a-(l=a*t),i+=[l,o=l*(1-Math.abs(e%2-1)),0,0,o,l][e=~~e],n+=[o,l,l,o,0,0][e],r+=[0,0,o,l,l,o][e],{r:Math.round(255*i),g:Math.round(255*n),b:Math.round(255*r),a:s}},toHex:function(e,t,a,s,i){arguments.length<=1&&(t=this.value.h,a=this.value.s,s=this.value.b,i=this.value.a);var n="#",r=this.toRGB(t,a,s,i);if(this.rgbaIsTransparent(r))return"transparent";e||(n=this.hexNumberSignPrefix?"#":"");var o=n+((1<<24)+(parseInt(r.r)<<16)+(parseInt(r.g)<<8)+parseInt(r.b)).toString(16).slice(1);return o},toHSL:function(e,t,a,s){0===arguments.length&&(e=this.value.h,t=this.value.s,a=this.value.b,s=this.value.a);var i=e,n=(2-t)*a,r=t*a;return r/=n>0&&n<=1?n:2-n,n/=2,r>1&&(r=1),{h:isNaN(i)?0:i,s:isNaN(r)?0:r,l:isNaN(n)?0:n,a:isNaN(s)?0:s}},toAlias:function(e,t,a,s){var i,n=0===arguments.length?this.toHex(!0):this.toHex(!0,e,t,a,s),r="alias"===this.origFormat?n:this.toString(!1,this.origFormat);for(var o in this.colors)if((i=this.colors[o].toLowerCase().trim())===n||i===r)return o;return!1},RGBtoHSB:function(e,t,a,s){var i,n,r,o;return e/=255,t/=255,a/=255,i=((i=0==(o=(r=Math.max(e,t,a))-Math.min(e,t,a))?null:r===e?(t-a)/o:r===t?(a-e)/o+2:(e-t)/o+4)+360)%6*60/360,n=0===o?0:o/r,{h:this._sanitizeNumber(i),s:n,b:r,a:this._sanitizeNumber(s)}},HueToRGB:function(e,t,a){return a<0?a+=1:a>1&&(a-=1),6*a<1?e+(t-e)*a*6:2*a<1?t:3*a<2?e+(t-e)*(2/3-a)*6:e},HSLtoRGB:function(e,t,a,s){var i;t<0&&(t=0);var n=2*a-(i=a<=.5?a*(1+t):a+t-a*t),r=e+1/3,o=e,l=e-1/3;return[Math.round(255*this.HueToRGB(n,i,r)),Math.round(255*this.HueToRGB(n,i,o)),Math.round(255*this.HueToRGB(n,i,l)),this._sanitizeNumber(s)]},parse:function(t){if(0===arguments.length)return!1;var a,s,i=this,n=!1,r=void 0!==this.colors[t];return r&&(t=this.colors[t].toLowerCase().trim()),e.each(this.stringParsers,(function(e,o){var l=o.re.exec(t);return!(a=l&&o.parse.apply(i,[l]))||(n={},s=r?"alias":o.format?o.format:i.getValidFallbackFormat(),(n=s.match(/hsla?/)?i.RGBtoHSB.apply(i,i.HSLtoRGB.apply(i,a)):i.RGBtoHSB.apply(i,a))instanceof Object&&(n.format=s),!1)})),n},getValidFallbackFormat:function(){var e=["rgba","rgb","hex","hsla","hsl"];return this.origFormat&&-1!==e.indexOf(this.origFormat)?this.origFormat:this.fallbackFormat&&-1!==e.indexOf(this.fallbackFormat)?this.fallbackFormat:"rgba"},toString:function(e,a,s){s=s||!1;var i=!1;switch(a=a||this.origFormat||this.fallbackFormat){case"rgb":return i=this.toRGB(),this.rgbaIsTransparent(i)?"transparent":"rgb("+i.r+","+i.g+","+i.b+")";case"rgba":return"rgba("+(i=this.toRGB()).r+","+i.g+","+i.b+","+i.a+")";case"hsl":return i=this.toHSL(),"hsl("+Math.round(360*i.h)+","+Math.round(100*i.s)+"%,"+Math.round(100*i.l)+"%)";case"hsla":return i=this.toHSL(),"hsla("+Math.round(360*i.h)+","+Math.round(100*i.s)+"%,"+Math.round(100*i.l)+"%,"+i.a+")";case"hex":return this.toHex(e);case"alias":return!1===(i=this.toAlias())?this.toString(e,this.getValidFallbackFormat()):s&&!(i in t.webColors)&&i in this.predefinedColors?this.predefinedColors[i]:i;default:return i}},stringParsers:[{re:/rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*?\)/,format:"rgb",parse:function(e){return[e[1],e[2],e[3],1]}},{re:/rgb\(\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*?\)/,format:"rgb",parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],1]}},{re:/rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"rgba",parse:function(e){return[e[1],e[2],e[3],e[4]]}},{re:/rgba\(\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"rgba",parse:function(e){return[2.55*e[1],2.55*e[2],2.55*e[3],e[4]]}},{re:/hsl\(\s*(\d*(?:\.\d+)?)\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*?\)/,format:"hsl",parse:function(e){return[e[1]/360,e[2]/100,e[3]/100,e[4]]}},{re:/hsla\(\s*(\d*(?:\.\d+)?)\s*,\s*(\d*(?:\.\d+)?)\%\s*,\s*(\d*(?:\.\d+)?)\%\s*(?:,\s*(\d*(?:\.\d+)?)\s*)?\)/,format:"hsla",parse:function(e){return[e[1]/360,e[2]/100,e[3]/100,e[4]]}},{re:/#?([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,format:"hex",parse:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),1]}},{re:/#?([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,format:"hex",parse:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),1]}}],colorNameToHex:function(e){return void 0!==this.colors[e.toLowerCase()]&&this.colors[e.toLowerCase()]}};var a={horizontal:!1,inline:!1,color:!1,format:!1,input:"input",container:!1,component:".add-on, .input-group-addon",fallbackColor:!1,fallbackFormat:"hex",hexNumberSignPrefix:!0,sliders:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setBrightness"},hue:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setHue"},alpha:{maxLeft:0,maxTop:100,callLeft:!1,callTop:"setAlpha"}},slidersHorz:{saturation:{maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setBrightness"},hue:{maxLeft:100,maxTop:0,callLeft:"setHue",callTop:!1},alpha:{maxLeft:100,maxTop:0,callLeft:"setAlpha",callTop:!1}},template:'<div class="colorpicker dropdown-menu"><div class="colorpicker-saturation"><i><b></b></i></div><div class="colorpicker-hue"><i></i></div><div class="colorpicker-alpha"><i></i></div><div class="colorpicker-color"><div /></div><div class="colorpicker-selectors"></div></div>',align:"right",customClass:null,colorSelectors:null},s=function(t,s){this.element=e(t).addClass("colorpicker-element"),this.options=e.extend(!0,{},a,this.element.data(),s),this.component=this.options.component,this.component=!1!==this.component&&this.element.find(this.component),this.component&&0===this.component.length&&(this.component=!1),this.container=!0===this.options.container?this.element:this.options.container,this.container=!1!==this.container&&e(this.container),this.input=this.element.is("input")?this.element:!!this.options.input&&this.element.find(this.options.input),this.input&&0===this.input.length&&(this.input=!1),this.color=this.createColor(!1!==this.options.color?this.options.color:this.getValue()),this.format=!1!==this.options.format?this.options.format:this.color.origFormat,!1!==this.options.color&&(this.updateInput(this.color),this.updateData(this.color)),this.disabled=!1;var i=this.picker=e(this.options.template);if(this.options.customClass&&i.addClass(this.options.customClass),this.options.inline?i.addClass("colorpicker-inline colorpicker-visible"):i.addClass("colorpicker-hidden"),this.options.horizontal&&i.addClass("colorpicker-horizontal"),-1===["rgba","hsla","alias"].indexOf(this.format)&&!1!==this.options.format&&"transparent"!==this.getValue()||i.addClass("colorpicker-with-alpha"),"right"===this.options.align&&i.addClass("colorpicker-right"),!0===this.options.inline&&i.addClass("colorpicker-no-arrow"),this.options.colorSelectors){var n=this,r=n.picker.find(".colorpicker-selectors");r.length>0&&(e.each(this.options.colorSelectors,(function(t,a){var s=e("<i />").addClass("colorpicker-selectors-color").css("background-color",a).data("class",t).data("alias",t);s.on("mousedown.colorpicker touchstart.colorpicker",(function(t){t.preventDefault(),n.setValue("alias"===n.format?e(this).data("alias"):e(this).css("background-color"))})),r.append(s)})),r.show().addClass("colorpicker-visible"))}i.on("mousedown.colorpicker touchstart.colorpicker",e.proxy((function(e){e.target===e.currentTarget&&e.preventDefault()}),this)),i.find(".colorpicker-saturation, .colorpicker-hue, .colorpicker-alpha").on("mousedown.colorpicker touchstart.colorpicker",e.proxy(this.mousedown,this)),i.appendTo(this.container?this.container:e("body")),!1!==this.input&&(this.input.on({"keyup.colorpicker":e.proxy(this.keyup,this)}),this.input.on({"change.colorpicker":e.proxy(this.change,this)}),!1===this.component&&this.element.on({"focus.colorpicker":e.proxy(this.show,this)}),!1===this.options.inline&&this.element.on({"focusout.colorpicker":e.proxy(this.hide,this)})),!1!==this.component&&this.component.on({"click.colorpicker":e.proxy(this.show,this)}),!1===this.input&&!1===this.component&&this.element.on({"click.colorpicker":e.proxy(this.show,this)}),!1!==this.input&&!1!==this.component&&"color"===this.input.attr("type")&&this.input.on({"click.colorpicker":e.proxy(this.show,this),"focus.colorpicker":e.proxy(this.show,this)}),this.update(),e(e.proxy((function(){this.element.trigger("create")}),this))};s.Color=t,s.prototype={constructor:s,destroy:function(){this.picker.remove(),this.element.removeData("colorpicker","color").off(".colorpicker"),!1!==this.input&&this.input.off(".colorpicker"),!1!==this.component&&this.component.off(".colorpicker"),this.element.removeClass("colorpicker-element"),this.element.trigger({type:"destroy"})},reposition:function(){if(!1!==this.options.inline||this.options.container)return!1;var e=this.container&&this.container[0]!==window.document.body?"position":"offset",t=this.component||this.element,a=t[e]();"right"===this.options.align&&(a.left-=this.picker.outerWidth()-t.outerWidth()),this.picker.css({top:a.top+t.outerHeight(),left:a.left})},show:function(t){this.isDisabled()||(this.picker.addClass("colorpicker-visible").removeClass("colorpicker-hidden"),this.reposition(),e(window).on("resize.colorpicker",e.proxy(this.reposition,this)),!t||this.hasInput()&&"color"!==this.input.attr("type")||t.stopPropagation&&t.preventDefault&&(t.stopPropagation(),t.preventDefault()),!this.component&&this.input||!1!==this.options.inline||e(window.document).on({"mousedown.colorpicker":e.proxy(this.hide,this)}),this.element.trigger({type:"showPicker",color:this.color}))},hide:function(t){if(void 0!==t&&t.target&&(e(t.currentTarget).parents(".colorpicker").length>0||e(t.target).parents(".colorpicker").length>0))return!1;this.picker.addClass("colorpicker-hidden").removeClass("colorpicker-visible"),e(window).off("resize.colorpicker",this.reposition),e(window.document).off({"mousedown.colorpicker":this.hide}),this.update(),this.element.trigger({type:"hidePicker",color:this.color})},updateData:function(e){return e=e||this.color.toString(!1,this.format),this.element.data("color",e),e},updateInput:function(e){return e=e||this.color.toString(!1,this.format),!1!==this.input&&(this.input.prop("value",e),this.input.trigger("change")),e},updatePicker:function(e){void 0!==e&&(this.color=this.createColor(e));var t=!1===this.options.horizontal?this.options.sliders:this.options.slidersHorz,a=this.picker.find("i");if(0!==a.length)return!1===this.options.horizontal?(t=this.options.sliders,a.eq(1).css("top",t.hue.maxTop*(1-this.color.value.h)).end().eq(2).css("top",t.alpha.maxTop*(1-this.color.value.a))):(t=this.options.slidersHorz,a.eq(1).css("left",t.hue.maxLeft*(1-this.color.value.h)).end().eq(2).css("left",t.alpha.maxLeft*(1-this.color.value.a))),a.eq(0).css({top:t.saturation.maxTop-this.color.value.b*t.saturation.maxTop,left:this.color.value.s*t.saturation.maxLeft}),this.picker.find(".colorpicker-saturation").css("backgroundColor",this.color.toHex(!0,this.color.value.h,1,1,1)),this.picker.find(".colorpicker-alpha").css("backgroundColor",this.color.toHex(!0)),this.picker.find(".colorpicker-color, .colorpicker-color div").css("backgroundColor",this.color.toString(!0,this.format)),e},updateComponent:function(e){var t;if(t=void 0!==e?this.createColor(e):this.color,!1!==this.component){var a=this.component.find("i").eq(0);a.length>0?a.css({backgroundColor:t.toString(!0,this.format)}):this.component.css({backgroundColor:t.toString(!0,this.format)})}return t.toString(!1,this.format)},update:function(e){var t;return!1===this.getValue(!1)&&!0!==e||(t=this.updateComponent(),this.updateInput(t),this.updateData(t),this.updatePicker()),t},setValue:function(e){this.color=this.createColor(e),this.update(!0),this.element.trigger({type:"changeColor",color:this.color,value:e})},createColor:function(e){return new t(e||null,this.options.colorSelectors,this.options.fallbackColor?this.options.fallbackColor:this.color,this.options.fallbackFormat,this.options.hexNumberSignPrefix)},getValue:function(e){var t;return e=void 0===e?this.options.fallbackColor:e,void 0!==(t=this.hasInput()?this.input.val():this.element.data("color"))&&""!==t&&null!==t||(t=e),t},hasInput:function(){return!1!==this.input},isDisabled:function(){return this.disabled},disable:function(){return this.hasInput()&&this.input.prop("disabled",!0),this.disabled=!0,this.element.trigger({type:"disable",color:this.color,value:this.getValue()}),!0},enable:function(){return this.hasInput()&&this.input.prop("disabled",!1),this.disabled=!1,this.element.trigger({type:"enable",color:this.color,value:this.getValue()}),!0},currentSlider:null,mousePointer:{left:0,top:0},mousedown:function(t){!t.pageX&&!t.pageY&&t.originalEvent&&t.originalEvent.touches&&(t.pageX=t.originalEvent.touches[0].pageX,t.pageY=t.originalEvent.touches[0].pageY),t.stopPropagation(),t.preventDefault();var a=e(t.target).closest("div"),s=this.options.horizontal?this.options.slidersHorz:this.options.sliders;if(!a.is(".colorpicker")){if(a.is(".colorpicker-saturation"))this.currentSlider=e.extend({},s.saturation);else if(a.is(".colorpicker-hue"))this.currentSlider=e.extend({},s.hue);else{if(!a.is(".colorpicker-alpha"))return!1;this.currentSlider=e.extend({},s.alpha)}var i=a.offset();this.currentSlider.guide=a.find("i")[0].style,this.currentSlider.left=t.pageX-i.left,this.currentSlider.top=t.pageY-i.top,this.mousePointer={left:t.pageX,top:t.pageY},e(window.document).on({"mousemove.colorpicker":e.proxy(this.mousemove,this),"touchmove.colorpicker":e.proxy(this.mousemove,this),"mouseup.colorpicker":e.proxy(this.mouseup,this),"touchend.colorpicker":e.proxy(this.mouseup,this)}).trigger("mousemove")}return!1},mousemove:function(e){!e.pageX&&!e.pageY&&e.originalEvent&&e.originalEvent.touches&&(e.pageX=e.originalEvent.touches[0].pageX,e.pageY=e.originalEvent.touches[0].pageY),e.stopPropagation(),e.preventDefault();var t=Math.max(0,Math.min(this.currentSlider.maxLeft,this.currentSlider.left+((e.pageX||this.mousePointer.left)-this.mousePointer.left))),a=Math.max(0,Math.min(this.currentSlider.maxTop,this.currentSlider.top+((e.pageY||this.mousePointer.top)-this.mousePointer.top)));return this.currentSlider.guide.left=t+"px",this.currentSlider.guide.top=a+"px",this.currentSlider.callLeft&&this.color[this.currentSlider.callLeft].call(this.color,t/this.currentSlider.maxLeft),this.currentSlider.callTop&&this.color[this.currentSlider.callTop].call(this.color,a/this.currentSlider.maxTop),!1!==this.options.format||"setAlpha"!==this.currentSlider.callTop&&"setAlpha"!==this.currentSlider.callLeft||(1!==this.color.value.a?(this.format="rgba",this.color.origFormat="rgba"):(this.format="hex",this.color.origFormat="hex")),this.update(!0),this.element.trigger({type:"changeColor",color:this.color}),!1},mouseup:function(t){return t.stopPropagation(),t.preventDefault(),e(window.document).off({"mousemove.colorpicker":this.mousemove,"touchmove.colorpicker":this.mousemove,"mouseup.colorpicker":this.mouseup,"touchend.colorpicker":this.mouseup}),!1},change:function(e){this.keyup(e)},keyup:function(e){38===e.keyCode?(this.color.value.a<1&&(this.color.value.a=Math.round(100*(this.color.value.a+.01))/100),this.update(!0)):40===e.keyCode?(this.color.value.a>0&&(this.color.value.a=Math.round(100*(this.color.value.a-.01))/100),this.update(!0)):(this.color=this.createColor(this.input.val()),this.color.origFormat&&!1===this.options.format&&(this.format=this.color.origFormat),!1!==this.getValue(!1)&&(this.updateData(),this.updateComponent(),this.updatePicker())),this.element.trigger({type:"changeColor",color:this.color,value:this.input.val()})}},e.colorpicker=s,e.fn.colorpicker=function(t){var a=Array.prototype.slice.call(arguments,1),i=1===this.length,n=null,r=this.each((function(){var i=e(this),r=i.data("colorpicker");r||(r=new s(this,"object"==typeof t?t:{}),i.data("colorpicker",r)),"string"==typeof t?e.isFunction(r[t])?n=r[t].apply(r,a):(a.length&&(r[t]=a[0]),n=r[t]):n=i}));return i?n:r},e.fn.colorpicker.constructor=s}(e)}.apply(t,s))||(e.exports=i)},1985:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(10);t.getEmailInterval=function(e,t,a){var i=s.Preferences.INTERVAL_NEVER,n=s.Preferences.INTERVAL_IMMEDIATE,r=s.Preferences.INTERVAL_FIFTEEN_MINUTES,o=s.Preferences.INTERVAL_HOUR,l=[n,i];return e?t&&-1===[n,i,r,o].indexOf(a)?r:t||-1!==l.indexOf(a)?e&&a===i?n:a:n:i}},2019:function(e,t,a){"use strict";a.r(t);var s=a(323),i=a(9),n=a(34),r=a.n(n),o=a(6),l=a.n(o),c=a(11),d=a(15),u=a(20),m=a(75),h=a(21),p=a(0),g=(a(56),a(36),a(1131)),f=a(1144),b=a(14),E=a(27),v=a(1160),S=a(1172),y=a(1146),k=a(1251),C=a(10);function N(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class _ extends l.a.PureComponent{constructor(e){super(e),N(this,"handleOnChange",e=>{const t=e.currentTarget.value;this.setState({joinLeaveState:t})}),N(this,"handleUpdateSection",e=>{e||this.setState({joinLeaveState:this.props.joinLeave}),this.props.onUpdateSection(e)}),N(this,"handleSubmit",()=>{const{actions:e,currentUserId:t,onUpdateSection:a}=this.props,s={category:C.Preferences.CATEGORY_ADVANCED_SETTINGS,user_id:t,name:C.Preferences.ADVANCED_FILTER_JOIN_LEAVE,value:this.state.joinLeaveState};e.savePreferences(t,[s]),a()}),this.state={joinLeaveState:e.joinLeave}}render(){const{joinLeaveState:e}=this.state;return this.props.activeSection===p.g.JOIN_LEAVE?l.a.createElement(v.a,{title:l.a.createElement(g.a,{id:"user.settings.advance.joinLeaveTitle",defaultMessage:"Enable Join/Leave Messages"}),inputs:[l.a.createElement("fieldset",{key:"joinLeaveSetting"},l.a.createElement("legend",{className:"form-legend hidden-label"},l.a.createElement(g.a,{id:"user.settings.advance.joinLeaveTitle",defaultMessage:"Enable Join/Leave Messages"})),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"joinLeaveOn",type:"radio",value:"true",name:p.g.JOIN_LEAVE,checked:"true"===e,onChange:this.handleOnChange}),l.a.createElement(g.a,{id:"user.settings.advance.on",defaultMessage:"On"})),l.a.createElement("br",null)),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"joinLeaveOff",type:"radio",value:"false",name:p.g.JOIN_LEAVE,checked:"false"===e,onChange:this.handleOnChange}),l.a.createElement(g.a,{id:"user.settings.advance.off",defaultMessage:"Off"})),l.a.createElement("br",null)),l.a.createElement("div",{className:"mt-5"},l.a.createElement(g.a,{id:"user.settings.advance.joinLeaveDesc",defaultMessage:'When "On", System Messages saying a user has joined or left a channel will be visible. When "Off", the System Messages about joining or leaving a channel will be hidden. A message will still show up when you are added to a channel, so you can receive a notification.'})))],setting:p.g.JOIN_LEAVE,submit:this.handleSubmit,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.handleUpdateSection}):l.a.createElement(S.a,{title:l.a.createElement(g.a,{id:"user.settings.advance.joinLeaveTitle",defaultMessage:"Enable Join/Leave Messages"}),describe:this.props.renderOnOffLabel(e),section:p.g.JOIN_LEAVE,updateSection:this.handleUpdateSection})}}N(_,"propTypes",{activeSection:r.a.string,currentUserId:r.a.string.isRequired,joinLeave:r.a.string,onUpdateSection:r.a.func.isRequired,renderOnOffLabel:r.a.func.isRequired,actions:r.a.shape({savePreferences:r.a.func.isRequired}).isRequired});var M=Object(s.connect)((function(e){const t=Object(u.get)(e,C.Preferences.CATEGORY_ADVANCED_SETTINGS,C.Preferences.ADVANCED_FILTER_JOIN_LEAVE,"true");return{currentUserId:Object(i.getCurrentUserId)(e),joinLeave:t}}),(function(e){return{actions:Object(c.bindActionCreators)({savePreferences:m.savePreferences},e)}}))(_);function T(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const O=p.Q.PRE_RELEASE_FEATURES;class w extends l.a.PureComponent{constructor(e){super(e),T(this,"getStateFromProps",()=>{const e=this.props.advancedSettingsCategory,t={send_on_ctrl_enter:this.props.sendOnCtrlEnter,code_block_ctrl_enter:this.props.codeBlockOnCtrlEnter,formatting:this.props.formatting,join_leave:this.props.joinLeave},a=Object.keys(O);let s=0;for(const i of e)for(const e of a){const a=O[e];i.name===p.Q.FeatureTogglePrefix+a.label&&(t[i.name]=i.value,"true"===i.value&&(s+=1))}const i=this.props.enablePreviewFeatures;return{preReleaseFeatures:O,settings:t,preReleaseFeaturesKeys:a,enabledFeatures:s,isSaving:!1,previewFeaturesEnabled:i,showDeactivateAccountModal:!1}}),T(this,"updateSetting",(e,t)=>{const a=this.state.settings;a[e]=t,this.setState(a)}),T(this,"toggleFeature",(e,t)=>{const a=this.state.settings;a[p.Q.FeatureTogglePrefix+e]=String(t);let s=0;Object.keys(this.state.settings).forEach(e=>{0===e.lastIndexOf(p.Q.FeatureTogglePrefix)&&"true"===this.state.settings[e]&&s++}),this.setState({settings:a,enabledFeatures:s})}),T(this,"saveEnabledFeatures",()=>{const e=[];Object.keys(this.state.settings).forEach(t=>{0===t.lastIndexOf(p.Q.FeatureTogglePrefix)&&e.push(t)}),this.handleSubmit(e)}),T(this,"handleSubmit",async e=>{const t=[],{actions:a,currentUser:s}=this.props,i=s.id;(Array.isArray(e)?e:[e]).forEach(e=>{t.push({user_id:i,category:p.Q.Preferences.CATEGORY_ADVANCED_SETTINGS,name:e,value:this.state.settings[e]})}),this.setState({isSaving:!0}),await a.savePreferences(i,t),this.handleUpdateSection("")}),T(this,"handleDeactivateAccountSubmit",async()=>{const e=this.props.currentUser.id;this.setState({isSaving:!0}),this.props.actions.updateUserActive(e,!1).then(({error:e})=>{e&&this.setState({serverError:e.message})});const{data:t,error:a}=await this.props.actions.revokeAllSessionsForUser(e);t?Object(f.e)():a&&this.setState({serverError:a.message})}),T(this,"handleShowDeactivateAccountModal",()=>{this.setState({showDeactivateAccountModal:!0})}),T(this,"handleHideDeactivateAccountModal",()=>{this.setState({showDeactivateAccountModal:!1})}),T(this,"handleUpdateSection",e=>{e||this.setState(this.getStateFromProps()),this.setState({isSaving:!1}),this.props.updateSection(e)}),T(this,"getCtrlSendText",()=>{const e={default:{id:Object(E.b)("user.settings.advance.sendDesc"),defaultMessage:"When enabled, CTRL + ENTER will send the message and ENTER inserts a new line."},mac:{id:Object(E.b)("user.settings.advance.sendDesc.mac"),defaultMessage:"When enabled, ⌘ + ENTER will send the message and ENTER inserts a new line."}},t={default:{id:Object(E.b)("user.settings.advance.sendTitle"),defaultMessage:"Send Messages on CTRL+ENTER"},mac:{id:Object(E.b)("user.settings.advance.sendTitle.mac"),defaultMessage:"Send Messages on ⌘+ENTER"}};return b.Z()?{ctrlSendTitle:t.mac,ctrlSendDesc:e.mac}:{ctrlSendTitle:t.default,ctrlSendDesc:e.default}}),T(this,"renderFormattingSection",()=>"formatting"===this.props.activeSection?l.a.createElement(v.a,{title:l.a.createElement(g.a,{id:"user.settings.advance.formattingTitle",defaultMessage:"Enable Post Formatting"}),inputs:[l.a.createElement("fieldset",{key:"formattingSetting"},l.a.createElement("legend",{className:"form-legend hidden-label"},l.a.createElement(g.a,{id:"user.settings.advance.formattingTitle",defaultMessage:"Enable Post Formatting"})),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"postFormattingOn",type:"radio",name:"formatting",checked:"false"!==this.state.settings.formatting,onChange:this.updateSetting.bind(this,"formatting","true")}),l.a.createElement(g.a,{id:"user.settings.advance.on",defaultMessage:"On"})),l.a.createElement("br",null)),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"postFormattingOff",type:"radio",name:"formatting",checked:"false"===this.state.settings.formatting,onChange:this.updateSetting.bind(this,"formatting","false")}),l.a.createElement(g.a,{id:"user.settings.advance.off",defaultMessage:"Off"})),l.a.createElement("br",null)),l.a.createElement("div",{className:"mt-5"},l.a.createElement(g.a,{id:"user.settings.advance.formattingDesc",defaultMessage:"If enabled, posts will be formatted to create links, show emoji, style the text, and add line breaks. By default, this setting is enabled."})))],setting:"formatting",submit:this.handleSubmit,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.handleUpdateSection}):l.a.createElement(S.a,{title:l.a.createElement(g.a,{id:"user.settings.advance.formattingTitle",defaultMessage:"Enable Post Formatting"}),describe:this.renderOnOffLabel(this.state.settings.formatting),section:"formatting",updateSection:this.handleUpdateSection})),this.state=this.getStateFromProps()}renderOnOffLabel(e){return"false"===e?l.a.createElement(g.a,{id:"user.settings.advance.off",defaultMessage:"Off"}):l.a.createElement(g.a,{id:"user.settings.advance.on",defaultMessage:"On"})}renderCtrlEnterLabel(){const e=this.state.settings.send_on_ctrl_enter,t=this.state.settings.code_block_ctrl_enter;return"false"===e&&"false"===t?l.a.createElement(g.a,{id:"user.settings.advance.off",defaultMessage:"Off"}):"true"===e&&"true"===t?l.a.createElement(g.a,{id:"user.settings.advance.onForAllMessages",defaultMessage:"On for all messages"}):l.a.createElement(g.a,{id:"user.settings.advance.onForCode",defaultMessage:"On only for code blocks starting with ```"})}renderFeatureLabel(e){switch(e){case"MARKDOWN_PREVIEW":return l.a.createElement(g.a,{id:"user.settings.advance.markdown_preview",defaultMessage:"Show markdown preview option in message input box"});default:return null}}render(){const e=this.state.serverError||null;let t;const{ctrlSendTitle:a,ctrlSendDesc:s}=this.getCtrlSendText();if("advancedCtrlSend"===this.props.activeSection){const i=["true"===this.state.settings.send_on_ctrl_enter,"false"===this.state.settings.send_on_ctrl_enter&&"true"===this.state.settings.code_block_ctrl_enter,"false"===this.state.settings.send_on_ctrl_enter&&"false"===this.state.settings.code_block_ctrl_enter],n=[l.a.createElement("fieldset",{key:"ctrlSendSetting"},l.a.createElement("legend",{className:"form-legend hidden-label"},l.a.createElement(g.a,a)),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"ctrlSendOn",type:"radio",name:"sendOnCtrlEnter",checked:i[0],onChange:()=>{this.updateSetting("send_on_ctrl_enter","true"),this.updateSetting("code_block_ctrl_enter","true")}}),l.a.createElement(g.a,{id:"user.settings.advance.onForAllMessages",defaultMessage:"On for all messages"})),l.a.createElement("br",null)),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"ctrlSendOnForCode",type:"radio",name:"sendOnCtrlEnter",checked:i[1],onChange:()=>{this.updateSetting("send_on_ctrl_enter","false"),this.updateSetting("code_block_ctrl_enter","true")}}),l.a.createElement(g.a,{id:"user.settings.advance.onForCode",defaultMessage:"On only for code blocks starting with ```"})),l.a.createElement("br",null)),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"ctrlSendOff",type:"radio",name:"sendOnCtrlEnter",checked:i[2],onChange:()=>{this.updateSetting("send_on_ctrl_enter","false"),this.updateSetting("code_block_ctrl_enter","false")}}),l.a.createElement(g.a,{id:"user.settings.advance.off",defaultMessage:"Off"})),l.a.createElement("br",null)),l.a.createElement("div",null,l.a.createElement("br",null),l.a.createElement(g.a,s)))];t=l.a.createElement(v.a,{title:l.a.createElement(g.a,a),inputs:n,submit:this.handleSubmit.bind(this,["send_on_ctrl_enter","code_block_ctrl_enter"]),saving:this.state.isSaving,server_error:e,updateSection:this.handleUpdateSection})}else t=l.a.createElement(S.a,{title:l.a.createElement(g.a,a),describe:this.renderCtrlEnterLabel(),section:"advancedCtrlSend",updateSection:this.handleUpdateSection});const i=this.renderFormattingSection();let n,r,o=null;if(i&&(o=l.a.createElement("div",{className:"divider-light"})),this.state.previewFeaturesEnabled&&this.state.preReleaseFeaturesKeys.length>0)if(r=l.a.createElement("div",{className:"divider-light"}),"advancedPreviewFeatures"===this.props.activeSection){const t=[];this.state.preReleaseFeaturesKeys.forEach(e=>{const a=this.state.preReleaseFeatures[e];t.push(l.a.createElement("div",{key:"advancedPreviewFeatures_"+a.label},l.a.createElement("div",{className:"checkbox"},l.a.createElement("label",null,l.a.createElement("input",{id:"advancedPreviewFeatures"+a.label,type:"checkbox",checked:"true"===this.state.settings[p.Q.FeatureTogglePrefix+a.label],onChange:e=>{this.toggleFeature(a.label,e.target.checked)}}),this.renderFeatureLabel(e)))))}),t.push(l.a.createElement("div",{key:"advancedPreviewFeatures_helptext"},l.a.createElement("br",null),l.a.createElement(g.a,{id:"user.settings.advance.preReleaseDesc",defaultMessage:"Check any pre-released features you'd like to preview.  You may also need to refresh the page before the setting will take effect."}))),n=l.a.createElement(v.a,{title:l.a.createElement(g.a,{id:"user.settings.advance.preReleaseTitle",defaultMessage:"Preview Pre-release Features"}),inputs:t,submit:this.saveEnabledFeatures,saving:this.state.isSaving,server_error:e,updateSection:this.handleUpdateSection})}else n=l.a.createElement(S.a,{title:b.jb("user.settings.advance.preReleaseTitle","Preview Pre-release Features"),describe:l.a.createElement(g.a,{id:"user.settings.advance.enabledFeatures",defaultMessage:"{count, number} {count, plural, one {Feature} other {Features}} Enabled",values:{count:this.state.enabledFeatures}}),section:"advancedPreviewFeatures",updateSection:this.handleUpdateSection});let c="",d="";if(""===this.props.currentUser.auth_service&&this.props.enableUserDeactivation){c="deactivateAccount"===this.props.activeSection?l.a.createElement(v.a,{title:l.a.createElement(g.a,{id:"user.settings.advance.deactivateAccountTitle",defaultMessage:"Deactivate Account"}),inputs:[l.a.createElement("div",{key:"formattingSetting"},l.a.createElement("div",null,l.a.createElement("br",null),l.a.createElement(g.a,{id:"user.settings.advance.deactivateDesc",defaultMessage:"Deactivating your account removes your ability to log in to this server and disables all email and mobile notifications. To reactivate your account, contact your System Administrator."})))],saveButtonText:"Deactivate",setting:"deactivateAccount",submit:this.handleShowDeactivateAccountModal,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.handleUpdateSection}):l.a.createElement(S.a,{title:l.a.createElement(g.a,{id:"user.settings.advance.deactivateAccountTitle",defaultMessage:"Deactivate Account"}),describe:l.a.createElement(g.a,{id:"user.settings.advance.deactivateDescShort",defaultMessage:"Click 'Edit' to deactivate your account"}),section:"deactivateAccount",updateSection:this.handleUpdateSection});const e="btn btn-danger",t=l.a.createElement(g.a,{id:"user.settings.advance.deactivate_member_modal.deactivateButton",defaultMessage:"Yes, deactivate my account"});d=l.a.createElement(y.a,{show:this.state.showDeactivateAccountModal,title:l.a.createElement(g.a,{id:"user.settings.advance.confirmDeactivateAccountTitle",defaultMessage:"Confirm Deactivation"}),message:l.a.createElement(g.a,{id:"user.settings.advance.confirmDeactivateDesc",defaultMessage:"Are you sure you want to deactivate your account? This can only be reversed by your System Administrator."}),confirmButtonClass:e,confirmButtonText:t,onConfirm:this.handleDeactivateAccountSubmit,onCancel:this.handleHideDeactivateAccountModal})}return l.a.createElement("div",null,l.a.createElement("div",{className:"modal-header"},l.a.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},l.a.createElement("span",{"aria-hidden":"true"},"×")),l.a.createElement("h4",{className:"modal-title",ref:"title"},l.a.createElement("div",{className:"modal-back"},l.a.createElement("span",{onClick:this.props.collapseModal},l.a.createElement(k.a,null))),l.a.createElement(g.a,{id:"user.settings.advance.title",defaultMessage:"Advanced Settings"}))),l.a.createElement("div",{className:"user-settings"},l.a.createElement("h3",{className:"tab-header"},l.a.createElement(g.a,{id:"user.settings.advance.title",defaultMessage:"Advanced Settings"})),l.a.createElement("div",{className:"divider-dark first"}),t,o,i,l.a.createElement("div",{className:"divider-light"}),l.a.createElement(M,{activeSection:this.props.activeSection,onUpdateSection:this.handleUpdateSection,renderOnOffLabel:this.renderOnOffLabel}),r,n,o,c,l.a.createElement("div",{className:"divider-dark"}),d))}}T(w,"propTypes",{currentUser:r.a.object.isRequired,advancedSettingsCategory:r.a.array.isRequired,sendOnCtrlEnter:r.a.string.isRequired,codeBlockOnCtrlEnter:r.a.bool,formatting:r.a.string.isRequired,joinLeave:r.a.string.isRequired,updateSection:r.a.func,activeSection:r.a.string,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,enablePreviewFeatures:r.a.bool,enableUserDeactivation:r.a.bool,actions:r.a.shape({savePreferences:r.a.func.isRequired,updateUserActive:r.a.func.isRequired,revokeAllSessionsForUser:r.a.func.isRequired}).isRequired});var A=Object(s.connect)((function(){const e=Object(u.makeGetCategory)();return t=>{const a=Object(d.getConfig)(t),s="true"===a.EnablePreviewFeatures,n="true"===a.EnableUserDeactivation;return{advancedSettingsCategory:e(t,p.B.CATEGORY_ADVANCED_SETTINGS),sendOnCtrlEnter:Object(u.get)(t,p.B.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter","false"),codeBlockOnCtrlEnter:Object(u.get)(t,p.B.CATEGORY_ADVANCED_SETTINGS,"code_block_ctrl_enter","true"),formatting:Object(u.get)(t,p.B.CATEGORY_ADVANCED_SETTINGS,"formatting","true"),joinLeave:Object(u.get)(t,p.B.CATEGORY_ADVANCED_SETTINGS,"join_leave","true"),currentUser:Object(i.getCurrentUser)(t),enablePreviewFeatures:s,enableUserDeactivation:n}}}),(function(e){return{actions:Object(c.bindActionCreators)({savePreferences:m.savePreferences,updateUserActive:h.updateUserActive,revokeAllSessionsForUser:h.revokeAllSessionsForUser},e)}}))(w),P=a(610),I=a(1370),R=a(190),j=a(191),L=(a(608),a(194)),D=a(199),x=a(19),U=(a(180),a(99)),F=a.n(U),z=a(324),q=a.n(z),B=a(1321),G=a(1418),H=a(1),V=(a(1984),a(16)),Y=a(1166),K=a(1141),W=a(1198),Q=(a(101),a(103),a(1507));function J(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const X=/^#([\da-f]{3}|[\da-f]{6})$/i;class Z extends l.a.PureComponent{constructor(e){super(e),J(this,"colorPicker",void 0),J(this,"colorInput",void 0),J(this,"checkClick",e=>{this.colorPicker.current&&this.colorPicker.current.contains(e.target)||this.setState({isOpened:!1})}),J(this,"togglePicker",()=>{!this.state.isOpened&&this.colorInput.current&&this.colorInput.current.focus(),this.setState({isOpened:!this.state.isOpened})}),J(this,"handleColorChange",e=>{const{hex:t}=e,{onChange:a}=this.props;a&&a(t)}),J(this,"ensureLongColourValue",e=>4!==e.length?e:e.split("").map((e,t)=>0===t?e:"".concat(e).concat(e)).join("")),J(this,"onChange",e=>{let{value:t}=e.target;if(t.startsWith("#")||(t="#"+t),!X.test(t))return;this.setState({hex:t});const{onChange:a}=this.props;a&&a(this.ensureLongColourValue(t))}),J(this,"onBlur",()=>{const{hex:e}=this.state;if(4===e.length){const t=this.ensureLongColourValue(e),{onChange:a}=this.props;a&&7===t.length&&(a(t),this.setState({hex:t.toUpperCase()}))}else this.setHex()}),J(this,"onKeyDown",e=>{"Enter"!==e.key&&" "!==e.key||this.togglePicker()}),J(this,"selectValue",e=>{e.target&&e.target.setSelectionRange(1,e.target.value.length)}),this.colorPicker=l.a.createRef(),this.colorInput=l.a.createRef(),this.state={isOpened:!1,hex:this.props.color.toUpperCase()}}componentWillMount(){this.setHex()}componentDidUpdate(e,t){const{isOpened:a}=t,{isOpened:s}=this.state;this.props.color!==e.color&&this.ensureLongColourValue(this.state.hex)!==this.props.color&&this.setHex(),s!==a&&(s?document.addEventListener("click",this.checkClick):document.removeEventListener("click",this.checkClick))}setHex(){this.setState({hex:this.props.color.toUpperCase()})}render(){const{color:e,id:t}=this.props,{isOpened:a,hex:s}=this.state;return l.a.createElement("div",{className:"color-input input-group"},l.a.createElement("input",{id:"".concat(t,"-inputColorValue"),ref:this.colorInput,className:"form-control",type:"text",value:s,onChange:this.onChange,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onFocus:this.selectValue}),l.a.createElement("span",{id:"".concat(t,"-squareColorIcon"),className:"input-group-addon color-pad",onClick:this.togglePicker},l.a.createElement("i",{id:"".concat(t,"-squareColorIconValue"),className:"color-icon",style:{backgroundColor:e}})),a&&l.a.createElement("div",{ref:this.colorPicker,className:"color-popover",id:"".concat(t,"-ChromePickerModal")},l.a.createElement(Q.ChromePicker,{color:e,onChange:this.handleColorChange,disableAlpha:!0})))}}J(Z,"propTypes",{id:r.a.string.isRequired,color:r.a.string.isRequired,onChange:r.a.func});var $=Z;function ee(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class te extends l.a.Component{constructor(...e){super(...e),ee(this,"handleChange",e=>{const{id:t,onChange:a}=this.props;a&&a(t,e)})}render(){const{label:e,color:t,id:a}=this.props;return l.a.createElement("div",null,l.a.createElement("label",{className:"custom-label"},e),l.a.createElement($,{id:a,color:t,onChange:this.handleChange}))}}ee(te,"propTypes",{id:r.a.string.isRequired,label:r.a.node.isRequired,color:r.a.string.isRequired,onChange:r.a.func});var ae=te;function se(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function ie(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?se(Object(a),!0).forEach((function(t){ne(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):se(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ne(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const re=Object(G.defineMessages)({sidebarBg:{id:Object(E.b)("user.settings.custom_theme.sidebarBg"),defaultMessage:"Sidebar BG"},sidebarText:{id:Object(E.b)("user.settings.custom_theme.sidebarText"),defaultMessage:"Sidebar Text"},sidebarHeaderBg:{id:Object(E.b)("user.settings.custom_theme.sidebarHeaderBg"),defaultMessage:"Sidebar Header BG"},sidebarHeaderTextColor:{id:Object(E.b)("user.settings.custom_theme.sidebarHeaderTextColor"),defaultMessage:"Sidebar Header Text"},sidebarUnreadText:{id:Object(E.b)("user.settings.custom_theme.sidebarUnreadText"),defaultMessage:"Sidebar Unread Text"},sidebarTextHoverBg:{id:Object(E.b)("user.settings.custom_theme.sidebarTextHoverBg"),defaultMessage:"Sidebar Text Hover BG"},sidebarTextActiveBorder:{id:Object(E.b)("user.settings.custom_theme.sidebarTextActiveBorder"),defaultMessage:"Sidebar Text Active Border"},sidebarTextActiveColor:{id:Object(E.b)("user.settings.custom_theme.sidebarTextActiveColor"),defaultMessage:"Sidebar Text Active Color"},onlineIndicator:{id:Object(E.b)("user.settings.custom_theme.onlineIndicator"),defaultMessage:"Online Indicator"},awayIndicator:{id:Object(E.b)("user.settings.custom_theme.awayIndicator"),defaultMessage:"Away Indicator"},dndIndicator:{id:Object(E.b)("user.settings.custom_theme.dndIndicator"),defaultMessage:"Do Not Disturb Indicator"},mentionBg:{id:Object(E.b)("user.settings.custom_theme.mentionBg"),defaultMessage:"Mention Jewel BG"},mentionColor:{id:Object(E.b)("user.settings.custom_theme.mentionColor"),defaultMessage:"Mention Jewel Text"},centerChannelBg:{id:Object(E.b)("user.settings.custom_theme.centerChannelBg"),defaultMessage:"Center Channel BG"},centerChannelColor:{id:Object(E.b)("user.settings.custom_theme.centerChannelColor"),defaultMessage:"Center Channel Text"},newMessageSeparator:{id:Object(E.b)("user.settings.custom_theme.newMessageSeparator"),defaultMessage:"New Message Separator"},linkColor:{id:Object(E.b)("user.settings.custom_theme.linkColor"),defaultMessage:"Link Color"},buttonBg:{id:Object(E.b)("user.settings.custom_theme.buttonBg"),defaultMessage:"Button BG"},buttonColor:{id:Object(E.b)("user.settings.custom_theme.buttonColor"),defaultMessage:"Button Text"},errorTextColor:{id:Object(E.b)("user.settings.custom_theme.errorTextColor"),defaultMessage:"Error Text Color"},mentionHighlightBg:{id:Object(E.b)("user.settings.custom_theme.mentionHighlightBg"),defaultMessage:"Mention Highlight BG"},mentionHighlightLink:{id:Object(E.b)("user.settings.custom_theme.mentionHighlightLink"),defaultMessage:"Mention Highlight Link"},codeTheme:{id:Object(E.b)("user.settings.custom_theme.codeTheme"),defaultMessage:"Code Theme"}});class oe extends l.a.Component{constructor(e){super(e),ne(this,"handleColorChange",(e,t)=>{const{updateTheme:a,theme:s}=this.props;if(s[e]!==t){const i=ie({},s,{type:"custom",[e]:t});"mentionBg"===e&&(i.mentionBj=t),a(i);const n=this.setCopyTheme(i);this.setState({copyTheme:n})}}),ne(this,"pasteBoxChange",e=>{let t,a="";if(a=window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):e.clipboardData.getData("Text"),0!==a.length){try{t=JSON.parse(a)}catch(e){return}Object(H.setThemeDefaults)(t),this.setState({copyTheme:JSON.stringify(t)}),t.type="custom",this.props.updateTheme(t)}}),ne(this,"onChangeHandle",e=>{e.stopPropagation()}),ne(this,"selectTheme",()=>{const e=this.refs.textarea;e.focus(),e.setSelectionRange(0,this.state.copyTheme.length)}),ne(this,"toggleSidebarStyles",e=>{e.preventDefault(),F()(this.refs.sidebarStylesHeader).toggleClass("open"),this.toggleSection(this.refs.sidebarStyles)}),ne(this,"toggleCenterChannelStyles",e=>{e.preventDefault(),F()(this.refs.centerChannelStylesHeader).toggleClass("open"),this.toggleSection(this.refs.centerChannelStyles)}),ne(this,"toggleLinkAndButtonStyles",e=>{e.preventDefault(),F()(this.refs.linkAndButtonStylesHeader).toggleClass("open"),this.toggleSection(this.refs.linkAndButtonStyles)}),ne(this,"onCodeThemeChange",e=>{const t=ie({},this.props.theme,{type:"custom",codeTheme:e.target.value});this.props.updateTheme(t)}),ne(this,"copyTheme",()=>{this.selectTheme(),document.execCommand("copy"),this.showCopySuccess()}),ne(this,"showCopySuccess",()=>{const e=F()(".copy-theme-success");e.show(),setTimeout(()=>{e.hide()},3e3)});const t=this.setCopyTheme(this.props.theme);this.state={copyTheme:t}}componentDidMount(){F()(".group--code").on("change",this.onCodeThemeChange)}componentWillUnmount(){F()(".group--code").off("change",this.onCodeThemeChange)}setCopyTheme(e){const t=Object.assign({},e);return delete t.type,delete t.image,JSON.stringify(t)}toggleSection(e){V.h()?F()(e).toggleClass("open"):F()(e).slideToggle()}render(){const e=this.props.theme,t=[],a=[],s=[];p.Q.THEME_ELEMENTS.forEach((i,n)=>{if("codeTheme"===i.id){const t=[];let s="";i.themes.forEach((a,n)=>{a.id===e[i.id]&&(s=a.iconURL),t.push(l.a.createElement("option",{key:"code-theme-key"+n,value:a.id},a.uiName))});var r=l.a.createElement(W.a,{popoverStyle:"info",id:"code-popover",className:"code-popover"},l.a.createElement("img",{width:"200",alt:"code theme image",src:s}));a.push(l.a.createElement("div",{className:"col-sm-6 form-group",key:"custom-theme-key"+n},l.a.createElement("label",{className:"custom-label"},l.a.createElement(g.a,re[i.id])),l.a.createElement("div",{className:"input-group theme-group group--code dropdown",id:i.id},l.a.createElement("select",{id:"codeThemeSelect",className:"form-control",type:"text",defaultValue:e[i.id]},t),l.a.createElement(K.a,{placement:"top",overlay:r,ref:"headerOverlay"},l.a.createElement("span",{className:"input-group-addon"},l.a.createElement("img",{alt:"code theme image",src:s}))))))}else if("centerChannelElements"===i.group)a.push(l.a.createElement("div",{className:"col-sm-6 form-group element",key:"custom-theme-key"+n},l.a.createElement(ae,{id:i.id,label:l.a.createElement(g.a,re[i.id]),color:e[i.id],onChange:this.handleColorChange})));else if("sidebarElements"===i.group){let a=e[i.id];a||"mentionBg"!==i.id||(a=e.mentionBj),t.push(l.a.createElement("div",{className:"col-sm-6 form-group element",key:"custom-theme-key"+n},l.a.createElement(ae,{id:i.id,label:l.a.createElement(g.a,re[i.id]),color:a,onChange:this.handleColorChange})))}else s.push(l.a.createElement("div",{className:"col-sm-6 form-group element",key:"custom-theme-key"+n},l.a.createElement(ae,{id:i.id,label:l.a.createElement(g.a,re[i.id]),color:e[i.id],onChange:this.handleColorChange})))});const i=l.a.createElement("div",{className:"col-sm-12"},l.a.createElement("label",{className:"custom-label"},l.a.createElement(g.a,{id:"user.settings.custom_theme.copyPaste",defaultMessage:"Copy to share or paste theme colors here:"})),l.a.createElement("textarea",{ref:"textarea",className:"form-control",id:"pasteBox",value:this.state.copyTheme,onCopy:this.showCopySuccess,onPaste:this.pasteBoxChange,onChange:this.onChangeHandle,onClick:this.selectTheme}),l.a.createElement("div",{className:"mt-3"},l.a.createElement("button",{className:"btn btn-link copy-theme-button",onClick:this.copyTheme},l.a.createElement(g.a,{id:"user.settings.custom_theme.copyThemeColors",defaultMessage:"Copy Theme Colors"})),l.a.createElement("span",{className:"alert alert-success copy-theme-success",role:"alert",style:{display:"none"}},l.a.createElement(g.a,{id:"user.settings.custom_theme.copied",defaultMessage:"✔ Copied"}))));return l.a.createElement("div",{className:"appearance-section pt-2"},l.a.createElement("div",{className:"theme-elements row"},l.a.createElement("div",{ref:"sidebarStylesHeader",id:"sidebarStyles",className:"theme-elements__header",onClick:this.toggleSidebarStyles},l.a.createElement(g.a,{id:"user.settings.custom_theme.sidebarTitle",defaultMessage:"Sidebar Styles"}),l.a.createElement("div",{className:"header__icon"},l.a.createElement(Y.a,{className:"fa fa-plus",title:{id:Object(E.b)("generic_icons.expand"),defaultMessage:"Expand Icon"}}),l.a.createElement(Y.a,{className:"fa fa-minus",title:{id:Object(E.b)("generic_icons.collapse"),defaultMessage:"Collapse Icon"}}))),l.a.createElement("div",{ref:"sidebarStyles",className:"theme-elements__body"},t)),l.a.createElement("div",{className:"theme-elements row"},l.a.createElement("div",{ref:"centerChannelStylesHeader",id:"centerChannelStyles",className:"theme-elements__header",onClick:this.toggleCenterChannelStyles},l.a.createElement(g.a,{id:"user.settings.custom_theme.centerChannelTitle",defaultMessage:"Center Channel Styles"}),l.a.createElement("div",{className:"header__icon"},l.a.createElement(Y.a,{className:"fa fa-plus",title:{id:Object(E.b)("generic_icons.expand"),defaultMessage:"Expand Icon"}}),l.a.createElement(Y.a,{className:"fa fa-minus",title:{id:Object(E.b)("generic_icons.collapse"),defaultMessage:"Collapse Icon"}}))),l.a.createElement("div",{ref:"centerChannelStyles",id:"centerChannelStyles",className:"theme-elements__body"},a)),l.a.createElement("div",{className:"theme-elements row"},l.a.createElement("div",{ref:"linkAndButtonStylesHeader",id:"linkAndButtonsStyles",className:"theme-elements__header",onClick:this.toggleLinkAndButtonStyles},l.a.createElement(g.a,{id:"user.settings.custom_theme.linkButtonTitle",defaultMessage:"Link and Button Styles"}),l.a.createElement("div",{className:"header__icon"},l.a.createElement(Y.a,{className:"fa fa-plus",title:{id:Object(E.b)("generic_icons.expand"),defaultMessage:"Expand Icon"}}),l.a.createElement(Y.a,{className:"fa fa-minus",title:{id:Object(E.b)("generic_icons.collapse"),defaultMessage:"Collapse Icon"}}))),l.a.createElement("div",{ref:"linkAndButtonStyles",className:"theme-elements__body"},s)),l.a.createElement("div",{className:"row mt-3"},i))}}ne(oe,"propTypes",{theme:r.a.object.isRequired,updateTheme:r.a.func.isRequired});a(64),a(74);class le extends l.a.Component{render(){const e=this.props.theme,t=[],a=this.props.allowedThemes,s=a.length>1||a[0]&&a[0].trim().length>0;for(const i in p.Q.THEMES)if(p.Q.THEMES.hasOwnProperty(i)){if(s&&a.indexOf(i)<0)continue;const n=F.a.extend(!0,{},p.Q.THEMES[i]);let r="";n.type===e.type&&(r="active"),t.push(l.a.createElement("div",{className:"col-xs-6 col-sm-3 premade-themes",key:"premade-theme-key"+i},l.a.createElement("div",{id:"premadeTheme".concat(n.type.replace(" ","")),className:r,onClick:()=>this.props.updateTheme(n)},l.a.createElement("label",null,l.a.createElement("img",{alt:"premade theme "+i,className:"img-responsive",src:n.image}),l.a.createElement("div",{className:"theme-label"},b.sb(n.type))))))}return l.a.createElement("div",{className:"row appearance-section"},l.a.createElement("div",{className:"clearfix"},t))}}le.propTypes={theme:r.a.object.isRequired,updateTheme:r.a.func.isRequired,allowedThemes:r.a.arrayOf(r.a.string)},le.defaultProps={allowedThemes:[]};var ce=Object(s.connect)((function(e){const t=Object(d.getConfig)(e);return{allowedThemes:t.AllowedThemes&&t.AllowedThemes.split(",")||[]}}))(le);function de(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function ue(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?de(Object(a),!0).forEach((function(t){me(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):de(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function me(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class he extends l.a.Component{constructor(e){super(e),me(this,"submitTheme",async()=>{const e=this.state.applyToAllTeams?"":this.props.currentTeamId;this.setState({isSaving:!0}),await this.props.actions.saveTheme(e,this.state.theme),this.state.applyToAllTeams&&await this.props.actions.deleteTeamSpecificThemes(),this.props.setRequireConfirm(!1),this.originalTheme=Object.assign({},this.state.theme),this.scrollToTop(),this.props.updateSection(""),this.setState({isSaving:!1})}),me(this,"updateTheme",e=>{let t=this.state.theme.length===e.length;if(!t)for(const a in e)if(e.hasOwnProperty(a)&&this.state.theme[a]!==e[a]){t=!0;break}this.props.setRequireConfirm(t),this.setState({theme:e}),b.b(e)}),me(this,"resetFields",()=>{const e=this.getStateFromProps();e.serverError=null,this.setState(e),this.scrollToTop(),b.b(e.theme),this.props.setRequireConfirm(!1)}),me(this,"handleImportModal",()=>{B.a.handleViewAction({type:p.f.TOGGLE_IMPORT_THEME_MODAL,value:!0,callback:this.updateTheme}),this.props.setEnforceFocus(!1)}),me(this,"handleUpdateSection",e=>{this.props.updateSection(e)}),this.state=ue({},this.getStateFromProps(e),{isSaving:!1}),this.originalTheme=Object.assign({},this.state.theme)}componentDidMount(){this.props.selected&&F()(q.a.findDOMNode(this.refs[this.state.theme])).addClass("active-border")}componentDidUpdate(e){e.selected&&!this.props.selected&&this.resetFields(),this.props.selected&&(F()(".color-btn").removeClass("active-border"),F()(q.a.findDOMNode(this.refs[this.state.theme])).addClass("active-border"))}componentWillUnmount(){this.props.selected&&b.b(this.props.theme)}getStateFromProps(e=this.props){const t=ue({},e.theme);return t.codeTheme||(t.codeTheme=p.j.DEFAULT_CODE_THEME),{theme:t,type:t.type||"premade",showAllTeamsCheckbox:e.showAllTeamsCheckbox,applyToAllTeams:e.applyToAllTeams}}scrollToTop(){F()(".ps-container.modal-body").scrollTop(0)}updateType(e){this.setState({type:e})}render(){let e;this.state.serverError&&(e=this.state.serverError);const t="custom"===this.state.type;let a,s,i;if(t&&this.props.allowCustomThemes?a=l.a.createElement("div",{key:"customThemeChooser"},l.a.createElement(oe,{theme:this.state.theme,updateTheme:this.updateTheme})):s=l.a.createElement("div",{key:"premadeThemeChooser"},l.a.createElement("br",null),l.a.createElement(ce,{theme:this.state.theme,updateTheme:this.updateTheme})),this.props.selected){const n=[];this.props.allowCustomThemes&&n.push(l.a.createElement("div",{className:"radio",key:"premadeThemeColorLabel"},l.a.createElement("label",null,l.a.createElement("input",{id:"standardThemes",type:"radio",name:"theme",checked:!t,onChange:this.updateType.bind(this,"premade")}),l.a.createElement(g.a,{id:"user.settings.display.theme.themeColors",defaultMessage:"Theme Colors"})),l.a.createElement("br",null))),n.push(s),this.props.allowCustomThemes&&(n.push(l.a.createElement("div",{className:"radio",key:"customThemeColorLabel"},l.a.createElement("label",null,l.a.createElement("input",{id:"customThemes",type:"radio",name:"theme",checked:t,onChange:this.updateType.bind(this,"custom")}),l.a.createElement(g.a,{id:"user.settings.display.theme.customTheme",defaultMessage:"Custom Theme"})))),n.push(a),n.push(l.a.createElement("div",{key:"otherThemes"},l.a.createElement("br",null),l.a.createElement("a",{id:"otherThemes",href:"http://docs.mattermost.com/help/settings/theme-colors.html#custom-theme-examples",target:"_blank",rel:"noopener noreferrer"},l.a.createElement(g.a,{id:"user.settings.display.theme.otherThemes",defaultMessage:"See other themes"})))),n.push(l.a.createElement("div",{key:"importSlackThemeButton",className:"pt-2"},l.a.createElement("button",{id:"slackImportTheme",className:"theme style--none color--link",onClick:this.handleImportModal},l.a.createElement(g.a,{id:"user.settings.display.theme.import",defaultMessage:"Import theme colors from Slack"})))));let r=null;this.state.showAllTeamsCheckbox&&(r=l.a.createElement("div",{className:"checkbox user-settings__submit-checkbox"},l.a.createElement("label",null,l.a.createElement("input",{id:"applyThemeToAllTeams",type:"checkbox",checked:this.state.applyToAllTeams,onChange:e=>this.setState({applyToAllTeams:e.target.checked})}),l.a.createElement(g.a,{id:"user.settings.display.theme.applyToAllTeams",defaultMessage:"Apply new theme to all my teams"})))),i=l.a.createElement(v.a,{inputs:n,submitExtra:r,submit:this.submitTheme,disableEnterSubmit:!0,saving:this.state.isSaving,server_error:e,width:"full",updateSection:this.handleUpdateSection})}else i=l.a.createElement(S.a,{title:l.a.createElement(g.a,{id:"user.settings.display.theme.title",defaultMessage:"Theme"}),describe:l.a.createElement(g.a,{id:"user.settings.display.theme.describe",defaultMessage:"Open to manage your theme"}),section:"theme",updateSection:this.handleUpdateSection,focused:this.props.focused});return i}}me(he,"propTypes",{actions:r.a.shape({saveTheme:r.a.func.isRequired,deleteTeamSpecificThemes:r.a.func.isRequired}).isRequired,currentTeamId:r.a.string.isRequired,theme:r.a.object,selected:r.a.bool.isRequired,updateSection:r.a.func.isRequired,setRequireConfirm:r.a.func.isRequired,setEnforceFocus:r.a.func.isRequired,allowCustomThemes:r.a.bool,focused:r.a.bool.isRequired});var pe=Object(s.connect)((function(){const e=Object(u.makeGetCategory)();return t=>({currentTeamId:Object(x.getCurrentTeamId)(t),theme:Object(u.getTheme)(t),applyToAllTeams:e(t,p.B.CATEGORY_THEME).length<=1,showAllTeamsCheckbox:Object(x.getMyTeamsCount)(t)>1})}),(function(e){return{actions:Object(c.bindActionCreators)({saveTheme:m.saveTheme,deleteTeamSpecificThemes:m.deleteTeamSpecificThemes},e)}}))(he),ge=(a(147),a(1456)),fe=a(1210),be=a(1197),Ee=a(1169),ve=a(1170);class Se extends ve.a{render(){const{item:e,isSelection:t}=this.props,a=e;let s="mentions__name";return t&&(s+=" suggestion--selected"),l.a.createElement("div",Object.assign({onClick:this.handleClick,className:s,ref:e=>{this.node=e}},ve.a.baseProps),a)}}class ye extends Ee.a{handlePretextChanged(e,t){return 0===e.length?(this.displayAllTimezones(t,e),!0):!!e&&(this.filterTimezones(t,e),!0)}async displayAllTimezones(e){e({matchedPretext:"",terms:Object(L.d)(),items:Object(L.d)(),component:Se})}async filterTimezones(e,t){const a=Object(L.d)().filter(e=>Object(j.getTimezoneRegion)(e).toLowerCase().indexOf(t)>=0||e.toLowerCase().indexOf(t)>=0);e({matchedPretext:t,terms:a,items:a,component:Se})}}function ke(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function Ce(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Ne extends l.a.PureComponent{constructor(e){super(e),Ce(this,"onChange",e=>{this.setState({manualTimezoneInput:e.target.value})}),Ce(this,"handleTimezoneSelected",e=>{e&&this.setState({manualTimezone:e,manualTimezoneInput:e})}),Ce(this,"timezoneNotChanged",()=>{const{useAutomaticTimezone:e,automaticTimezone:t,manualTimezone:a}=this.state,{useAutomaticTimezone:s,automaticTimezone:i,manualTimezone:n}=this.props;return e===s&&t===i&&a===n}),Ce(this,"changeTimezone",()=>{this.timezoneNotChanged()?this.props.updateSection(""):this.submitUser()}),Ce(this,"submitUser",()=>{const{user:e,actions:t}=this.props,{useAutomaticTimezone:a,automaticTimezone:s,manualTimezone:i}=this.state,n=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(a),!0).forEach((function(t){Ce(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ke(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{timezone:{useAutomaticTimezone:a.toString(),automaticTimezone:s,manualTimezone:i}});t.updateMe(n).then(({data:e,error:t})=>{if(e)this.props.updateSection("");else if(t){let e;e=t.message?t.message:t,this.setState({serverError:e,isSaving:!1})}})}),Ce(this,"handleAutomaticTimezone",e=>{const t=e.target.checked;let a="";t&&(a=Object(L.a)()),this.setState({useAutomaticTimezone:t,automaticTimezone:a})}),Ce(this,"handleManualTimezone",e=>{this.setState({manualTimezone:e.target.value})}),this.state={useAutomaticTimezone:e.useAutomaticTimezone,automaticTimezone:e.automaticTimezone,manualTimezone:e.manualTimezone,manualTimezoneInput:e.manualTimezone,isSaving:!1}}render(){const{timezones:e}=this.props,{useAutomaticTimezone:t,automaticTimezone:a}=this.state;let s;this.state.serverError&&(s=l.a.createElement("label",{className:"has-error"},this.state.serverError));const i=[],n=l.a.createElement("div",{className:"section-describe pt-2"},t&&Object(j.getTimezoneRegion)(a)),r=0===e.length,o=l.a.createElement("div",{className:"checkbox"},l.a.createElement("label",null,l.a.createElement("input",{id:"automaticTimezoneInput",type:"checkbox",checked:t,onChange:this.handleAutomaticTimezone,disabled:r}),l.a.createElement(g.a,{id:"user.settings.timezones.automatic",defaultMessage:"Set automatically"}),n)),c=[new ye],d=l.a.createElement("div",{key:"changeTimezone"},l.a.createElement("label",{className:"control-label"},l.a.createElement(g.a,{id:"user.settings.timezones.change",defaultMessage:"Change timezone"})),l.a.createElement("div",{className:"pt-2"},l.a.createElement(fe.a,{ref:this.setSwitchBoxRef,className:"form-control focused",type:"search",onChange:this.onChange,value:this.state.manualTimezoneInput,onItemSelected:this.handleTimezoneSelected,listComponent:be.a,maxLength:"64",requiredCharacters:0,providers:c,listStyle:"bottom",completeOnTab:!1,renderDividers:!1,openOnFocus:!0,disabled:r}),s));return i.push(o),t||i.push(d),i.push(l.a.createElement("div",null,l.a.createElement("br",null),l.a.createElement(ge.a,{id:"user.settings.timezones.promote",defaultMessage:"Select the time zone used for timestamps in the user interface and email notifications."}))),l.a.createElement(v.a,{title:l.a.createElement(g.a,{id:"user.settings.display.timezone",defaultMessage:"Timezone"}),containerStyle:"timezone-container",width:"medium",submit:this.changeTimezone,saving:this.state.isSaving,inputs:i,updateSection:this.props.updateSection})}}Ce(Ne,"propTypes",{user:r.a.object.isRequired,updateSection:r.a.func.isRequired,useAutomaticTimezone:r.a.bool.isRequired,automaticTimezone:r.a.string.isRequired,manualTimezone:r.a.string.isRequired,timezones:r.a.array.isRequired,actions:r.a.shape({updateMe:r.a.func.isRequired}).isRequired});var _e=Object(s.connect)(null,(function(e){return{actions:Object(c.bindActionCreators)({updateMe:h.updateMe},e)}}))(Ne),Me=a(1250),Te=a(1138);function Oe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function we(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(a),!0).forEach((function(t){Ae(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Oe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ae(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Pe extends l.a.Component{constructor(e){super(e),Ae(this,"handleContainerKeyDown",e=>{Object(b.Y)(e,p.Q.KeyCodes.ESCAPE)&&this.state.openMenu&&(document.querySelector(".modal-body").classList.remove("no-scroll"),this.setState({openMenu:!1}),e.stopPropagation())}),Ae(this,"handleKeyDown",e=>{Object(b.Y)(e,p.Q.KeyCodes.ENTER)&&(document.querySelector(".modal-body").classList.add("no-scroll"),this.setState({openMenu:!0}))}),Ae(this,"setLanguage",e=>{this.setState({locale:e.value,selectedOption:e})}),Ae(this,"changeLanguage",()=>{this.props.user.locale===this.state.locale?this.props.updateSection(""):this.submitUser(we({},this.props.user,{locale:this.state.locale}))}),Ae(this,"submitUser",e=>{this.setState({isSaving:!0}),this.props.actions.updateMe(e).then(({data:e,error:t})=>{if(e);else if(t){let e;e=t.message?t.message:t,this.setState({serverError:e,isSaving:!1})}})}),Ae(this,"handleMenuClose",()=>{document.querySelector(".modal-body").classList.remove("no-scroll"),this.setState({openMenu:!1})}),Ae(this,"handleMenuOpen",()=>{document.querySelector(".modal-body").classList.add("no-scroll"),this.setState({openMenu:!0})});const t=D.d(),a=e.locale,s={value:t[a].value,label:t[a].name};this.reactSelectContainer=l.a.createRef(),this.state={locale:e.locale,selectedOption:s,isSaving:!1,openMenu:!1}}componentDidMount(){this.reactSelectContainer.current&&this.reactSelectContainer.current.addEventListener("keydown",this.handleContainerKeyDown)}componentWillUnmount(){this.reactSelectContainer.current&&this.reactSelectContainer.current.removeEventListener("keydown",this.handleContainerKeyDown)}render(){let e;this.state.serverError&&(e=l.a.createElement("label",{className:"has-error"},this.state.serverError));const t=[],a=D.d();Object.keys(a).map(e=>({value:a[e].value,name:a[e].name,order:a[e].order})).sort((e,t)=>e.order-t.order).forEach(e=>{t.push({value:e.value,label:e.name})});const s={menuPortal:e=>we({},e,{zIndex:9999})},i=l.a.createElement("div",{key:"changeLanguage"},l.a.createElement("br",null),l.a.createElement("label",{className:"control-label",id:"changeInterfaceLanguageLabel"},l.a.createElement(g.a,{id:"user.settings.languages.change",defaultMessage:"Change interface language"})),l.a.createElement("div",{ref:this.reactSelectContainer,className:"pt-2"},l.a.createElement(Me.b,{className:"react-select react-select-top",classNamePrefix:"react-select",id:"displayLanguage",menuIsOpen:this.state.openMenu,menuPortalTarget:document.body,styles:s,options:t,clearable:!1,onChange:this.setLanguage,onKeyDown:this.handleKeyDown,value:this.state.selectedOption,onMenuClose:this.handleMenuClose,onMenuOpen:this.handleMenuOpen,"aria-labelledby":"changeInterfaceLanguageLabel"}),e),l.a.createElement("div",null,l.a.createElement("br",null),l.a.createElement(Te.b,{id:"user.settings.languages.promote",defaultMessage:"Select which language Mattermost displays in the user interface.\\n \\nWould you like to help with translations? Join the [Mattermost Translation Server](!http://translate.mattermost.com/) to contribute."})));return l.a.createElement(v.a,{title:l.a.createElement(g.a,{id:"user.settings.display.language",defaultMessage:"Language"}),width:"medium",submit:this.changeLanguage,saving:this.state.isSaving,inputs:[i],updateSection:this.props.updateSection})}}Ae(Pe,"propTypes",{user:r.a.object.isRequired,locale:r.a.string.isRequired,updateSection:r.a.func.isRequired,actions:r.a.shape({updateMe:r.a.func.isRequired}).isRequired});var Ie=Object(s.connect)(null,(function(e){return{actions:Object(c.bindActionCreators)({updateMe:h.updateMe},e)}}))(Pe);function Re(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function je(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(a),!0).forEach((function(t){Le(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Re(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Le(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const De=p.Q.Preferences;function xe(e){return{militaryTime:e.militaryTime,teammateNameDisplay:e.teammateNameDisplay,channelDisplayMode:e.channelDisplayMode,messageDisplay:e.messageDisplay,collapseDisplay:e.collapseDisplay,linkPreviewDisplay:e.linkPreviewDisplay}}class Ue extends l.a.Component{constructor(e){super(e),Le(this,"handleSubmit",async()=>{const e=this.props.user.id,t={user_id:e,category:De.CATEGORY_DISPLAY_SETTINGS,name:De.USE_MILITARY_TIME,value:this.state.militaryTime},a={user_id:e,category:De.CATEGORY_DISPLAY_SETTINGS,name:De.NAME_NAME_FORMAT,value:this.state.teammateNameDisplay},s={user_id:e,category:De.CATEGORY_DISPLAY_SETTINGS,name:De.CHANNEL_DISPLAY_MODE,value:this.state.channelDisplayMode},i={user_id:e,category:De.CATEGORY_DISPLAY_SETTINGS,name:De.MESSAGE_DISPLAY,value:this.state.messageDisplay},n={user_id:e,category:De.CATEGORY_DISPLAY_SETTINGS,name:De.COLLAPSE_DISPLAY,value:this.state.collapseDisplay},r={user_id:e,category:De.CATEGORY_DISPLAY_SETTINGS,name:De.LINK_PREVIEW_DISPLAY,value:this.state.linkPreviewDisplay};this.setState({isSaving:!0});const o=[t,s,i,n,r,a];await this.props.actions.savePreferences(e,o),this.updateSection("")}),Le(this,"handleClockRadio",e=>{this.setState({militaryTime:e})}),Le(this,"handleTeammateNameDisplayRadio",e=>{this.setState({teammateNameDisplay:e})}),Le(this,"updateSection",e=>{this.updateState(),this.props.updateSection(e)}),Le(this,"updateState",()=>{const e=xe(this.props);b.c(e,this.state)||this.setState(e),this.setState({isSaving:!1})}),this.state=je({},xe(e),{isSaving:!1}),0===e.timezones.length&&e.actions.getSupportedTimezones(),this.prevSections={theme:"dummySectionName",clock:"theme",linkpreview:"clock",message_display:"linkpreview",channel_display_mode:"message_display",languages:"channel_display_mode"}}componentDidMount(){const{actions:e,enableTimezone:t,shouldAutoUpdateTimezone:a}=this.props;t&&a&&e.autoUpdateTimezone(Object(L.a)())}componentDidUpdate(e){this.props.teammateNameDisplay!==e.teammateNameDisplay&&this.updateState()}handleChannelDisplayModeRadio(e){this.setState({channelDisplayMode:e})}handlemessageDisplayRadio(e){this.setState({messageDisplay:e})}handleCollapseRadio(e){this.setState({collapseDisplay:e})}handleLinkPreviewRadio(e){this.setState({linkPreviewDisplay:e})}handleOnChange(e){this.setState(je({},e))}createSection(e){const{section:t,display:a,value:s,title:i,firstOption:n,secondOption:r,thirdOption:o,description:c,disabled:d}=e;let u=null,m=this.handleSubmit;const h=l.a.createElement(g.a,{id:n.radionButtonText.id,defaultMessage:n.radionButtonText.message});let p,f;n.radionButtonText.moreId&&(p=": ",f=l.a.createElement("span",{className:"font-weight--normal"},l.a.createElement(g.a,{id:n.radionButtonText.moreId,defaultMessage:n.radionButtonText.moreMessage})));const b=l.a.createElement(g.a,{id:r.radionButtonText.id,defaultMessage:r.radionButtonText.message});let E,y;r.radionButtonText.moreId&&(E=l.a.createElement("span",{className:"font-weight--normal"},l.a.createElement(g.a,{id:r.radionButtonText.moreId,defaultMessage:r.radionButtonText.moreMessage}))),o&&(y=l.a.createElement(g.a,{id:o.radionButtonText.id,defaultMessage:o.radionButtonText.message}));const k=l.a.createElement(g.a,{id:i.id,defaultMessage:i.message}),C=l.a.createElement(g.a,{id:c.id,defaultMessage:c.message});if(this.props.activeSection===t){const e=[!1,!1,!1];s===n.value?e[0]=!0:s===r.value?e[1]=!0:e[2]=!0;const i=t+"Format",c=t+"UserDisplay",S={};S[a]=n.value;const N={};N[a]=r.value;const _={};let M;o&&(_[a]=o.value),y&&(M=l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:i+"C",type:"radio",name:i,checked:e[2],onChange:()=>this.handleOnChange(_)}),y),l.a.createElement("br",null)));let T=[l.a.createElement("fieldset",{key:c},l.a.createElement("legend",{className:"form-legend hidden-label"},k),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:i+"A",type:"radio",name:i,checked:e[0],onChange:()=>this.handleOnChange(S)}),h,p,f),l.a.createElement("br",null)),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:i+"B",type:"radio",name:i,checked:e[1],onChange:()=>this.handleOnChange(N)}),b,p,E),l.a.createElement("br",null)),M,l.a.createElement("div",null,l.a.createElement("br",null),C))];return"teammateNameDisplay"===a&&d&&(u=l.a.createElement("span",null,l.a.createElement(g.a,{id:"user.settings.display.teammateNameDisplay",defaultMessage:"This field is handled through your System Administrator. If you want to change it, you need to do so through your System Administrator."})),m=null,T=[]),l.a.createElement("div",null,l.a.createElement(v.a,{title:k,inputs:T,submit:m,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.updateSection,extraInfo:u}),l.a.createElement("div",{className:"divider-dark"}))}let N;return N=s===n.value?h:s===r.value?b:y,l.a.createElement("div",null,l.a.createElement(S.a,{title:k,describe:N,section:t,updateSection:this.updateSection}),l.a.createElement("div",{className:"divider-dark"}))}render(){const e=this.createSection({section:"collapse",display:"collapseDisplay",value:this.state.collapseDisplay,defaultDisplay:"false",title:{id:Object(E.b)("user.settings.display.collapseDisplay"),message:"Default Appearance of Image Previews"},firstOption:{value:"false",radionButtonText:{id:Object(E.b)("user.settings.display.collapseOn"),message:"On"}},secondOption:{value:"true",radionButtonText:{id:Object(E.b)("user.settings.display.collapseOff"),message:"Off"}},description:{id:Object(E.b)("user.settings.display.collapseDesc"),message:"Set whether previews of image links and image attachment thumbnails show as expanded or collapsed by default. This setting can also be controlled using the slash commands /expand and /collapse."}});let t=null;this.props.enableLinkPreviews?(t=this.createSection({section:"linkpreview",display:"linkPreviewDisplay",value:this.state.linkPreviewDisplay,defaultDisplay:"true",title:{id:Object(E.b)("user.settings.display.linkPreviewDisplay"),message:"Website Link Previews"},firstOption:{value:"true",radionButtonText:{id:Object(E.b)("user.settings.display.linkPreviewOn"),message:"On"}},secondOption:{value:"false",radionButtonText:{id:Object(E.b)("user.settings.display.linkPreviewOff"),message:"Off"}},description:{id:Object(E.b)("user.settings.display.linkPreviewDesc"),message:"When available, the first web link in a message will show a preview of the website content below the message."}}),this.prevSections.message_display="linkpreview"):this.prevSections.message_display=this.prevSections.linkpreview;const a=this.createSection({section:"clock",display:"militaryTime",value:this.state.militaryTime,defaultDisplay:"false",title:{id:Object(E.b)("user.settings.display.clockDisplay"),message:"Clock Display"},firstOption:{value:"false",radionButtonText:{id:Object(E.b)("user.settings.display.normalClock"),message:"12-hour clock (example: 4:00 PM)"}},secondOption:{value:"true",radionButtonText:{id:Object(E.b)("user.settings.display.militaryClock"),message:"24-hour clock (example: 16:00)"}},description:{id:Object(E.b)("user.settings.display.preferTime"),message:"Select how you prefer time displayed."}}),s=this.createSection({section:De.NAME_NAME_FORMAT,display:"teammateNameDisplay",value:this.props.lockTeammateNameDisplay?this.props.configTeammateNameDisplay:this.state.teammateNameDisplay,defaultDisplay:this.props.configTeammateNameDisplay,title:{id:Object(E.b)("user.settings.display.teammateNameDisplayTitle"),message:"Teammate Name Display"},firstOption:{value:p.Q.TEAMMATE_NAME_DISPLAY.SHOW_USERNAME,radionButtonText:{id:Object(E.b)("user.settings.display.teammateNameDisplayUsername"),message:"Show username"}},secondOption:{value:p.Q.TEAMMATE_NAME_DISPLAY.SHOW_NICKNAME_FULLNAME,radionButtonText:{id:Object(E.b)("user.settings.display.teammateNameDisplayNicknameFullname"),message:"Show nickname if one exists, otherwise show first and last name"}},thirdOption:{value:p.Q.TEAMMATE_NAME_DISPLAY.SHOW_FULLNAME,radionButtonText:{id:Object(E.b)("user.settings.display.teammateNameDisplayFullname"),message:"Show first and last name"}},description:{id:Object(E.b)("user.settings.display.teammateNameDisplayDescription"),message:"Set how to display other user's names in posts and the Direct Messages list."},disabled:this.props.lockTeammateNameDisplay});let i;if(this.props.enableTimezone&&!this.props.shouldAutoUpdateTimezone){const e=this.props.userTimezone;i="timezone"===this.props.activeSection?l.a.createElement("div",null,l.a.createElement(_e,{user:this.props.user,timezones:this.props.timezones,useAutomaticTimezone:e.useAutomaticTimezone,automaticTimezone:e.automaticTimezone,manualTimezone:e.manualTimezone,updateSection:this.updateSection}),l.a.createElement("div",{className:"divider-dark"})):l.a.createElement("div",null,l.a.createElement(S.a,{title:l.a.createElement(g.a,{id:"user.settings.display.timezone",defaultMessage:"Timezone"}),width:"medium",describe:Object(j.getTimezoneRegion)(this.props.currentUserTimezone),section:"timezone",updateSection:this.updateSection}),l.a.createElement("div",{className:"divider-dark"}))}const n=this.createSection({section:De.MESSAGE_DISPLAY,display:"messageDisplay",value:this.state.messageDisplay,defaultDisplay:De.MESSAGE_DISPLAY_CLEAN,title:{id:Object(E.b)("user.settings.display.messageDisplayTitle"),message:"Message Display"},firstOption:{value:De.MESSAGE_DISPLAY_CLEAN,radionButtonText:{id:Object(E.b)("user.settings.display.messageDisplayClean"),message:"Standard",moreId:Object(E.b)("user.settings.display.messageDisplayCleanDes"),moreMessage:"Easy to scan and read."}},secondOption:{value:De.MESSAGE_DISPLAY_COMPACT,radionButtonText:{id:Object(E.b)("user.settings.display.messageDisplayCompact"),message:"Compact",moreId:Object(E.b)("user.settings.display.messageDisplayCompactDes"),moreMessage:"Fit as many messages on the screen as we can."}},description:{id:Object(E.b)("user.settings.display.messageDisplayDescription"),message:"Select how messages in a channel should be displayed."}}),r=this.createSection({section:De.CHANNEL_DISPLAY_MODE,display:"channelDisplayMode",value:this.state.channelDisplayMode,defaultDisplay:De.CHANNEL_DISPLAY_MODE_FULL_SCREEN,title:{id:Object(E.b)("user.settings.display.channelDisplayTitle"),message:"Channel Display"},firstOption:{value:De.CHANNEL_DISPLAY_MODE_FULL_SCREEN,radionButtonText:{id:Object(E.b)("user.settings.display.fullScreen"),message:"Full width"}},secondOption:{value:De.CHANNEL_DISPLAY_MODE_CENTERED,radionButtonText:{id:Object(E.b)("user.settings.display.fixedWidthCentered"),message:"Fixed width, centered"}},description:{id:Object(E.b)("user.settings.display.channeldisplaymode"),message:"Select the width of the center channel."}});let o,c,d=this.props.user.locale;if("languages"===this.props.activeSection)D.e(d)||(d=this.props.defaultClientLocale),o=l.a.createElement("div",null,l.a.createElement(Ie,{user:this.props.user,locale:d,updateSection:this.updateSection}),l.a.createElement("div",{className:"divider-dark"}));else{let e;e=D.e(d)?D.c(d).name:D.c(this.props.defaultClientLocale).name,o=l.a.createElement("div",null,l.a.createElement(S.a,{title:l.a.createElement(g.a,{id:"user.settings.display.language",defaultMessage:"Language"}),width:"medium",describe:e,section:"languages",updateSection:this.updateSection}),l.a.createElement("div",{className:"divider-dark"}))}return 1===Object.keys(D.d()).length&&(o=null),this.props.enableThemeSelection&&(c=l.a.createElement("div",null,l.a.createElement(pe,{selected:"theme"===this.props.activeSection,updateSection:this.updateSection,setRequireConfirm:this.props.setRequireConfirm,setEnforceFocus:this.props.setEnforceFocus,allowCustomThemes:this.props.allowCustomThemes}),l.a.createElement("div",{className:"divider-dark"}))),l.a.createElement("div",{id:"displaySettings"},l.a.createElement("div",{className:"modal-header"},l.a.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},l.a.createElement("span",{"aria-hidden":"true"},"×")),l.a.createElement("h4",{className:"modal-title",ref:"title"},l.a.createElement("div",{className:"modal-back"},l.a.createElement("span",{onClick:this.props.collapseModal},l.a.createElement(k.a,null))),l.a.createElement(g.a,{id:"user.settings.display.title",defaultMessage:"Display Settings"}))),l.a.createElement("div",{className:"user-settings"},l.a.createElement("h3",{id:"displaySettingsTitle",className:"tab-header"},l.a.createElement(g.a,{id:"user.settings.display.title",defaultMessage:"Display Settings"})),l.a.createElement("div",{className:"divider-dark first"}),c,a,s,i,t,e,n,r,o))}}Le(Ue,"propTypes",{user:r.a.object,updateSection:r.a.func,activeSection:r.a.string,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,setRequireConfirm:r.a.func.isRequired,setEnforceFocus:r.a.func.isRequired,timezones:r.a.array.isRequired,userTimezone:r.a.object.isRequired,allowCustomThemes:r.a.bool,enableLinkPreviews:r.a.bool,defaultClientLocale:r.a.string,enableThemeSelection:r.a.bool,configTeammateNameDisplay:r.a.string,currentUserTimezone:r.a.string,enableTimezone:r.a.bool,shouldAutoUpdateTimezone:r.a.bool,militaryTime:r.a.string,teammateNameDisplay:r.a.string,channelDisplayMode:r.a.string,messageDisplay:r.a.string,collapseDisplay:r.a.string,linkPreviewDisplay:r.a.string,lockTeammateNameDisplay:r.a.bool,actions:r.a.shape({getSupportedTimezones:r.a.func.isRequired,autoUpdateTimezone:r.a.func.isRequired,savePreferences:r.a.func.isRequired}).isRequired});var Fe=Object(s.connect)((function(e){const t=Object(d.getConfig)(e),a=Object(d.getSupportedTimezones)(e),s=Object(i.getCurrentUserId)(e),n=Object(R.getUserTimezone)(e,s),r=n&&n.useAutomaticTimezone&&!n.automaticTimezone,o=!n||r,l="true"===t.AllowCustomThemes,c="true"===t.EnableLinkPreviews,m=t.DefaultClientLocale,h="true"===t.EnableThemeSelection,g="true"===t.ExperimentalTimezone,f="true"===Object(d.getLicense)(e).LockTeammateNameDisplay&&"true"===t.LockTeammateNameDisplay,b=t.TeammateNameDisplay;return{lockTeammateNameDisplay:f,allowCustomThemes:l,configTeammateNameDisplay:b,enableLinkPreviews:c,defaultClientLocale:m,enableThemeSelection:h,enableTimezone:g,timezones:a,userTimezone:n,shouldAutoUpdateTimezone:o,currentUserTimezone:Object(j.getUserCurrentTimezone)(n),militaryTime:Object(u.get)(e,p.B.CATEGORY_DISPLAY_SETTINGS,p.B.USE_MILITARY_TIME,p.B.USE_MILITARY_TIME_DEFAULT),teammateNameDisplay:Object(u.get)(e,p.B.CATEGORY_DISPLAY_SETTINGS,p.B.NAME_NAME_FORMAT,b),channelDisplayMode:Object(u.get)(e,p.B.CATEGORY_DISPLAY_SETTINGS,p.B.CHANNEL_DISPLAY_MODE,p.B.CHANNEL_DISPLAY_MODE_DEFAULT),messageDisplay:Object(u.get)(e,p.B.CATEGORY_DISPLAY_SETTINGS,p.B.MESSAGE_DISPLAY,p.B.MESSAGE_DISPLAY_DEFAULT),collapseDisplay:Object(u.get)(e,p.B.CATEGORY_DISPLAY_SETTINGS,p.B.COLLAPSE_DISPLAY,p.B.COLLAPSE_DISPLAY_DEFAULT),linkPreviewDisplay:Object(u.get)(e,p.B.CATEGORY_DISPLAY_SETTINGS,p.B.LINK_PREVIEW_DISPLAY,p.B.LINK_PREVIEW_DISPLAY_DEFAULT)}}),(function(e){return{actions:Object(c.bindActionCreators)({getSupportedTimezones:P.getSupportedTimezones,autoUpdateTimezone:I.autoUpdateTimezone,savePreferences:m.savePreferences},e)}}))(Ue),ze=a(44),qe=(a(123),a(1128)),Be=a(328),Ge=a(46),He=a(325),Ve=a(1145),Ye=a(1455),Ke=a(1185);function We(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const Qe=Object(G.defineMessages)({usernameReserved:{id:Object(E.b)("user.settings.general.usernameReserved"),defaultMessage:"This username is reserved, please choose a new one."},usernameRestrictions:{id:Object(E.b)("user.settings.general.usernameRestrictions"),defaultMessage:"Username must begin with a letter, and contain between {min} to {max} lowercase characters made up of numbers, letters, and the symbols '.', '-', and '_'."},validEmail:{id:Object(E.b)("user.settings.general.validEmail"),defaultMessage:"Please enter a valid email address."},emailMatch:{id:Object(E.b)("user.settings.general.emailMatch"),defaultMessage:"The new emails you entered do not match."},incorrectPassword:{id:Object(E.b)("user.settings.general.incorrectPassword"),defaultMessage:"Your password is incorrect."},emptyPassword:{id:Object(E.b)("user.settings.general.emptyPassword"),defaultMessage:"Please enter your current password."},validImage:{id:Object(E.b)("user.settings.general.validImage"),defaultMessage:"Only BMP, JPG or PNG images may be used for profile pictures"},imageTooLarge:{id:Object(E.b)("user.settings.general.imageTooLarge"),defaultMessage:"Unable to upload profile image. File is too large."},uploadImage:{id:Object(E.b)("user.settings.general.uploadImage"),defaultMessage:"Click 'Edit' to upload an image."},uploadImageMobile:{id:Object(E.b)("user.settings.general.mobile.uploadImage"),defaultMessage:"Click to upload an image"},fullName:{id:Object(E.b)("user.settings.general.fullName"),defaultMessage:"Full Name"},nickname:{id:Object(E.b)("user.settings.general.nickname"),defaultMessage:"Nickname"},username:{id:Object(E.b)("user.settings.general.username"),defaultMessage:"Username"},profilePicture:{id:Object(E.b)("user.settings.general.profilePicture"),defaultMessage:"Profile Picture"},close:{id:Object(E.b)("user.settings.general.close"),defaultMessage:"Close"},position:{id:Object(E.b)("user.settings.general.position"),defaultMessage:"Position"}});class Je extends l.a.Component{constructor(e){super(e),We(this,"handleEmailResend",e=>{this.setState({resendStatus:"sending",showSpinner:!0}),this.props.actions.sendVerificationEmail(e).then(({data:e,error:t})=>{e?this.setState({resendStatus:"success"}):t&&this.setState({resendStatus:"failure"})})}),We(this,"createEmailResendLink",e=>l.a.createElement("span",{className:"resend-verification-wrapper"},l.a.createElement(Ke.a,{loading:this.state.showSpinner,text:b.jb("user.settings.general.sending","Sending")},l.a.createElement("a",{onClick:()=>{this.handleEmailResend(e),setTimeout(()=>{this.setState({showSpinner:!1})},500)}},l.a.createElement(g.a,{id:"user.settings.general.sendAgain",defaultMessage:"Send again"}))))),We(this,"submitUsername",()=>{const e=Object.assign({},this.props.user),t=this.state.username.trim().toLowerCase(),{formatMessage:a}=this.props.intl,s=b.hb(t);"Cannot use a reserved word as a username."!==s?s?this.setState({clientError:a(Qe.usernameRestrictions,{min:p.j.MIN_USERNAME_LENGTH,max:p.j.MAX_USERNAME_LENGTH}),serverError:""}):e.username!==t?(e.username=t,Object(He.d)("settings","user_settings_update",{field:"username"}),this.submitUser(e,!1)):this.updateSection(""):this.setState({clientError:a(Qe.usernameReserved),serverError:""})}),We(this,"submitNickname",()=>{const e=Object.assign({},this.props.user),t=this.state.nickname.trim();e.nickname!==t?(e.nickname=t,Object(He.d)("settings","user_settings_update",{field:"nickname"}),this.submitUser(e,!1)):this.updateSection("")}),We(this,"submitName",()=>{const e=Object.assign({},this.props.user),t=this.state.firstName.trim(),a=this.state.lastName.trim();e.first_name!==t||e.last_name!==a?(e.first_name=t,e.last_name=a,Object(He.d)("settings","user_settings_update",{field:"fullname"}),this.submitUser(e,!1)):this.updateSection("")}),We(this,"submitEmail",()=>{const e=Object.assign({},this.props.user),t=this.state.email.trim().toLowerCase(),a=this.state.confirmEmail.trim().toLowerCase(),s=this.state.currentPassword,{formatMessage:i}=this.props.intl;t!==e.email||""!==a&&a!==e.email?""!==t&&Object(Ge.isEmail)(t)?t===a?""!==s?(e.email=t,e.password=s,Object(He.d)("settings","user_settings_update",{field:"email"}),this.submitUser(e,!0)):this.setState({emailError:i(Qe.emptyPassword),clientError:"",serverError:""}):this.setState({emailError:i(Qe.emailMatch),clientError:"",serverError:""}):this.setState({emailError:i(Qe.validEmail),clientError:"",serverError:""}):this.updateSection("")}),We(this,"submitUser",(e,t)=>{const{formatMessage:a}=this.props.intl;this.setState({sectionIsSaving:!0}),this.props.actions.updateMe(e).then(({data:e,error:s})=>{if(e){this.updateSection(""),this.props.actions.getMe(),this.props.requireEmailVerification&&t&&(this.props.actions.clearErrors(),this.props.actions.logError({message:p.h.EMAIL_VERIFICATION_REQUIRED,type:p.i.SUCCESS},!0))}else if(s){let e;e=s.server_error_id&&"api.user.check_user_password.invalid.app_error"===s.server_error_id?a(Qe.incorrectPassword):s.message?s.message:s,this.setState({serverError:e,emailError:"",clientError:"",sectionIsSaving:!1})}})}),We(this,"setDefaultProfilePicture",async()=>{try{await this.props.actions.setDefaultProfileImage(this.props.user.id),this.updateSection(""),this.submitActive=!1}catch(e){let t;t=e.message?e.message:e,this.setState({serverError:t,emailError:"",clientError:"",sectionIsSaving:!1})}}),We(this,"submitPicture",()=>{if(!this.state.pictureFile)return;if(!this.submitActive)return;Object(He.d)("settings","user_settings_update",{field:"picture"});const{formatMessage:e}=this.props.intl,t=this.state.pictureFile;p.e.includes(t.type)?t.size>this.props.maxFileSize?this.setState({clientError:e(Qe.imageTooLarge),serverError:""}):(this.setState({loadingPicture:!0}),this.props.actions.uploadProfileImage(this.props.user.id,t).then(({data:e,error:t})=>{if(e)this.updateSection(""),this.submitActive=!1;else if(t){var a=this.setupInitialState(this.props);a.serverError=t.message,this.setState(a)}})):this.setState({clientError:e(Qe.validImage),serverError:""})}),We(this,"submitPosition",()=>{const e=Object.assign({},this.props.user),t=this.state.position.trim();e.position!==t?(e.position=t,Object(He.d)("settings","user_settings_update",{field:"position"}),this.submitUser(e,!1)):this.updateSection("")}),We(this,"updateUsername",e=>{this.setState({username:e.target.value})}),We(this,"updateFirstName",e=>{this.setState({firstName:e.target.value})}),We(this,"updateLastName",e=>{this.setState({lastName:e.target.value})}),We(this,"updateNickname",e=>{this.setState({nickname:e.target.value})}),We(this,"updatePosition",e=>{this.setState({position:e.target.value})}),We(this,"updateEmail",e=>{this.setState({email:e.target.value})}),We(this,"updateConfirmEmail",e=>{this.setState({confirmEmail:e.target.value})}),We(this,"updateCurrentPassword",e=>{this.setState({currentPassword:e.target.value})}),We(this,"updatePicture",e=>{e.target.files&&e.target.files[0]?(this.setState({pictureFile:e.target.files[0]}),this.submitActive=!0,this.setState({clientError:null})):this.setState({pictureFile:null})}),We(this,"updateSection",e=>{this.setState(Object.assign({},this.setupInitialState(this.props),{clientError:"",serverError:"",emailError:"",sectionIsSaving:!1})),this.submitActive=!1,this.props.updateSection(e)}),this.submitActive=!1,this.state=this.setupInitialState(e)}setupInitialState(e){const t=e.user;return{username:t.username,firstName:t.first_name,lastName:t.last_name,nickname:t.nickname,position:t.position,originalEmail:t.email,email:"",confirmEmail:"",currentPassword:"",pictureFile:null,loadingPicture:!1,sectionIsSaving:!1,showSpinner:!1}}createEmailSection(){const{formatMessage:e}=this.props.intl;let t;if("email"===this.props.activeSection){const a=this.props.requireEmailVerification,s=[];let i=l.a.createElement(g.a,{id:"user.settings.general.emailHelp1",defaultMessage:"Email is used for sign-in, notifications, and password reset. Email requires verification if changed."});a||(i=l.a.createElement(g.a,{id:"user.settings.general.emailHelp3",defaultMessage:"Email is used for sign-in, notifications, and password reset."}));let n=null;""===this.props.user.auth_service?(s.push(l.a.createElement("div",{key:"currentEmailSetting"},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{className:"col-sm-5 control-label"},l.a.createElement(g.a,{id:"user.settings.general.currentEmail",defaultMessage:"Current Email"})),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("label",{className:"control-label word-break--all text-left"},this.state.originalEmail))))),s.push(l.a.createElement("div",{key:"emailSetting"},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{className:"col-sm-5 control-label"},l.a.createElement(g.a,{id:"user.settings.general.newEmail",defaultMessage:"New Email"})),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("input",{autoFocus:!0,id:"primaryEmail",className:"form-control",type:"email",onChange:this.updateEmail,maxLength:p.j.MAX_EMAIL_LENGTH,value:this.state.email,"aria-label":e({id:"user.settings.general.newEmail",defaultMessage:"New Email"})}))))),s.push(l.a.createElement("div",{key:"confirmEmailSetting"},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{className:"col-sm-5 control-label"},l.a.createElement(g.a,{id:"user.settings.general.confirmEmail",defaultMessage:"Confirm Email"})),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("input",{id:"confirmEmail",className:"form-control",type:"email",onChange:this.updateConfirmEmail,maxLength:p.j.MAX_EMAIL_LENGTH,value:this.state.confirmEmail,"aria-label":e({id:"user.settings.general.confirmEmail",defaultMessage:"Confirm Email"})}))))),s.push(l.a.createElement("div",{key:"currentPassword"},l.a.createElement("div",{className:"form-group"},l.a.createElement("label",{className:"col-sm-5 control-label"},l.a.createElement(g.a,{id:"user.settings.general.currentPassword",defaultMessage:"Current Password"})),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("input",{id:"currentPassword",className:"form-control",type:"password",onChange:this.updateCurrentPassword,value:this.state.currentPassword,"aria-label":e({id:"user.settings.general.currentPassword",defaultMessage:"Current Password"})}))),i)),n=this.submitEmail):this.props.user.auth_service===p.j.GITLAB_SERVICE?s.push(l.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},l.a.createElement("div",{className:"setting-list__hint pb-3"},l.a.createElement(g.a,{id:"user.settings.general.emailGitlabCantUpdate",defaultMessage:"Login occurs through GitLab. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),i)):this.props.user.auth_service===p.j.GOOGLE_SERVICE?s.push(l.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},l.a.createElement("div",{className:"setting-list__hint pb-3"},l.a.createElement(g.a,{id:"user.settings.general.emailGoogleCantUpdate",defaultMessage:"Login occurs through Google Apps. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),i)):this.props.user.auth_service===p.j.OFFICE365_SERVICE?s.push(l.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},l.a.createElement("div",{className:"setting-list__hint pb-3"},l.a.createElement(g.a,{id:"user.settings.general.emailOffice365CantUpdate",defaultMessage:"Login occurs through Office 365. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),i)):this.props.user.auth_service===p.j.LDAP_SERVICE?s.push(l.a.createElement("div",{key:"oauthEmailInfo",className:"pb-2"},l.a.createElement("div",{className:"setting-list__hint pb-3"},l.a.createElement(g.a,{id:"user.settings.general.emailLdapCantUpdate",defaultMessage:"Login occurs through AD/LDAP. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})))):this.props.user.auth_service===p.j.SAML_SERVICE&&s.push(l.a.createElement("div",{key:"oauthEmailInfo",className:"pb-2"},l.a.createElement("div",{className:"setting-list__hint pb-3"},l.a.createElement(g.a,{id:"user.settings.general.emailSamlCantUpdate",defaultMessage:"Login occurs through SAML. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),i)),t=l.a.createElement(v.a,{title:l.a.createElement(g.a,{id:"user.settings.general.email",defaultMessage:"Email"}),inputs:s,submit:n,saving:this.state.sectionIsSaving,serverError:this.state.serverError,clientError:this.state.emailError,updateSection:this.updateSection})}else{let e="";""===this.props.user.auth_service?e=this.props.user.email:this.props.user.auth_service===p.j.GITLAB_SERVICE?e=l.a.createElement(g.a,{id:"user.settings.general.loginGitlab",defaultMessage:"Login done through GitLab ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===p.j.GOOGLE_SERVICE?e=l.a.createElement(g.a,{id:"user.settings.general.loginGoogle",defaultMessage:"Login done through Google Apps ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===p.j.OFFICE365_SERVICE?e=l.a.createElement(g.a,{id:"user.settings.general.loginOffice365",defaultMessage:"Login done through Office 365 ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===p.j.LDAP_SERVICE?e=l.a.createElement(g.a,{id:"user.settings.general.loginLdap",defaultMessage:"Login done through AD/LDAP ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===p.j.SAML_SERVICE&&(e=l.a.createElement(g.a,{id:"user.settings.general.loginSaml",defaultMessage:"Login done through SAML ({email})",values:{email:this.state.originalEmail}})),t=l.a.createElement(S.a,{title:l.a.createElement(g.a,{id:"user.settings.general.email",defaultMessage:"Email"}),describe:e,section:"email",updateSection:this.updateSection})}return t}render(){const e=this.props.user,{formatMessage:t}=this.props.intl;let a=null;this.state.clientError&&(a=this.state.clientError);let s,i=null;this.state.serverError&&(i=this.state.serverError);const n=[];if("name"===this.props.activeSection){let e,r=null;if("ldap"===this.props.user.auth_service&&(this.props.ldapFirstNameAttributeSet||this.props.ldapLastNameAttributeSet)||this.props.user.auth_service===p.j.SAML_SERVICE&&(this.props.samlFirstNameAttributeSet||this.props.samlLastNameAttributeSet))e=l.a.createElement("span",null,l.a.createElement(g.a,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so through your login provider."}));else{n.push(l.a.createElement("div",{key:"firstNameSetting",className:"form-group"},l.a.createElement("label",{className:"col-sm-5 control-label"},l.a.createElement(g.a,{id:"user.settings.general.firstName",defaultMessage:"First Name"})),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("input",{id:"firstName",autoFocus:!0,className:"form-control",type:"text",onChange:this.updateFirstName,maxLength:p.j.MAX_FIRSTNAME_LENGTH,value:this.state.firstName,onFocus:b.lb,"aria-label":t({id:"user.settings.general.firstName",defaultMessage:"First Name"})})))),n.push(l.a.createElement("div",{key:"lastNameSetting",className:"form-group"},l.a.createElement("label",{className:"col-sm-5 control-label"},l.a.createElement(g.a,{id:"user.settings.general.lastName",defaultMessage:"Last Name"})),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("input",{id:"lastName",className:"form-control",type:"text",onChange:this.updateLastName,maxLength:p.j.MAX_LASTNAME_LENGTH,value:this.state.lastName,"aria-label":t({id:"user.settings.general.lastName",defaultMessage:"Last Name"})}))));const a=l.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),this.updateSection(""),this.props.updateTab("notifications")}.bind(this)},l.a.createElement(g.a,{id:"user.settings.general.notificationsLink",defaultMessage:"Notifications"}));e=l.a.createElement("span",null,l.a.createElement(g.a,{id:"user.settings.general.notificationsExtra",defaultMessage:"By default, you will receive mention notifications when someone types your first name. Go to {notify} settings to change this default.",values:{notify:a}})),r=this.submitName}s=l.a.createElement(v.a,{title:t(Qe.fullName),inputs:n,submit:r,saving:this.state.sectionIsSaving,serverError:i,clientError:a,updateSection:this.updateSection,extraInfo:e})}else{let a="";e.first_name&&e.last_name?a=e.first_name+" "+e.last_name:e.first_name?a=e.first_name:e.last_name?a=e.last_name:(a=l.a.createElement(g.a,{id:"user.settings.general.emptyName",defaultMessage:"Click 'Edit' to add your full name"}),b.ab()&&(a=l.a.createElement(g.a,{id:"user.settings.general.mobile.emptyName",defaultMessage:"Click to add your full name"}))),s=l.a.createElement(S.a,{title:t(Qe.fullName),describe:a,section:"name",updateSection:this.updateSection})}let r,o,c;if("nickname"===this.props.activeSection){let e,s=null;if("ldap"===this.props.user.auth_service&&this.props.ldapNicknameAttributeSet||this.props.user.auth_service===p.j.SAML_SERVICE&&this.props.samlNicknameAttributeSet)e=l.a.createElement("span",null,l.a.createElement(g.a,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so though your login provider."}));else{let a=l.a.createElement(g.a,{id:"user.settings.general.nickname",defaultMessage:"Nickname"});b.ab()&&(a=""),n.push(l.a.createElement("div",{key:"nicknameSetting",className:"form-group"},l.a.createElement("label",{className:"col-sm-5 control-label"},a),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("input",{id:"nickname",autoFocus:!0,className:"form-control",type:"text",onChange:this.updateNickname,value:this.state.nickname,maxLength:p.j.MAX_NICKNAME_LENGTH,autoCapitalize:"off","aria-label":t({id:"user.settings.general.nickname",defaultMessage:"Nickname"})})))),e=l.a.createElement("span",null,l.a.createElement(g.a,{id:"user.settings.general.nicknameExtra",defaultMessage:"Use Nickname for a name you might be called that is different from your first name and username. This is most often used when two or more people have similar sounding names and usernames."})),s=this.submitNickname}r=l.a.createElement(v.a,{title:t(Qe.nickname),inputs:n,submit:s,saving:this.state.sectionIsSaving,serverError:i,clientError:a,updateSection:this.updateSection,extraInfo:e})}else{let a="";e.nickname?a=e.nickname:(a=l.a.createElement(g.a,{id:"user.settings.general.emptyNickname",defaultMessage:"Click 'Edit' to add a nickname"}),b.ab()&&(a=l.a.createElement(g.a,{id:"user.settings.general.mobile.emptyNickname",defaultMessage:"Click to add a nickname"}))),r=l.a.createElement(S.a,{title:t(Qe.nickname),describe:a,section:"nickname",updateSection:this.updateSection})}if("username"===this.props.activeSection){let e,s=null;if(""===this.props.user.auth_service){let a=l.a.createElement(g.a,{id:"user.settings.general.username",defaultMessage:"Username"});b.ab()&&(a=""),n.push(l.a.createElement("div",{key:"usernameSetting",className:"form-group"},l.a.createElement("label",{className:"col-sm-5 control-label"},a),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("input",{id:"username",autoFocus:!0,maxLength:p.j.MAX_USERNAME_LENGTH,className:"form-control",type:"text",onChange:this.updateUsername,value:this.state.username,autoCapitalize:"off",onFocus:b.lb,"aria-label":t({id:"user.settings.general.username",defaultMessage:"Username"})})))),e=l.a.createElement("span",null,l.a.createElement(g.a,{id:"user.settings.general.usernameInfo",defaultMessage:"Pick something easy for teammates to recognize and recall."})),s=this.submitUsername}else e=l.a.createElement("span",null,l.a.createElement(g.a,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so though your login provider."}));o=l.a.createElement(v.a,{title:t(Qe.username),inputs:n,submit:s,saving:this.state.sectionIsSaving,serverError:i,clientError:a,updateSection:this.updateSection,extraInfo:e})}else o=l.a.createElement(S.a,{title:t(Qe.username),describe:this.props.user.username,section:"username",updateSection:this.updateSection});if("position"===this.props.activeSection){let e,s=null;if(this.props.user.auth_service===p.j.LDAP_SERVICE&&this.props.ldapPositionAttributeSet||this.props.user.auth_service===p.j.SAML_SERVICE&&this.props.samlPositionAttributeSet)e=l.a.createElement("span",null,l.a.createElement(g.a,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so though your login provider."}));else{let a=l.a.createElement(g.a,{id:"user.settings.general.position",defaultMessage:"Position"});b.ab()&&(a=""),n.push(l.a.createElement("div",{key:"positionSetting",className:"form-group"},l.a.createElement("label",{className:"col-sm-5 control-label"},a),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("input",{id:"position",autoFocus:!0,className:"form-control",type:"text",onChange:this.updatePosition,value:this.state.position,maxLength:p.j.MAX_POSITION_LENGTH,autoCapitalize:"off",onFocus:b.lb,"aria-label":t({id:"user.settings.general.position",defaultMessage:"Position"})})))),e=l.a.createElement("span",null,l.a.createElement(g.a,{id:"user.settings.general.positionExtra",defaultMessage:"Use Position for your role or job title. This will be shown in your profile popover."})),s=this.submitPosition}c=l.a.createElement(v.a,{title:t(Qe.position),inputs:n,submit:s,saving:this.state.sectionIsSaving,serverError:i,clientError:a,updateSection:this.updateSection,extraInfo:e})}else{let a="";e.position?a=e.position:(a=l.a.createElement(g.a,{id:"user.settings.general.emptyPosition",defaultMessage:"Click 'Edit' to add your job title / position"}),b.ab()&&(a=l.a.createElement(g.a,{id:"user.settings.general.mobile.emptyPosition",defaultMessage:"Click to add your job title / position"}))),c=l.a.createElement(S.a,{title:t(Qe.position),describe:a,section:"position",updateSection:this.updateSection})}const d=this.createEmailSection();let u;if("picture"===this.props.activeSection)u=l.a.createElement(Ye.a,{title:t(Qe.profilePicture),onSubmit:this.submitPicture,onSetDefault:e.last_picture_update>0?this.setDefaultProfilePicture:null,src:b.N(e.id,e.last_picture_update),defaultImageSrc:b.i(e.id),serverError:i,clientError:a,updateSection:e=>{this.updateSection(""),e.preventDefault()},file:this.state.pictureFile,onFileChange:this.updatePicture,submitActive:this.submitActive,loadingPicture:this.state.loadingPicture,maxFileSize:this.props.maxFileSize});else{let a=t(Qe.uploadImage);b.ab()&&(a=t(Qe.uploadImageMobile)),e.last_picture_update&&(a=l.a.createElement(g.a,{id:"user.settings.general.imageUpdated",defaultMessage:"Image last updated {date}",values:{date:l.a.createElement(qe.a,{value:new Date(e.last_picture_update),day:"2-digit",month:"short",year:"numeric"})}})),u=l.a.createElement(S.a,{title:t(Qe.profilePicture),describe:a,section:"picture",updateSection:this.updateSection})}return l.a.createElement("div",{id:"generalSettings"},l.a.createElement("div",{className:"modal-header"},l.a.createElement("button",{id:"closeUserSettings",type:"button",className:"close","data-dismiss":"modal","aria-label":t(Qe.close),onClick:this.props.closeModal},l.a.createElement("span",{"aria-hidden":"true"},"×")),l.a.createElement("h4",{className:"modal-title",ref:"title"},l.a.createElement("div",{className:"modal-back"},l.a.createElement(g.a,{id:"generic_icons.collapse",defaultMessage:"Collapse Icon"},e=>l.a.createElement("i",{className:"fa fa-angle-left",title:e,onClick:this.props.collapseModal}))),l.a.createElement(g.a,{id:"user.settings.general.title",defaultMessage:"General Settings"}))),l.a.createElement("div",{className:"user-settings"},l.a.createElement("h3",{id:"generalSettingsTitle",className:"tab-header"},l.a.createElement(g.a,{id:"user.settings.general.title",defaultMessage:"General Settings"})),l.a.createElement("div",{className:"divider-dark first"}),s,l.a.createElement("div",{className:"divider-light"}),o,l.a.createElement("div",{className:"divider-light"}),r,l.a.createElement("div",{className:"divider-light"}),c,l.a.createElement("div",{className:"divider-light"}),d,l.a.createElement("div",{className:"divider-light"}),u,l.a.createElement("div",{className:"divider-dark"})))}}We(Je,"propTypes",{intl:Ve.a.isRequired,user:r.a.object.isRequired,updateSection:r.a.func.isRequired,updateTab:r.a.func.isRequired,activeSection:r.a.string.isRequired,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,actions:r.a.shape({logError:r.a.func.isRequired,clearErrors:r.a.func.isRequired,getMe:r.a.func.isRequired,updateMe:r.a.func.isRequired,sendVerificationEmail:r.a.func.isRequired,setDefaultProfileImage:r.a.func.isRequired,uploadProfileImage:r.a.func.isRequired}).isRequired,requireEmailVerification:r.a.bool,maxFileSize:r.a.number,ldapFirstNameAttributeSet:r.a.bool,ldapLastNameAttributeSet:r.a.bool,samlFirstNameAttributeSet:r.a.bool,samlLastNameAttributeSet:r.a.bool,ldapNicknameAttributeSet:r.a.bool,samlNicknameAttributeSet:r.a.bool,ldapPositionAttributeSet:r.a.bool,samlPositionAttributeSet:r.a.bool});var Xe=Object(Be.c)(Je);var Ze=Object(s.connect)((function(e){const t=Object(d.getConfig)(e);return{requireEmailVerification:"true"===t.RequireEmailVerification,maxFileSize:parseInt(t.MaxFileSize,10),ldapFirstNameAttributeSet:"true"===t.LdapFirstNameAttributeSet,ldapLastNameAttributeSet:"true"===t.LdapLastNameAttributeSet,samlFirstNameAttributeSet:"true"===t.SamlFirstNameAttributeSet,samlLastNameAttributeSet:"true"===t.SamlLastNameAttributeSet,ldapNicknameAttributeSet:"true"===t.LdapNicknameAttributeSet,samlNicknameAttributeSet:"true"===t.SamlNicknameAttributeSet,samlPositionAttributeSet:"true"===t.SamlPositionAttributeSet,ldapPositionAttributeSet:"true"===t.LdapPositionAttributeSet}}),(function(e){return{actions:Object(c.bindActionCreators)({logError:ze.logError,clearErrors:ze.clearErrors,getMe:h.getMe,updateMe:h.updateMe,sendVerificationEmail:h.sendVerificationEmail,setDefaultProfileImage:h.setDefaultProfileImage,uploadProfileImage:h.uploadProfileImage},e)}}))(Xe);function $e(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class et extends l.a.Component{constructor(...e){super(...e),$e(this,"handleMinUpdateSection",e=>{this.props.updateSection(e),this.props.cancel()}),$e(this,"handleMaxUpdateSection",e=>{this.props.updateSection(e)}),$e(this,"handleOnChange",e=>{const t=e.currentTarget.getAttribute("data-key"),a=e.currentTarget.getAttribute("data-value");this.props.setParentState(t,a)}),$e(this,"buildMaximizedSetting",()=>{const e=[],t=[!1,!1,!1];let a;if(this.props.activity===p.v.MENTION?t[1]=!0:this.props.activity===p.v.NONE?t[2]=!0:t[0]=!0,this.props.activity!==p.v.NONE){const e=[!1,!1];"false"===this.props.sound?e[1]=!0:e[0]=!0,a=b.L()?l.a.createElement("fieldset",null,l.a.createElement("legend",{className:"form-legend"},l.a.createElement(g.a,{id:"user.settings.notifications.desktop.sound",defaultMessage:"Notification sound"})),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"soundOn",type:"radio",name:"notificationSounds",checked:e[0],"data-key":"desktopSound","data-value":"true",onChange:this.handleOnChange}),l.a.createElement(g.a,{id:"user.settings.notifications.on",defaultMessage:"On"})),l.a.createElement("br",null)),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"soundOff",type:"radio",name:"notificationSounds",checked:e[1],"data-key":"desktopSound","data-value":"false",onChange:this.handleOnChange}),l.a.createElement(g.a,{id:"user.settings.notifications.off",defaultMessage:"Off"})),l.a.createElement("br",null)),l.a.createElement("div",{className:"mt-5"},l.a.createElement(g.a,{id:"user.settings.notifications.sounds_info",defaultMessage:"Notification sounds are available on Firefox, Edge, Safari, Chrome and Mattermost Desktop Apps."}))):l.a.createElement("fieldset",null,l.a.createElement("legend",{className:"form-legend"},l.a.createElement(g.a,{id:"user.settings.notifications.desktop.sound",defaultMessage:"Notification sound"})),l.a.createElement("br",null),l.a.createElement(g.a,{id:"user.settings.notifications.soundConfig",defaultMessage:"Please configure notification sounds in your browser settings"}))}return e.push(l.a.createElement("div",{key:"userNotificationLevelOption"},l.a.createElement("fieldset",null,l.a.createElement("legend",{className:"form-legend"},l.a.createElement(g.a,{id:"user.settings.notifications.desktop",defaultMessage:"Send desktop notifications"})),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"desktopNotificationAllActivity",type:"radio",name:"desktopNotificationLevel",checked:t[0],"data-key":"desktopActivity","data-value":p.v.ALL,onChange:this.handleOnChange}),l.a.createElement(g.a,{id:"user.settings.notifications.allActivity",defaultMessage:"For all activity"})),l.a.createElement("br",null)),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"desktopNotificationMentions",type:"radio",name:"desktopNotificationLevel",checked:t[1],"data-key":"desktopActivity","data-value":p.v.MENTION,onChange:this.handleOnChange}),l.a.createElement(g.a,{id:"user.settings.notifications.onlyMentions",defaultMessage:"Only for mentions and direct messages"})),l.a.createElement("br",null)),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"desktopNotificationNever",type:"radio",name:"desktopNotificationLevel",checked:t[2],"data-key":"desktopActivity","data-value":p.v.NONE,onChange:this.handleOnChange}),l.a.createElement(g.a,{id:"user.settings.notifications.never",defaultMessage:"Never"}))),l.a.createElement("div",{className:"mt-5"},l.a.createElement(g.a,{id:"user.settings.notifications.info",defaultMessage:"Desktop notifications are available on Edge, Firefox, Safari, Chrome and Mattermost Desktop Apps."}))),l.a.createElement("hr",null),a)),l.a.createElement(v.a,{title:b.jb("user.settings.notifications.desktop.title","Desktop Notifications"),inputs:e,submit:this.props.submit,saving:this.props.saving,server_error:this.props.error,updateSection:this.handleMaxUpdateSection})}),$e(this,"buildMinimizedSetting",()=>{let e;const t=b.L();return e=this.props.activity===p.v.MENTION?t&&"false"!==this.props.sound?{id:Object(E.b)("user.settings.notifications.desktop.mentionsSound"),defaultMessage:"For mentions and direct messages, with sound"}:t&&"false"===this.props.sound?{id:Object(E.b)("user.settings.notifications.desktop.mentionsNoSound"),defaultMessage:"For mentions and direct messages, without sound"}:{id:Object(E.b)("user.settings.notifications.desktop.mentionsSoundHidden"),defaultMessage:"For mentions and direct messages"}:this.props.activity===p.v.NONE?{id:Object(E.b)("user.settings.notifications.off"),defaultMessage:"Off"}:t&&"false"!==this.props.sound?{id:Object(E.b)("user.settings.notifications.desktop.allSound"),defaultMessage:"For all activity, with sound"}:t&&"false"===this.props.sound?{id:Object(E.b)("user.settings.notifications.desktop.allNoSound"),defaultMessage:"For all activity, without sound"}:{id:Object(E.b)("user.settings.notifications.desktop.allSoundHidden"),defaultMessage:"For all activity"},l.a.createElement(S.a,{title:b.jb("user.settings.notifications.desktop.title","Desktop Notifications"),describe:l.a.createElement(g.a,e),focused:this.props.focused,section:"desktop",updateSection:this.handleMinUpdateSection})})}render(){return this.props.active?this.buildMaximizedSetting():this.buildMinimizedSetting()}}et.propTypes={activity:r.a.string.isRequired,sound:r.a.string.isRequired,updateSection:r.a.func,setParentState:r.a.func,submit:r.a.func,cancel:r.a.func,error:r.a.string,active:r.a.bool,saving:r.a.bool,focused:r.a.bool};var tt=a(105),at=a(1985);function st(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class it extends l.a.PureComponent{constructor(e){super(e),st(this,"handleChange",e=>{const t=e.currentTarget.getAttribute("data-enable-email");this.setState({enableEmail:t,newInterval:parseInt(e.currentTarget.getAttribute("data-email-interval"),10)}),this.props.onChange(t)}),st(this,"handleSubmit",async()=>{const{newInterval:e}=this.state;if(this.props.emailInterval===e&&this.props.enableEmail===this.state.enableEmail)this.props.updateSection("");else{const{currentUserId:t,actions:a}=this.props,s={user_id:t,category:p.B.CATEGORY_NOTIFICATIONS,name:p.B.EMAIL_INTERVAL,value:e.toString()};await a.savePreferences(t,[s]),this.props.onSubmit()}}),st(this,"handleUpdateSection",e=>{e?this.props.updateSection(e):(this.props.updateSection(""),this.setState({enableEmail:this.props.enableEmail,newInterval:this.props.emailInterval}),this.props.onCancel())}),st(this,"renderMinSettingView",()=>{const{enableEmail:e,focused:t,sendEmailNotifications:a}=this.props,{newInterval:s}=this.state;let i;if(a)if(e)switch(s){case p.B.INTERVAL_IMMEDIATE:i=l.a.createElement(g.a,{id:"user.settings.notifications.email.immediately",defaultMessage:"Immediately"});break;case p.B.INTERVAL_HOUR:i=l.a.createElement(g.a,{id:"user.settings.notifications.email.everyHour",defaultMessage:"Every hour"});break;case p.B.INTERVAL_FIFTEEN_MINUTES:i=l.a.createElement(g.a,{id:"user.settings.notifications.email.everyXMinutes",defaultMessage:"Every {count, plural, one {minute} other {{count, number} minutes}}",values:{count:s/60}});break;default:i=l.a.createElement(g.a,{id:"user.settings.notifications.email.never",defaultMessage:"Never"})}else i=l.a.createElement(g.a,{id:"user.settings.notifications.email.never",defaultMessage:"Never"});else i=l.a.createElement(g.a,{id:"user.settings.notifications.email.disabled",defaultMessage:"Email notifications are not enabled"});return l.a.createElement(S.a,{title:Object(b.jb)("user.settings.notifications.emailNotifications","Email Notifications"),describe:i,focused:t,section:"email",updateSection:this.handleUpdateSection})}),st(this,"renderMaxSettingView",()=>{if(!this.props.sendEmailNotifications)return l.a.createElement(v.a,{title:Object(b.jb)("user.settings.notifications.emailNotifications","Email Notifications"),inputs:[l.a.createElement("div",{key:"oauthEmailInfo",className:"pt-2"},l.a.createElement(g.a,{id:"user.settings.notifications.email.disabled_long",defaultMessage:"Email notifications have not been enabled by your System Administrator."}))],server_error:this.props.serverError,section:"email",updateSection:this.handleUpdateSection});const{newInterval:e}=this.state;let t=null,a=null;return this.props.enableEmailBatching&&(t=l.a.createElement("fieldset",null,l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"emailNotificationMinutes",type:"radio",name:"emailNotifications",checked:e===p.B.INTERVAL_FIFTEEN_MINUTES,"data-enable-email":"true","data-email-interval":p.B.INTERVAL_FIFTEEN_MINUTES,onChange:this.handleChange}),l.a.createElement(g.a,{id:"user.settings.notifications.email.everyXMinutes",defaultMessage:"Every {count} minutes",values:{count:p.B.INTERVAL_FIFTEEN_MINUTES/60}}))),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"emailNotificationHour",type:"radio",name:"emailNotifications",checked:e===p.B.INTERVAL_HOUR,"data-enable-email":"true","data-email-interval":p.B.INTERVAL_HOUR,onChange:this.handleChange}),l.a.createElement(g.a,{id:"user.settings.notifications.email.everyHour",defaultMessage:"Every hour"})))),a=l.a.createElement(g.a,{id:"user.settings.notifications.emailBatchingInfo",defaultMessage:"Notifications received over the time period selected are combined and sent in a single email."})),l.a.createElement(v.a,{title:Object(b.jb)("user.settings.notifications.emailNotifications","Email Notifications"),inputs:[l.a.createElement("fieldset",{key:"userNotificationEmailOptions"},l.a.createElement("legend",{className:"form-legend"},l.a.createElement(g.a,{id:"user.settings.notifications.email.send",defaultMessage:"Send email notifications"})),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"emailNotificationImmediately",type:"radio",name:"emailNotifications",checked:e===p.B.INTERVAL_IMMEDIATE,"data-enable-email":"true","data-email-interval":p.B.INTERVAL_IMMEDIATE,onChange:this.handleChange}),l.a.createElement(g.a,{id:"user.settings.notifications.email.immediately",defaultMessage:"Immediately"}))),t,l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"emailNotificationNever",type:"radio",name:"emailNotifications",checked:e===p.B.INTERVAL_NEVER,"data-enable-email":"false","data-email-interval":p.B.INTERVAL_NEVER,onChange:this.handleChange}),l.a.createElement(g.a,{id:"user.settings.notifications.email.never",defaultMessage:"Never"}))),l.a.createElement("div",{className:"mt-3"},l.a.createElement(g.a,{id:"user.settings.notifications.emailInfo",defaultMessage:"Email notifications are sent for mentions and direct messages when you are offline or away for more than 5 minutes."})," ",a))],submit:this.handleSubmit,saving:this.props.saving,server_error:this.props.serverError,updateSection:this.handleUpdateSection})});const{emailInterval:t,enableEmail:a,enableEmailBatching:s,sendEmailNotifications:i,activeSection:n}=e;this.state={activeSection:n,emailInterval:t,enableEmail:a,enableEmailBatching:s,sendEmailNotifications:i,newInterval:Object(at.getEmailInterval)(a&&i,s,t)}}static getDerivedStateFromProps(e,t){const{emailInterval:a,enableEmail:s,enableEmailBatching:i,sendEmailNotifications:n,activeSection:r}=e;return"email"===r&&"email"!==t.activeSection||n!==t.sendEmailNotifications||i!==t.enableEmailBatching||a!==t.emailInterval||r!==t.activeSection?{activeSection:r,emailInterval:a,enableEmail:s,enableEmailBatching:i,sendEmailNotifications:n,newInterval:Object(at.getEmailInterval)(s&&n,i,a)}:null}render(){return"email"!==this.props.activeSection?this.renderMinSettingView():this.renderMaxSettingView()}}st(it,"propTypes",{currentUserId:r.a.string.isRequired,activeSection:r.a.string.isRequired,updateSection:r.a.func.isRequired,enableEmail:r.a.bool.isRequired,emailInterval:r.a.number.isRequired,onSubmit:r.a.func.isRequired,onCancel:r.a.func.isRequired,onChange:r.a.func.isRequired,serverError:r.a.string,saving:r.a.bool,focused:r.a.bool,sendEmailNotifications:r.a.bool,enableEmailBatching:r.a.bool,actions:r.a.shape({savePreferences:r.a.func.isRequired}).isRequired});var nt=Object(s.connect)((function(e){const t=Object(d.getConfig)(e),a=parseInt(Object(u.get)(e,C.Preferences.CATEGORY_NOTIFICATIONS,C.Preferences.EMAIL_INTERVAL,C.Preferences.INTERVAL_NOT_SET.toString()),10);return{currentUserId:Object(tt.getCurrentUserId)(e),emailInterval:a,enableEmailBatching:"true"===t.EnableEmailBatching,sendEmailNotifications:"true"===t.SendEmailNotifications}}),(function(e){return{actions:Object(c.bindActionCreators)({savePreferences:m.savePreferences},e)}}))(it),rt=a(1434);function ot(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class lt extends l.a.PureComponent{constructor(...e){super(...e),ot(this,"handleAutoResponderChecked",e=>{this.props.setParentState("autoResponderActive",e.target.checked)}),ot(this,"onMessageChanged",e=>{this.props.setParentState("autoResponderMessage",e.target.value)})}render(){const{autoResponderActive:e,autoResponderMessage:t}=this.props;let a;this.props.error&&(a=l.a.createElement("label",{className:"has-error"},this.props.error));const s=[],i=l.a.createElement("div",{id:"autoResponderCheckbox",key:"autoResponderCheckbox",className:"checkbox"},l.a.createElement("label",null,l.a.createElement("input",{id:"autoResponderActive",type:"checkbox",checked:e,onChange:this.handleAutoResponderChecked}),l.a.createElement(g.a,{id:"user.settings.notifications.autoResponderEnabled",defaultMessage:"Enabled"}))),n=l.a.createElement("div",{id:"autoResponderMessage",key:"autoResponderMessage"},l.a.createElement("div",{className:"pt-2"},l.a.createElement(rt.a,{style:{resize:"none"},id:"autoResponderMessageInput",className:"form-control",rows:"5",placeholder:Object(b.jb)("user.settings.notifications.autoResponderPlaceholder","Message"),value:t,maxLength:200,onChange:this.onMessageChanged}),a));return s.push(i),e&&s.push(n),s.push(l.a.createElement("div",{key:"autoResponderHint",className:"mt-5"},l.a.createElement(ge.a,{id:"user.settings.notifications.autoResponderHint",defaultMessage:"Set a custom message that will be automatically sent in response to Direct Messages. Mentions in Public and Private Channels will not trigger the automated reply. Enabling Automatic Replies sets your status to Out of Office and disables email and push notifications."}))),l.a.createElement(v.a,{title:l.a.createElement(g.a,{id:"user.settings.notifications.autoResponder",defaultMessage:"Automatic Direct Message Replies"}),width:"medium",shiftEnter:!0,submit:this.props.submit,saving:this.props.saving,inputs:s,updateSection:this.props.updateSection})}}function ct(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function dt(e){const t=e.user;let a=p.v.MENTION,s="true",i="never",n="true",r=p.v.MENTION,o=p.Q.UserStatuses.AWAY,l=!1,c=b.jb("user.settings.notifications.autoResponderDefault","Hello, I am out of office and unable to respond to messages.");t.notify_props&&(t.notify_props.desktop&&(a=t.notify_props.desktop),t.notify_props.desktop_sound&&(s=t.notify_props.desktop_sound),t.notify_props.comments&&(i=t.notify_props.comments),t.notify_props.email&&(n=t.notify_props.email),t.notify_props.push&&(r=t.notify_props.push),t.notify_props.push_status&&(o=t.notify_props.push_status),t.notify_props.auto_responder_active&&(l="true"===t.notify_props.auto_responder_active),t.notify_props.auto_responder_message&&(c=t.notify_props.auto_responder_message));let d=!1,u="",m=!1,h=!1;if(t.notify_props){if(t.notify_props.mention_keys){const e=t.notify_props.mention_keys.split(",");-1===e.indexOf(t.username)?d=!1:(d=!0,e.splice(e.indexOf(t.username),1),-1!==e.indexOf("@".concat(t.username))&&e.splice(e.indexOf("@".concat(t.username)),1)),u=e.join(",")}t.notify_props.first_name&&(m="true"===t.notify_props.first_name),t.notify_props.channel&&(h="true"===t.notify_props.channel)}return{desktopActivity:a,enableEmail:n,pushActivity:r,pushStatus:o,desktopSound:s,usernameKey:d,customKeys:u,customKeysChecked:u.length>0,firstNameKey:m,channelKey:h,autoResponderActive:l,autoResponderMessage:c,notifyCommentsLevel:i,isSaving:!1}}ot(lt,"propTypes",{autoResponderActive:r.a.bool.isRequired,autoResponderMessage:r.a.string.isRequired,updateSection:r.a.func.isRequired,setParentState:r.a.func.isRequired,submit:r.a.func.isRequired,saving:r.a.bool.isRequired,error:r.a.string});class ut extends l.a.PureComponent{constructor(e){super(e),ct(this,"handleSubmit",()=>{const e={};e.email=this.state.enableEmail,e.desktop_sound=this.state.desktopSound,e.desktop=this.state.desktopActivity,e.push=this.state.pushActivity,e.push_status=this.state.pushStatus,e.comments=this.state.notifyCommentsLevel,e.auto_responder_active=this.state.autoResponderActive.toString(),e.auto_responder_message=this.state.autoResponderMessage,e.auto_responder_message&&""!==e.auto_responder_message||(e.auto_responder_message=b.jb("user.settings.notifications.autoResponderDefault","Hello, I am out of office and unable to respond to messages."));const t=[];this.state.usernameKey&&t.push(this.props.user.username);let a=t.join(",");this.state.customKeys.length>0&&this.state.customKeysChecked&&(a+=","+this.state.customKeys),e.mention_keys=a,e.first_name=this.state.firstNameKey.toString(),e.channel=this.state.channelKey.toString(),this.setState({isSaving:!0}),this.props.actions.updateMe({notify_props:e}).then(({data:e,error:t})=>{e?(this.handleUpdateSection(""),this.setState(dt(this.props))):t&&this.setState({serverError:t.message,isSaving:!1})})}),ct(this,"handleCancel",e=>{e&&e.preventDefault(),this.setState(dt(this.props))}),ct(this,"handleUpdateSection",e=>{e?this.props.updateSection(e):this.props.updateSection(""),this.setState({isSaving:!1}),this.handleCancel()}),ct(this,"setStateValue",(e,t)=>{const a={};a[e]=t,this.setState(a)}),ct(this,"handleEmailRadio",e=>{this.setState({enableEmail:e})}),ct(this,"updateUsernameKey",e=>{this.setState({usernameKey:e})}),ct(this,"updateFirstNameKey",e=>{this.setState({firstNameKey:e})}),ct(this,"updateChannelKey",e=>{this.setState({channelKey:e})}),ct(this,"updateCustomMentionKeys",()=>{if(this.refs.customcheck.checked){const e=this.refs.custommentions.value;this.setState({customKeys:e.replace(/ /g,""),customKeysChecked:!0})}else this.setState({customKeys:"",customKeysChecked:!1})}),ct(this,"onCustomChange",()=>{this.refs.customcheck.checked=!0,this.updateCustomMentionKeys()}),ct(this,"createPushNotificationSection",()=>{if("push"===this.props.activeSection){const e=[];let t=null,a=null;if(this.props.sendPushNotifications){const s=[!1,!1,!1];this.state.pushActivity===p.v.ALL?s[0]=!0:this.state.pushActivity===p.v.NONE?s[2]=!0:s[1]=!0;const i=[!1,!1,!1];let n;this.state.pushStatus===p.Q.UserStatuses.ONLINE?i[0]=!0:this.state.pushStatus===p.Q.UserStatuses.AWAY?i[1]=!0:i[2]=!0,this.state.pushActivity!==p.v.NONE&&(n=l.a.createElement("fieldset",null,l.a.createElement("legend",{className:"form-legend"},l.a.createElement(g.a,{id:"user.settings.notifications.push_notification.status",defaultMessage:"Trigger push notifications when"})),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"pushNotificationOnline",type:"radio",name:"pushNotificationStatus",checked:i[0],onChange:this.handlePushStatusRadio.bind(this,p.Q.UserStatuses.ONLINE)}),l.a.createElement(g.a,{id:"user.settings.push_notification.online",defaultMessage:"Online, away or offline"}))),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"pushNotificationAway",type:"radio",name:"pushNotificationStatus",checked:i[1],onChange:this.handlePushStatusRadio.bind(this,p.Q.UserStatuses.AWAY)}),l.a.createElement(g.a,{id:"user.settings.push_notification.away",defaultMessage:"Away or offline"}))),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"pushNotificationOffline",type:"radio",name:"pushNotificationStatus",checked:i[2],onChange:this.handlePushStatusRadio.bind(this,p.Q.UserStatuses.OFFLINE)}),l.a.createElement(g.a,{id:"user.settings.push_notification.offline",defaultMessage:"Offline"})))),t=l.a.createElement("span",null,l.a.createElement(g.a,{id:"user.settings.push_notification.status_info",defaultMessage:"Notification alerts are only pushed to your mobile device when your online status matches the selection above."}))),e.push(l.a.createElement("div",null,l.a.createElement("fieldset",{key:"userNotificationLevelOption"},l.a.createElement("legend",{className:"form-legend"},l.a.createElement(g.a,{id:"user.settings.push_notification.send",defaultMessage:"Send mobile push notifications"})),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"pushNotificationAllActivity",type:"radio",name:"pushNotificationLevel",checked:s[0],onChange:this.handlePushRadio.bind(this,p.v.ALL)}),l.a.createElement(g.a,{id:"user.settings.push_notification.allActivity",defaultMessage:"For all activity"}))),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"pushNotificationMentions",type:"radio",name:"pushNotificationLevel",checked:s[1],onChange:this.handlePushRadio.bind(this,p.v.MENTION)}),l.a.createElement(g.a,{id:"user.settings.push_notification.onlyMentions",defaultMessage:"For mentions and direct messages"}))),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"pushNotificationNever",type:"radio",name:"pushNotificationLevel",checked:s[2],onChange:this.handlePushRadio.bind(this,p.v.NONE)}),l.a.createElement(g.a,{id:"user.settings.notifications.never",defaultMessage:"Never"}))),l.a.createElement("div",{className:"mt-5"},l.a.createElement(g.a,{id:"user.settings.push_notification.info",defaultMessage:"Notification alerts are pushed to your mobile device when there is activity in Mattermost."}))),l.a.createElement("hr",null),n)),a=this.handleSubmit}else e.push(l.a.createElement("div",{key:"oauthEmailInfo",className:"pt-2"},l.a.createElement(g.a,{id:"user.settings.push_notification.disabled_long",defaultMessage:"Push notifications have not been enabled by your System Administrator."})));return l.a.createElement(v.a,{title:b.jb("user.settings.notifications.push","Mobile Push Notifications"),extraInfo:t,inputs:e,submit:a,server_error:this.state.serverError,updateSection:this.handleUpdateSection})}let e="";return e=this.state.pushActivity===p.v.ALL?this.state.pushStatus===p.Q.UserStatuses.AWAY?l.a.createElement(g.a,{id:"user.settings.push_notification.allActivityAway",defaultMessage:"For all activity when away or offline"}):this.state.pushStatus===p.Q.UserStatuses.OFFLINE?l.a.createElement(g.a,{id:"user.settings.push_notification.allActivityOffline",defaultMessage:"For all activity when offline"}):l.a.createElement(g.a,{id:"user.settings.push_notification.allActivityOnline",defaultMessage:"For all activity when online, away or offline"}):this.state.pushActivity===p.v.NONE?l.a.createElement(g.a,{id:"user.settings.notifications.never",defaultMessage:"Never"}):this.props.sendPushNotifications?this.state.pushStatus===p.Q.UserStatuses.AWAY?l.a.createElement(g.a,{id:"user.settings.push_notification.onlyMentionsAway",defaultMessage:"For mentions and direct messages when away or offline"}):this.state.pushStatus===p.Q.UserStatuses.OFFLINE?l.a.createElement(g.a,{id:"user.settings.push_notification.onlyMentionsOffline",defaultMessage:"For mentions and direct messages when offline"}):l.a.createElement(g.a,{id:"user.settings.push_notification.onlyMentionsOnline",defaultMessage:"For mentions and direct messages when online, away or offline"}):l.a.createElement(g.a,{id:"user.settings.push_notification.disabled",defaultMessage:"Push notifications are not enabled"}),l.a.createElement(S.a,{title:b.jb("user.settings.notifications.push","Mobile Push Notifications"),describe:e,section:"push",updateSection:this.handleUpdateSection})}),this.state=dt(e)}handleNotifyCommentsRadio(e){this.setState({notifyCommentsLevel:e})}handlePushRadio(e){this.setState({pushActivity:e})}handlePushStatusRadio(e){this.setState({pushStatus:e})}render(){const e=this.state.serverError,t=this.props.user;let a,s,i;if("keys"===this.props.activeSection){const s=[];if(t.first_name){const e=e=>{this.updateFirstNameKey(e.target.checked)};s.push(l.a.createElement("div",{key:"userNotificationFirstNameOption"},l.a.createElement("div",{className:"checkbox"},l.a.createElement("label",null,l.a.createElement("input",{id:"notificationTriggerFirst",type:"checkbox",checked:this.state.firstNameKey,onChange:e}),l.a.createElement(g.a,{id:"user.settings.notifications.sensitiveName",defaultMessage:'Your case sensitive first name "{first_name}"',values:{first_name:t.first_name}})))))}const i=e=>{this.updateUsernameKey(e.target.checked)};s.push(l.a.createElement("div",{key:"userNotificationUsernameOption"},l.a.createElement("div",{className:"checkbox"},l.a.createElement("label",null,l.a.createElement("input",{id:"notificationTriggerUsername",type:"checkbox",checked:this.state.usernameKey,onChange:i}),l.a.createElement(g.a,{id:"user.settings.notifications.sensitiveUsername",defaultMessage:'Your non-case sensitive username "{username}"',values:{username:t.username}})))));const n=e=>{this.updateChannelKey(e.target.checked)};s.push(l.a.createElement("div",{key:"userNotificationChannelOption"},l.a.createElement("div",{className:"checkbox"},l.a.createElement("label",null,l.a.createElement("input",{id:"notificationTriggerShouts",type:"checkbox",checked:this.state.channelKey,onChange:n}),l.a.createElement(g.a,{id:"user.settings.notifications.channelWide",defaultMessage:'Channel-wide mentions "@channel", "@all", "@here"'}))))),s.push(l.a.createElement("div",{key:"userNotificationCustomOption"},l.a.createElement("div",{className:"checkbox"},l.a.createElement("label",null,l.a.createElement("input",{id:"notificationTriggerCustom",ref:"customcheck",type:"checkbox",checked:this.state.customKeysChecked,onChange:this.updateCustomMentionKeys}),l.a.createElement(g.a,{id:"user.settings.notifications.sensitiveWords",defaultMessage:"Other non-case sensitive words, separated by commas:"}))),l.a.createElement("input",{id:"notificationTriggerCustomText",autoFocus:this.state.customKeysChecked,ref:"custommentions",className:"form-control mentions-input",type:"text",defaultValue:this.state.customKeys,onChange:this.onCustomChange,onFocus:b.lb,"aria-labelledby":"notificationTriggerCustom"})));const r=l.a.createElement("span",null,l.a.createElement(g.a,{id:"user.settings.notifications.mentionsInfo",defaultMessage:"Mentions trigger when someone sends a message that includes your username (@{username}) or any of the options selected above.",values:{username:t.username}}));a=l.a.createElement(v.a,{title:b.jb("user.settings.notifications.wordsTrigger","Words That Trigger Mentions"),inputs:s,submit:this.handleSubmit,saving:this.state.isSaving,server_error:e,updateSection:this.handleUpdateSection,extraInfo:r})}else{let e=["@"+t.username];this.state.firstNameKey&&e.push(t.first_name),this.state.usernameKey&&e.push(t.username),this.state.channelKey&&(e.push("@channel"),e.push("@all"),e.push("@here")),this.state.customKeys.length>0&&(e=e.concat(this.state.customKeys.split(",")));let s="";for(let t=0;t<e.length;t++)""!==e[t]&&(s+='"'+e[t]+'", ');s=s.length>0?s.substring(0,s.length-2):l.a.createElement(g.a,{id:"user.settings.notifications.noWords",defaultMessage:"No words configured"}),a=l.a.createElement(S.a,{title:b.jb("user.settings.notifications.wordsTrigger","Words That Trigger Mentions"),describe:s,section:"keys",updateSection:this.handleUpdateSection})}if("comments"===this.props.activeSection){const t=[!1,!1,!1];"never"===this.state.notifyCommentsLevel?t[2]=!0:"root"===this.state.notifyCommentsLevel?t[1]=!0:t[0]=!0;const a=[];a.push(l.a.createElement("fieldset",{key:"userNotificationLevelOption"},l.a.createElement("legend",{className:"form-legend hidden-label"},b.jb("user.settings.notifications.comments","Reply notifications")),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"notificationCommentsAny",type:"radio",name:"commentsNotificationLevel",checked:t[0],onChange:this.handleNotifyCommentsRadio.bind(this,"any")}),l.a.createElement(g.a,{id:"user.settings.notifications.commentsAny",defaultMessage:"Trigger notifications on messages in reply threads that I start or participate in"})),l.a.createElement("br",null)),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"notificationCommentsRoot",type:"radio",name:"commentsNotificationLevel",checked:t[1],onChange:this.handleNotifyCommentsRadio.bind(this,"root")}),l.a.createElement(g.a,{id:"user.settings.notifications.commentsRoot",defaultMessage:"Trigger notifications on messages in threads that I start"})),l.a.createElement("br",null)),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"notificationCommentsNever",type:"radio",name:"commentsNotificationLevel",checked:t[2],onChange:this.handleNotifyCommentsRadio.bind(this,"never")}),l.a.createElement(g.a,{id:"user.settings.notifications.commentsNever",defaultMessage:"Do not trigger notifications on messages in reply threads unless I'm mentioned"})))));const i=l.a.createElement("span",null,l.a.createElement(g.a,{id:"user.settings.notifications.commentsInfo",defaultMessage:"In addition to notifications for when you're mentioned, select if you would like to receive notifications on reply threads."}));s=l.a.createElement(v.a,{title:b.jb("user.settings.notifications.comments","Reply notifications"),extraInfo:i,inputs:a,submit:this.handleSubmit,saving:this.state.isSaving,server_error:e,updateSection:this.handleUpdateSection})}else{let e="";e="never"===this.state.notifyCommentsLevel?l.a.createElement(g.a,{id:"user.settings.notifications.commentsNever",defaultMessage:"Do not trigger notifications on messages in reply threads unless I'm mentioned"}):"root"===this.state.notifyCommentsLevel?l.a.createElement(g.a,{id:"user.settings.notifications.commentsRoot",defaultMessage:"Trigger notifications on messages in threads that I start"}):l.a.createElement(g.a,{id:"user.settings.notifications.commentsAny",defaultMessage:"Trigger notifications on messages in reply threads that I start or participate in"}),s=l.a.createElement(S.a,{title:b.jb("user.settings.notifications.comments","Reply notifications"),describe:e,section:"comments",updateSection:this.handleUpdateSection})}if(this.props.enableAutoResponder)if("auto-responder"===this.props.activeSection)i=l.a.createElement("div",null,l.a.createElement(lt,{autoResponderActive:this.state.autoResponderActive,autoResponderMessage:this.state.autoResponderMessage,updateSection:this.handleUpdateSection,setParentState:this.setStateValue,submit:this.handleSubmit,error:this.state.serverError,saving:this.state.isSaving}),l.a.createElement("div",{className:"divider-dark"}));else{const e=this.state.autoResponderActive?l.a.createElement(g.a,{id:"user.settings.notifications.autoResponderEnabled",defaultMessage:"Enabled"}):l.a.createElement(g.a,{id:"user.settings.notifications.autoResponderDisabled",defaultMessage:"Disabled"});i=l.a.createElement(S.a,{title:l.a.createElement(g.a,{id:"user.settings.notifications.autoResponder",defaultMessage:"Automatic Direct Message Replies"}),width:"medium",describe:e,section:"auto-responder",updateSection:this.handleUpdateSection})}const n=this.createPushNotificationSection();return l.a.createElement("div",{id:"notificationSettings"},l.a.createElement("div",{className:"modal-header"},l.a.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal",onClick:this.props.closeModal},l.a.createElement("span",{"aria-hidden":"true"},"×")),l.a.createElement("h4",{className:"modal-title",ref:"title"},l.a.createElement("div",{className:"modal-back"},l.a.createElement(g.a,{id:"generic_icons.collapse",defaultMessage:"Collapse Icon"},e=>l.a.createElement("i",{className:"fa fa-angle-left",title:e,onClick:this.props.collapseModal}))),l.a.createElement(g.a,{id:"user.settings.notifications.title",defaultMessage:"Notification Settings"}))),l.a.createElement("div",{ref:"wrapper",className:"user-settings"},l.a.createElement("h3",{id:"notificationSettingsTitle",className:"tab-header"},l.a.createElement(g.a,{id:"user.settings.notifications.header",defaultMessage:"Notifications"})),l.a.createElement("div",{className:"divider-dark first"}),l.a.createElement(et,{activity:this.state.desktopActivity,sound:this.state.desktopSound,updateSection:this.handleUpdateSection,setParentState:this.setStateValue,submit:this.handleSubmit,saving:this.state.isSaving,cancel:this.handleCancel,error:this.state.serverError,active:"desktop"===this.props.activeSection}),l.a.createElement("div",{className:"divider-light"}),l.a.createElement(nt,{activeSection:this.props.activeSection,updateSection:this.handleUpdateSection,enableEmail:"true"===this.state.enableEmail,onSubmit:this.handleSubmit,onCancel:this.handleCancel,onChange:this.handleEmailRadio,saving:this.state.isSaving,serverError:this.state.serverError}),l.a.createElement("div",{className:"divider-light"}),n,l.a.createElement("div",{className:"divider-light"}),a,l.a.createElement("div",{className:"divider-light"}),s,l.a.createElement("div",{className:"divider-light"}),i,l.a.createElement("div",{className:"divider-dark"})))}}ct(ut,"propTypes",{user:r.a.object,updateSection:r.a.func,activeSection:r.a.string,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,sendPushNotifications:r.a.bool,enableAutoResponder:r.a.bool,actions:r.a.shape({updateMe:r.a.func.isRequired}).isRequired}),ct(ut,"defaultProps",{user:null,activeSection:"",activeTab:""});var mt=Object(s.connect)((function(e){const t=Object(d.getConfig)(e);return{sendPushNotifications:"true"===t.SendPushNotifications,enableAutoResponder:"true"===t.ExperimentalEnableAutomaticReplies}}),(function(e){return{actions:Object(c.bindActionCreators)({updateMe:h.updateMe},e)}}))(ut),ht=a(1165),pt=a(41),gt=a(1129),ft=a(338),bt=a.n(ft),Et=a(1381),vt=a(1533),St=a(1143);function yt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class kt extends l.a.PureComponent{constructor(e){super(e),yt(this,"onShow",()=>{this.props.actions.getUserAudits(this.props.currentUserId,0,200)}),yt(this,"onHide",()=>{this.setState({show:!1})}),this.state={show:!0}}componentDidMount(){this.onShow()}render(){let e;return e=0===this.props.userAudits.length?l.a.createElement(St.a,null):l.a.createElement(vt.a,{audits:this.props.userAudits,showIp:!0,showSession:!0}),l.a.createElement(Et.a,{dialogClassName:"a11y__modal modal--scroll",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,bsSize:"large",role:"dialog","aria-labelledby":"accessHistoryModalLabel"},l.a.createElement(Et.a.Header,{closeButton:!0},l.a.createElement(Et.a.Title,{componentClass:"h1",id:"accessHistoryModalLabel"},l.a.createElement(g.a,{id:"access_history.title",defaultMessage:"Access History"}))),l.a.createElement(Et.a.Body,null,e),l.a.createElement(Et.a.Footer,{className:"modal-footer--invisible"},l.a.createElement("button",{id:"closeModalButton",type:"button",className:"btn btn-link"},l.a.createElement(g.a,{id:"general_button.close",defaultMessage:"Close"}))))}}yt(kt,"propTypes",{onHide:r.a.func.isRequired,actions:r.a.shape({getUserAudits:r.a.func.isRequired}).isRequired,userAudits:r.a.arrayOf(r.a.any).isRequired,currentUserId:r.a.string.isRequired});var Ct=Object(s.connect)((function(e){return{currentUserId:Object(i.getCurrentUserId)(e),userAudits:Object(i.getUserAudits)(e)||[]}}),(function(e){return{actions:Object(c.bindActionCreators)({getUserAudits:h.getUserAudits},e)}}))(kt),Nt=a(186);function _t(e){const{locale:t,currentSession:a,handleMoreInfo:s,moreInfo:i}=e;if(i){const e=new Date(a.create_at);return l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement(g.a,{id:"activity_log.firstTime",defaultMessage:"First time active: {date}, {time}",values:{date:l.a.createElement(qe.a,{value:e,day:"2-digit",month:Object(E.a)(t),year:"numeric"}),time:l.a.createElement(qe.b,{value:e,hour:"2-digit",minute:"2-digit"})}})),l.a.createElement("div",null,l.a.createElement(g.a,{id:"activity_log.os",defaultMessage:"OS: {os}",values:{os:a.props.os}})),l.a.createElement("div",null,l.a.createElement(g.a,{id:"activity_log.browser",defaultMessage:"Browser: {browser}",values:{browser:a.props.browser}})),l.a.createElement("div",null,l.a.createElement(g.a,{id:"activity_log.sessionId",defaultMessage:"Session ID: {id}",values:{id:a.id}})))}return l.a.createElement("a",{className:"theme",href:"#",onClick:s},l.a.createElement(g.a,{id:"activity_log.moreInfo",defaultMessage:"More info"}))}function Mt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}_t.propTypes={locale:r.a.string.isRequired,currentSession:r.a.shape({props:r.a.shape({os:r.a.string.isRequired,platform:r.a.string.isRequired,browser:r.a.string.isRequired}).isRequired,create_at:r.a.number.isRequired,last_activity_at:r.a.number.isRequired,id:r.a.string.isRequired}).isRequired,handleMoreInfo:r.a.func.isRequired,moreInfo:r.a.bool.isRequired};class Tt extends l.a.PureComponent{constructor(e){super(e),Mt(this,"handleMoreInfo",()=>{this.setState({moreInfo:!0})}),Mt(this,"submitRevoke",e=>{this.props.submitRevoke(this.props.currentSession.id,e)}),Mt(this,"isMobileSession",e=>e.device_id&&(e.device_id.includes("apple")||e.device_id.includes("android"))),Mt(this,"mobileSessionInfo",e=>{let t,a,s,i;return e.device_id.includes("apple")?(s="fa fa-apple",i=Object(b.jb)("device_icons.apple","Apple Icon"),t=Object(E.b)("activity_log_modal.iphoneNativeClassicApp"),a="iPhone Native Classic App",e.device_id.includes(C.General.PUSH_NOTIFY_APPLE_REACT_NATIVE)&&(t=Object(E.b)("activity_log_modal.iphoneNativeApp"),a="iPhone Native App")):e.device_id.includes("android")&&(s="fa fa-android",i=Object(b.jb)("device_icons.android","Android Icon"),t=Object(E.b)("activity_log_modal.androidNativeClassicApp"),a="Android Native Classic App",e.device_id.includes(C.General.PUSH_NOTIFY_ANDROID_REACT_NATIVE)&&(t=Object(E.b)("activity_log_modal.androidNativeApp"),a="Android Native App")),{devicePicture:s,deviceTitle:i,devicePlatform:l.a.createElement(g.a,{id:t,defaultMessage:a})}}),this.state={moreInfo:!1}}render(){const{index:e,locale:t,currentSession:a}=this.props,s=new Date(a.last_activity_at);let i=a.props.platform,n="",r="";if("Windows"===a.props.platform)n="fa fa-windows",r=Object(b.jb)("device_icons.windows","Windows Icon");else if(this.isMobileSession(a)){const e=this.mobileSessionInfo(a);n=e.devicePicture,i=e.devicePlatform}else"Macintosh"===a.props.platform||"iPhone"===a.props.platform?(n="fa fa-apple",r=Object(b.jb)("device_icons.apple","Apple Icon")):"Linux"===a.props.platform?a.props.os.indexOf("Android")>=0?(i=l.a.createElement(g.a,{id:"activity_log_modal.android",defaultMessage:"Android"}),n="fa fa-android",r=Object(b.jb)("device_icons.android","Android Icon")):(n="fa fa-linux",r=Object(b.jb)("device_icons.linux","Linux Icon")):-1!==a.props.os.indexOf("Linux")&&(n="fa fa-linux",r=Object(b.jb)("device_icons.linux","Linux Icon"));return-1!==a.props.browser.indexOf("Desktop App")&&(i=l.a.createElement(g.a,{id:"activity_log_modal.desktop",defaultMessage:"Native Desktop App"})),l.a.createElement("div",{key:"activityLogEntryKey"+e,className:"activity-log__table"},l.a.createElement("div",{className:"activity-log__report"},l.a.createElement("div",{className:"report__platform"},l.a.createElement("i",{className:n,title:r}),i),l.a.createElement("div",{className:"report__info"},l.a.createElement("div",null,l.a.createElement(g.a,{id:"activity_log.lastActivity",defaultMessage:"Last activity: {date}, {time}",values:{date:l.a.createElement(qe.a,{value:s,day:"2-digit",month:Object(E.a)(t),year:"numeric"}),time:l.a.createElement(qe.b,{value:s,hour:"2-digit",minute:"2-digit"})}})),l.a.createElement(_t,{locale:t,currentSession:a,moreInfo:this.state.moreInfo,handleMoreInfo:this.handleMoreInfo}))),l.a.createElement("div",{className:"activity-log__action"},l.a.createElement("button",{onClick:this.submitRevoke,className:"btn btn-primary"},l.a.createElement(g.a,{id:"activity_log.logout",defaultMessage:"Log Out"}))))}}function Ot(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Mt(Tt,"propTypes",{index:r.a.number.isRequired,locale:r.a.string.isRequired,currentSession:r.a.object.isRequired,submitRevoke:r.a.func.isRequired});class wt extends l.a.PureComponent{constructor(e){super(e),Ot(this,"submitRevoke",(e,t)=>{t.preventDefault();var a=F()(t.target).closest(".modal-content");a.addClass("animation--highlight"),setTimeout(()=>{a.removeClass("animation--highlight")},1500),this.props.actions.revokeSession(this.props.currentUserId,e).then(()=>{this.props.actions.getSessions(this.props.currentUserId)})}),Ot(this,"onShow",()=>{this.props.actions.getSessions(this.props.currentUserId)}),Ot(this,"onHide",()=>{this.setState({show:!1})}),this.state={show:!0}}componentDidMount(){this.onShow()}render(){let e;if(this.props.sessions.loading)e=l.a.createElement(St.a,null);else{const t=this.props.sessions.reduce((e,t,a)=>("UserAccessToken"===t.props.type||e.push(l.a.createElement(Tt,{key:t.id,index:a,locale:this.props.locale,currentSession:t,submitRevoke:this.submitRevoke})),e),[]);e=l.a.createElement("form",{role:"form"},t)}return l.a.createElement(Et.a,{dialogClassName:"a11y__modal modal--scroll",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,bsSize:"large",role:"dialog","aria-labelledby":"activityLogModalLabel"},l.a.createElement(Et.a.Header,{closeButton:!0},l.a.createElement(Et.a.Title,{componentClass:"h1",id:"activityLogModalLabel"},l.a.createElement(g.a,{id:"activity_log.activeSessions",defaultMessage:"Active Sessions"}))),l.a.createElement(Et.a.Body,null,l.a.createElement("p",{className:"session-help-text"},l.a.createElement(g.a,{id:"activity_log.sessionsDescription",defaultMessage:"Sessions are created when you log in through a new browser on a device. Sessions let you use Mattermost without having to log in again for a time period specified by the system administrator. To end the session sooner, use the 'Log Out' button."})),e),l.a.createElement(Et.a.Footer,{className:"modal-footer--invisible"},l.a.createElement("button",{id:"closeModalButton",type:"button",className:"btn btn-link"},l.a.createElement(g.a,{id:"general_button.close",defaultMessage:"Close"}))))}}Ot(wt,"propTypes",{currentUserId:r.a.string.isRequired,sessions:r.a.oneOfType([r.a.array,r.a.object]).isRequired,locale:r.a.string.isRequired,onHide:r.a.func.isRequired,actions:r.a.shape({getSessions:r.a.func.isRequired,revokeSession:r.a.func.isRequired}).isRequired});var At=Object(s.connect)((function(e){return{currentUserId:Object(i.getCurrentUserId)(e),sessions:Object(i.getUserSessions)(e),locale:Object(Nt.a)(e)}}),(function(e){return{actions:Object(c.bindActionCreators)({getSessions:h.getSessions,revokeSession:h.revokeSession},e)}}))(wt),Pt=a(1254),It=a(1371),Rt=a(87);function jt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Lt extends l.a.PureComponent{constructor(e){super(e),jt(this,"setupMfa",e=>{e.preventDefault(),Rt.a.push("/mfa/setup")}),jt(this,"removeMfa",async e=>{e.preventDefault();const{error:t}=await this.props.actions.deactivateMfa();t?this.setState({serverError:t.message}):this.props.mfaEnforced?Rt.a.push("/mfa/setup"):(this.props.updateSection(""),this.setState({serverError:null}))}),jt(this,"renderTitle",()=>l.a.createElement(g.a,{id:"user.settings.mfa.title",defaultMessage:"Multi-factor Authentication"})),jt(this,"renderDescription",()=>this.props.mfaActive?l.a.createElement(g.a,{id:"user.settings.security.active",defaultMessage:"Active"}):l.a.createElement(g.a,{id:"user.settings.security.inactive",defaultMessage:"Inactive"})),jt(this,"renderContent",()=>{let e;if(this.props.mfaActive){let t;t=this.props.mfaEnforced?l.a.createElement(g.a,{id:"user.settings.mfa.reset",defaultMessage:"Reset MFA on Account"}):l.a.createElement(g.a,{id:"user.settings.mfa.remove",defaultMessage:"Remove MFA from Account"}),e=l.a.createElement("a",{className:"btn btn-primary",href:"#",onClick:this.removeMfa},t)}else e=l.a.createElement("a",{className:"btn btn-primary",href:"#",onClick:this.setupMfa},l.a.createElement(g.a,{id:"user.settings.mfa.add",defaultMessage:"Add MFA to Account"}));return l.a.createElement("div",{className:"pt-2"},e,l.a.createElement("br",null))}),jt(this,"renderHelpText",()=>this.props.mfaActive?this.props.mfaEnforced?l.a.createElement(g.a,{id:"user.settings.mfa.requiredHelp",defaultMessage:"Multi-factor authentication is required on this server. Resetting is only recommended when you need to switch code generation to a new mobile device. You will be required to set it up again immediately."}):l.a.createElement(g.a,{id:"user.settings.mfa.removeHelp",defaultMessage:"Removing multi-factor authentication means you will no longer require a phone-based passcode to sign-in to your account."}):l.a.createElement(g.a,{id:"user.settings.mfa.addHelp",defaultMessage:"Adding multi-factor authentication will make your account more secure by requiring a code from your mobile phone each time you sign in."})),this.state={serverError:null}}render(){const e=this.renderTitle();return this.props.mfaAvailable?this.props.active?l.a.createElement(v.a,{title:e,inputs:this.renderContent(),extraInfo:this.renderHelpText(),serverError:this.state.serverError,updateSection:this.props.updateSection,width:"medium"}):l.a.createElement(S.a,{title:e,describe:this.renderDescription(),section:"mfa",updateSection:this.props.updateSection}):null}}jt(Lt,"propTypes",{active:r.a.bool.isRequired,mfaActive:r.a.bool.isRequired,mfaAvailable:r.a.bool.isRequired,mfaEnforced:r.a.bool.isRequired,updateSection:r.a.func.isRequired,actions:r.a.shape({deactivateMfa:r.a.func.isRequired}).isRequired});var Dt=Object(s.connect)((function(e){const t=Object(d.getLicense)(e),a=Object(d.getConfig)(e),s=t&&"true"===t.IsLicensed&&"true"===t.MFA,n="true"===a.EnableMultifactorAuthentication,r=s&&"true"===a.EnforceMultifactorAuthentication,o=Object(i.getCurrentUser)(e);let l=!1,c=!1;return o&&(l=o.mfa_active,c=n&&(""===o.auth_service||o.auth_service===p.Q.LDAP_SERVICE)),{mfaActive:l,mfaAvailable:c,mfaEnforced:r}}),(function(e){return{actions:Object(c.bindActionCreators)({deactivateMfa:It.b},e)}}))(Lt),xt=a(1175),Ut=a(1188);function Ft(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class zt extends l.a.Component{constructor(e){super(e),Ft(this,"startCreatingToken",()=>{this.setState({tokenCreationState:"creating"})}),Ft(this,"stopCreatingToken",()=>{this.setState({tokenCreationState:"not_creating",saving:!1})}),Ft(this,"handleCreateToken",async()=>{this.handleCancelConfirm();const e=this.refs.newtokendescription?this.refs.newtokendescription.value:"";if(""===e)return void this.setState({tokenError:b.jb("user.settings.tokens.nameRequired","Please enter a description.")});this.setState({tokenError:"",saving:!0}),this.props.setRequireConfirm(!0,this.confirmCopyToken);const t=this.props.user?this.props.user.id:"",{data:a,error:s}=await this.props.actions.createUserAccessToken(t,e);a&&"creating"===this.state.tokenCreationState?this.setState({tokenCreationState:"created",newToken:a,saving:!1}):s&&this.setState({serverError:s.message,saving:!1})}),Ft(this,"confirmCopyToken",e=>{this.setState({showConfirmModal:!0,confirmTitle:l.a.createElement(g.a,{id:"user.settings.tokens.confirmCopyTitle",defaultMessage:"Copied Your Token?"}),confirmMessage:e=>l.a.createElement("div",null,l.a.createElement(ge.a,{id:"user.settings.tokens.confirmCopyMessage",defaultMessage:"Make sure you have copied and saved the access token below. You won't be able to see it again!"}),l.a.createElement("br",null),l.a.createElement("br",null),"creating"===e.tokenCreationState?l.a.createElement("div",null,l.a.createElement("strong",{className:"word-break--all"},l.a.createElement(g.a,{id:"user.settings.tokens.token",defaultMessage:"Access Token: "})),l.a.createElement(g.a,{id:"user.settings.tokens.tokenLoading",defaultMessage:"Loading..."})):l.a.createElement("strong",{className:"word-break--all"},l.a.createElement(g.a,{id:"user.settings.tokens.token",defaultMessage:"Access Token: "}),e.newToken.token)),confirmButton:l.a.createElement(g.a,{id:"user.settings.tokens.confirmCopyButton",defaultMessage:"Yes, I have copied the token"}),confirmComplete:()=>{this.handleCancelConfirm(),e()},confirmHideCancel:!0})}),Ft(this,"handleCancelConfirm",()=>{this.setState({showConfirmModal:!1,confirmTitle:null,confirmMessage:null,confirmButton:null,confirmComplete:null,confirmHideCancel:!1})}),Ft(this,"confirmCreateToken",()=>{pt.isSystemAdmin(this.props.user.roles)?this.setState({showConfirmModal:!0,confirmTitle:l.a.createElement(g.a,{id:"user.settings.tokens.confirmCreateTitle",defaultMessage:"Create System Admin Personal Access Token"}),confirmMessage:()=>l.a.createElement("div",{className:"alert alert-danger"},l.a.createElement(ge.a,{id:"user.settings.tokens.confirmCreateMessage",defaultMessage:"You are generating a personal access token with System Admin permissions. Are you sure want to create this token?"})),confirmButton:l.a.createElement(g.a,{id:"user.settings.tokens.confirmCreateButton",defaultMessage:"Yes, Create"}),confirmComplete:()=>{this.handleCreateToken(),Object(He.d)("settings","system_admin_create_user_access_token")}}):this.handleCreateToken()}),Ft(this,"saveTokenKeyPress",e=>{b.Y(e,p.Q.KeyCodes.ENTER)&&this.confirmCreateToken()}),Ft(this,"confirmRevokeToken",e=>{const t=this.props.userAccessTokens[e];this.setState({showConfirmModal:!0,confirmTitle:l.a.createElement(g.a,{id:"user.settings.tokens.confirmDeleteTitle",defaultMessage:"Delete Token?"}),confirmMessage:()=>l.a.createElement("div",{className:"alert alert-danger"},l.a.createElement(Te.b,{id:"user.settings.tokens.confirmDeleteMessage",defaultMessage:"Any integrations using this token will no longer be able to access the Mattermost API. You cannot undo this action. \\n \\nAre you sure want to delete the **{description}** token?",values:{description:t.description}})),confirmButton:l.a.createElement(g.a,{id:"user.settings.tokens.confirmDeleteButton",defaultMessage:"Yes, Delete"}),confirmComplete:()=>{this.revokeToken(e),Object(He.d)("settings","revoke_user_access_token")}})}),Ft(this,"revokeToken",async e=>{const{error:t}=await this.props.actions.revokeUserAccessToken(e);t&&this.setState({serverError:t.message}),this.handleCancelConfirm()}),Ft(this,"activateToken",async e=>{const{error:t}=await this.props.actions.enableUserAccessToken(e);t?this.setState({serverError:t.message}):Object(He.d)("settings","activate_user_access_token")}),Ft(this,"deactivateToken",async e=>{const{error:t}=await this.props.actions.disableUserAccessToken(e);t?this.setState({serverError:t.message}):Object(He.d)("settings","deactivate_user_access_token")}),this.state={active:this.props.active,showConfirmModal:!1,newToken:null,tokenCreationState:"not_creating",tokenError:"",serverError:null,saving:!1}}componentDidMount(){this.props.actions.clearUserAccessTokens();const e=this.props.user?this.props.user.id:"";this.props.actions.getUserAccessTokensForUser(e,0,200)}static getDerivedStateFromProps(e,t){return!e.active&&t.active?{active:e.active,showConfirmModal:!1,newToken:null,tokenCreationState:"not_creating",tokenError:"",serverError:null,saving:!1}:{active:e.active}}render(){let e="";if(!this.props.active){const e=b.jb("user.settings.tokens.clickToEdit","Click 'Edit' to manage your personal access tokens");return l.a.createElement(S.a,{title:b.jb("user.settings.tokens.title","Personal Access Tokens"),describe:e,section:"tokens",updateSection:this.props.updateSection})}const t=[];let a,s,i;Object.values(this.props.userAccessTokens).forEach(e=>{if(this.state.newToken&&this.state.newToken.id===e.id)return;let a,s;e.is_active?a=l.a.createElement("a",{name:e.id+"_deactivate",href:"#",onClick:t=>{t.preventDefault(),this.deactivateToken(e.id)}},l.a.createElement(g.a,{id:"user.settings.tokens.deactivate",defaultMessage:"Disable"})):(s=l.a.createElement("span",{className:"has-error setting-box__inline-error"},l.a.createElement(g.a,{id:"user.settings.tokens.deactivatedWarning",defaultMessage:"(Disabled)"})),a=l.a.createElement("a",{name:e.id+"_activate",href:"#",onClick:t=>{t.preventDefault(),this.activateToken(e.id)}},l.a.createElement(g.a,{id:"user.settings.tokens.activate",defaultMessage:"Enable"}))),t.push(l.a.createElement("div",{key:e.id,className:"setting-box__item"},l.a.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},l.a.createElement(g.a,{id:"user.settings.tokens.tokenDesc",defaultMessage:"Token Description: "}),e.description,s),l.a.createElement("div",{className:"setting-box__token-id whitespace--nowrap overflow--ellipsis"},l.a.createElement(g.a,{id:"user.settings.tokens.tokenId",defaultMessage:"Token ID: "}),e.id),l.a.createElement("div",null,a," - ",l.a.createElement("a",{name:e.id+"_delete",href:"#",onClick:t=>{t.preventDefault(),this.confirmRevokeToken(e.id)}},l.a.createElement(g.a,{id:"user.settings.tokens.delete",defaultMessage:"Delete"}))),l.a.createElement("hr",{className:"mb-3 mt-3"})))}),0===t.length&&(a=l.a.createElement(g.a,{key:"notokens",id:"user.settings.tokens.userAccessTokensNone",defaultMessage:"No personal access tokens."})),s=Object(V.n)()?l.a.createElement("span",null,l.a.createElement(Te.b,{id:"user.settings.tokens.description_mobile",defaultMessage:"[Personal access tokens](!https://about.mattermost.com/default-user-access-tokens) function similarly to session tokens and can be used by integrations to [authenticate against the REST API](!https://about.mattermost.com/default-api-authentication). Create new tokens on your desktop."})):l.a.createElement("span",null,l.a.createElement(Te.b,{id:"user.settings.tokens.description",defaultMessage:"[Personal access tokens](!https://about.mattermost.com/default-user-access-tokens) function similarly to session tokens and can be used by integrations to [authenticate against the REST API](!https://about.mattermost.com/default-api-authentication)."})),"creating"===this.state.tokenCreationState?i=l.a.createElement("div",{className:"pl-3"},l.a.createElement("div",{className:"row"},l.a.createElement("label",{className:"col-sm-auto control-label pr-3"},l.a.createElement(g.a,{id:"user.settings.tokens.name",defaultMessage:"Token Description: "})),l.a.createElement("div",{className:"col-sm-5"},l.a.createElement("input",{autoFocus:!0,ref:"newtokendescription",className:"form-control",type:"text",maxLength:64,onKeyPress:this.saveTokenKeyPress}))),l.a.createElement("div",null,l.a.createElement("div",{className:"pt-3"},l.a.createElement(g.a,{id:"user.settings.tokens.nameHelp",defaultMessage:"Enter a description for your token to remember what it does."})),l.a.createElement("div",null,l.a.createElement("label",{id:"clientError",className:"has-error mt-2 mb-2"},this.state.tokenError)),l.a.createElement(xt.a,{btnClass:"btn-primary",savingMessage:l.a.createElement(g.a,{id:"user.settings.tokens.save",defaultMessage:"Save"}),saving:this.state.saving,onClick:this.confirmCreateToken}),l.a.createElement("button",{className:"btn btn-link",onClick:this.stopCreatingToken},l.a.createElement(g.a,{id:"user.settings.tokens.cancel",defaultMessage:"Cancel"})))):"created"===this.state.tokenCreationState?(0===t.length&&(e=" hidden"),i=l.a.createElement("div",{className:"alert alert-warning"},l.a.createElement(Ut.a,{additionalClassName:"mr-2"}),l.a.createElement(g.a,{id:"user.settings.tokens.copy",defaultMessage:"Please copy the access token below. You won't be able to see it again!"}),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},l.a.createElement(g.a,{id:"user.settings.tokens.name",defaultMessage:"Token Description: "}),this.state.newToken.description),l.a.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},l.a.createElement(g.a,{id:"user.settings.tokens.id",defaultMessage:"Token ID: "}),this.state.newToken.id),l.a.createElement("strong",{className:"word-break--all"},l.a.createElement(g.a,{id:"user.settings.tokens.token",defaultMessage:"Access Token: "}),this.state.newToken.token))):i=l.a.createElement("a",{className:"btn btn-primary",href:"#",onClick:this.startCreatingToken},l.a.createElement(g.a,{id:"user.settings.tokens.create",defaultMessage:"Create Token"}));const n=[];return n.push(l.a.createElement("div",{key:"tokensSetting",className:"pt-2"},l.a.createElement("div",{key:"tokenList"},l.a.createElement("div",{className:"alert alert-transparent"+e},t,a),i))),l.a.createElement("div",null,l.a.createElement(v.a,{title:b.jb("user.settings.tokens.title","Personal Access Tokens"),inputs:n,extraInfo:s,infoPosition:"top",serverError:this.state.serverError,updateSection:this.props.updateSection,width:"full",saving:this.state.saving,cancelButtonText:l.a.createElement(g.a,{id:"user.settings.security.close",defaultMessage:"Close"})}),l.a.createElement(y.a,{title:this.state.confirmTitle,message:this.state.confirmMessage?this.state.confirmMessage(this.state):null,confirmButtonText:this.state.confirmButton,show:this.state.showConfirmModal,onConfirm:this.state.confirmComplete||(()=>null),onCancel:this.handleCancelConfirm,hideCancel:this.state.confirmHideCancel}))}}Ft(zt,"propTypes",{user:r.a.object,active:r.a.bool,updateSection:r.a.func,userAccessTokens:r.a.object,setRequireConfirm:r.a.func.isRequired,actions:r.a.shape({getUserAccessTokensForUser:r.a.func.isRequired,createUserAccessToken:r.a.func.isRequired,revokeUserAccessToken:r.a.func.isRequired,enableUserAccessToken:r.a.func.isRequired,disableUserAccessToken:r.a.func.isRequired,clearUserAccessTokens:r.a.func.isRequired}).isRequired}),Ft(zt,"defaultProps",{user:{},active:!1});var qt=Object(s.connect)((function(e){return{userAccessTokens:e.entities.users.myUserAccessTokens}}),(function(e){return{actions:Object(c.bindActionCreators)({getUserAccessTokensForUser:h.getUserAccessTokensForUser,createUserAccessToken:h.createUserAccessToken,revokeUserAccessToken:h.revokeUserAccessToken,enableUserAccessToken:h.enableUserAccessToken,disableUserAccessToken:h.disableUserAccessToken,clearUserAccessTokens:h.clearUserAccessTokens},e)}}))(zt);function Bt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Gt extends l.a.PureComponent{constructor(e){super(e),Bt(this,"loadAuthorizedOAuthApps",async()=>{const{data:e,error:t}=await this.props.actions.getAuthorizedOAuthApps();e?this.setState({authorizedApps:e,serverError:null}):t&&this.setState({serverError:t.message})}),Bt(this,"submitPassword",async()=>{const e=this.props.user,t=this.state.currentPassword,a=this.state.newPassword,s=this.state.confirmPassword;if(""===t)return void this.setState({passwordError:b.jb("user.settings.security.currentPasswordError","Please enter your current password."),serverError:""});const{valid:i,error:n}=b.gb(a,this.props.passwordConfig);if(!i&&n)return void this.setState({passwordError:n,serverError:""});if(a!==s){const e=Object.assign(this.getDefaultState(),{passwordError:b.jb("user.settings.security.passwordMatchError","The new passwords you entered do not match."),serverError:""});return void this.setState(e)}this.setState({savingPassword:!0});const{data:r,error:o}=await this.props.actions.updateUserPassword(e.id,t,a);if(r)this.props.updateSection(""),this.props.actions.getMe(),this.setState(this.getDefaultState());else if(o){const e=this.getDefaultState();o.message?e.serverError=o.message:e.serverError=o,e.passwordError="",this.setState(e)}}),Bt(this,"updateCurrentPassword",e=>{this.setState({currentPassword:e.target.value})}),Bt(this,"updateNewPassword",e=>{this.setState({newPassword:e.target.value})}),Bt(this,"updateConfirmPassword",e=>{this.setState({confirmPassword:e.target.value})}),Bt(this,"deauthorizeApp",async e=>{e.preventDefault();const t=e.currentTarget.getAttribute("data-app"),{data:a,error:s}=await this.props.actions.deauthorizeOAuthApp(t);if(a){const e=this.state.authorizedApps.filter(e=>e.id!==t);this.setState({authorizedApps:e,serverError:null})}else s&&this.setState({serverError:s.message})}),Bt(this,"handleUpdateSection",e=>{if(e)this.props.updateSection(e);else{switch(this.props.activeSection){case"mfa":case"signin":case"tokens":case"apps":this.setState({serverError:null});break;case"password":this.setState({currentPassword:"",newPassword:"",confirmPassword:"",serverError:null,passwordError:null})}this.props.updateSection("")}}),Bt(this,"createPasswordSection",()=>{if("password"===this.props.activeSection){const e=[];let t;return""===this.props.user.auth_service?(t=this.submitPassword,e.push(l.a.createElement("div",{key:"currentPasswordUpdateForm",className:"form-group"},l.a.createElement("label",{className:"col-sm-5 control-label"},l.a.createElement(g.a,{id:"user.settings.security.currentPassword",defaultMessage:"Current Password"})),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("input",{id:"currentPassword",autoFocus:!0,className:"form-control",type:"password",onChange:this.updateCurrentPassword,value:this.state.currentPassword,"aria-label":b.jb("user.settings.security.currentPassword","Current Password")})))),e.push(l.a.createElement("div",{key:"newPasswordUpdateForm",className:"form-group"},l.a.createElement("label",{className:"col-sm-5 control-label"},l.a.createElement(g.a,{id:"user.settings.security.newPassword",defaultMessage:"New Password"})),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("input",{id:"newPassword",className:"form-control",type:"password",onChange:this.updateNewPassword,value:this.state.newPassword,"aria-label":b.jb("user.settings.security.newPassword","New Password")})))),e.push(l.a.createElement("div",{key:"retypeNewPasswordUpdateForm",className:"form-group"},l.a.createElement("label",{className:"col-sm-5 control-label"},l.a.createElement(g.a,{id:"user.settings.security.retypePassword",defaultMessage:"Retype New Password"})),l.a.createElement("div",{className:"col-sm-7"},l.a.createElement("input",{id:"confirmPassword",className:"form-control",type:"password",onChange:this.updateConfirmPassword,value:this.state.confirmPassword,"aria-label":b.jb("user.settings.security.retypePassword","Retype New Password")}))))):this.props.user.auth_service===p.Q.GITLAB_SERVICE?e.push(l.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},l.a.createElement("div",{className:"pb-3"},l.a.createElement(g.a,{id:"user.settings.security.passwordGitlabCantUpdate",defaultMessage:"Login occurs through GitLab. Password cannot be updated."})))):this.props.user.auth_service===p.Q.LDAP_SERVICE?e.push(l.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},l.a.createElement("div",{className:"pb-3"},l.a.createElement(g.a,{id:"user.settings.security.passwordLdapCantUpdate",defaultMessage:"Login occurs through AD/LDAP. Password cannot be updated."})))):this.props.user.auth_service===p.Q.SAML_SERVICE?e.push(l.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},l.a.createElement("div",{className:"pb-3"},l.a.createElement(g.a,{id:"user.settings.security.passwordSamlCantUpdate",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so through your login provider."})))):this.props.user.auth_service===p.Q.GOOGLE_SERVICE?e.push(l.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},l.a.createElement("div",{className:"pb-3"},l.a.createElement(g.a,{id:"user.settings.security.passwordGoogleCantUpdate",defaultMessage:"Login occurs through Google Apps. Password cannot be updated."})))):this.props.user.auth_service===p.Q.OFFICE365_SERVICE&&e.push(l.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},l.a.createElement("div",{className:"pb-3"},l.a.createElement(g.a,{id:"user.settings.security.passwordOffice365CantUpdate",defaultMessage:"Login occurs through Office 365. Password cannot be updated."})))),l.a.createElement(v.a,{title:l.a.createElement(g.a,{id:"user.settings.security.password",defaultMessage:"Password"}),inputs:e,submit:t,saving:this.state.savingPassword,serverError:this.state.serverError,clientError:this.state.passwordError,updateSection:this.handleUpdateSection})}let e;if(""===this.props.user.auth_service){const t=new Date(this.props.user.last_password_update);e=l.a.createElement(g.a,{id:"user.settings.security.lastUpdated",defaultMessage:"Last updated {date} at {time}",values:{date:l.a.createElement(qe.a,{value:t,day:"2-digit",month:"short",year:"numeric"}),time:l.a.createElement(qe.b,{value:t,hour12:!this.props.militaryTime,hour:"2-digit",minute:"2-digit"})}})}else this.props.user.auth_service===p.Q.GITLAB_SERVICE?e=l.a.createElement(g.a,{id:"user.settings.security.loginGitlab",defaultMessage:"Login done through GitLab"}):this.props.user.auth_service===p.Q.LDAP_SERVICE?e=l.a.createElement(g.a,{id:"user.settings.security.loginLdap",defaultMessage:"Login done through AD/LDAP"}):this.props.user.auth_service===p.Q.SAML_SERVICE?e=l.a.createElement(g.a,{id:"user.settings.security.loginSaml",defaultMessage:"Login done through SAML"}):this.props.user.auth_service===p.Q.GOOGLE_SERVICE?e=l.a.createElement(g.a,{id:"user.settings.security.loginGoogle",defaultMessage:"Login done through Google Apps"}):this.props.user.auth_service===p.Q.OFFICE365_SERVICE&&(e=l.a.createElement(g.a,{id:"user.settings.security.loginOffice365",defaultMessage:"Login done through Office 365"}));return l.a.createElement(S.a,{title:l.a.createElement(g.a,{id:"user.settings.security.password",defaultMessage:"Password"}),describe:e,section:"password",updateSection:this.handleUpdateSection,focused:!0})}),Bt(this,"createSignInSection",()=>{const e=this.props.user;if("signin"===this.props.activeSection){let t,a,s,i,n,r;if(""===e.auth_service)this.props.enableSignUpWithGitLab&&(a=l.a.createElement("div",{className:"pb-3"},l.a.createElement(gt.a,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+p.Q.GITLAB_SERVICE},l.a.createElement(g.a,{id:"user.settings.security.switchGitlab",defaultMessage:"Switch to Using GitLab SSO"})),l.a.createElement("br",null))),this.props.enableSignUpWithGoogle&&(s=l.a.createElement("div",{className:"pb-3"},l.a.createElement(gt.a,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+p.Q.GOOGLE_SERVICE},l.a.createElement(g.a,{id:"user.settings.security.switchGoogle",defaultMessage:"Switch to Using Google SSO"})),l.a.createElement("br",null))),this.props.enableSignUpWithOffice365&&(i=l.a.createElement("div",{className:"pb-3"},l.a.createElement(gt.a,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+p.Q.OFFICE365_SERVICE},l.a.createElement(g.a,{id:"user.settings.security.switchOffice365",defaultMessage:"Switch to Using Office 365 SSO"})),l.a.createElement("br",null))),this.props.enableLdap&&(n=l.a.createElement("div",{className:"pb-3"},l.a.createElement(gt.a,{className:"btn btn-primary",to:"/claim/email_to_ldap?email="+encodeURIComponent(e.email)},l.a.createElement(g.a,{id:"user.settings.security.switchLdap",defaultMessage:"Switch to Using AD/LDAP"})),l.a.createElement("br",null))),this.props.enableSaml&&(r=l.a.createElement("div",{className:"pb-3"},l.a.createElement(gt.a,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+p.Q.SAML_SERVICE},l.a.createElement(g.a,{id:"user.settings.security.switchSaml",defaultMessage:"Switch to Using SAML SSO"})),l.a.createElement("br",null)));else if(this.props.enableSignUpWithEmail){let a;a=e.auth_service===p.Q.LDAP_SERVICE?"/claim/ldap_to_email?email="+encodeURIComponent(e.email):"/claim/oauth_to_email?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service,t=l.a.createElement("div",{className:"pb-3"},l.a.createElement(gt.a,{className:"btn btn-primary",to:a},l.a.createElement(g.a,{id:"user.settings.security.switchEmail",defaultMessage:"Switch to Using Email and Password"})),l.a.createElement("br",null))}const o=[];o.push(l.a.createElement("div",{key:"userSignInOption"},t,a,s,i,n,r));const c=l.a.createElement("span",null,l.a.createElement(g.a,{id:"user.settings.security.oneSignin",defaultMessage:"You may only have one sign-in method at a time. Switching sign-in method will send an email notifying you if the change was successful."}));return l.a.createElement(v.a,{title:b.jb("user.settings.security.method","Sign-in Method"),extraInfo:c,inputs:o,serverError:this.state.serverError,updateSection:this.handleUpdateSection})}let t=l.a.createElement(g.a,{id:"user.settings.security.emailPwd",defaultMessage:"Email and Password"});return this.props.user.auth_service===p.Q.GITLAB_SERVICE?t=l.a.createElement(g.a,{id:"user.settings.security.gitlab",defaultMessage:"GitLab"}):this.props.user.auth_service===p.Q.GOOGLE_SERVICE?t=l.a.createElement(g.a,{id:"user.settings.security.google",defaultMessage:"Google"}):this.props.user.auth_service===p.Q.OFFICE365_SERVICE?t=l.a.createElement(g.a,{id:"user.settings.security.office365",defaultMessage:"Office 365"}):this.props.user.auth_service===p.Q.LDAP_SERVICE?t=l.a.createElement(g.a,{id:"user.settings.security.ldap",defaultMessage:"AD/LDAP"}):this.props.user.auth_service===p.Q.SAML_SERVICE&&(t=l.a.createElement(g.a,{id:"user.settings.security.saml",defaultMessage:"SAML"})),l.a.createElement(S.a,{title:b.jb("user.settings.security.method","Sign-in Method"),describe:t,section:"signin",updateSection:this.handleUpdateSection})}),Bt(this,"createOAuthAppsSection",()=>{if("apps"===this.props.activeSection){let e;e=this.state.authorizedApps&&this.state.authorizedApps.length>0?this.state.authorizedApps.map(e=>{const t=l.a.createElement("a",{href:e.homepage,target:"_blank",rel:"noopener noreferrer"},e.homepage);return l.a.createElement("div",{key:e.id,className:"pb-3 authorized-app"},l.a.createElement("div",{className:"col-sm-10"},l.a.createElement("div",{className:"authorized-app__name"},e.name,l.a.createElement("span",{className:"authorized-app__url"}," -"," ",t)),l.a.createElement("div",{className:"authorized-app__description"},e.description),l.a.createElement("div",{className:"authorized-app__deauthorize"},l.a.createElement("a",{href:"#","data-app":e.id,onClick:this.deauthorizeApp},l.a.createElement(g.a,{id:"user.settings.security.deauthorize",defaultMessage:"Deauthorize"})))),l.a.createElement("div",{className:"col-sm-2 pull-right"},l.a.createElement("img",{alt:e.name,src:e.icon_url||bt.a})),l.a.createElement("br",null))}):l.a.createElement("div",{className:"pb-3 authorized-app"},l.a.createElement("div",{className:"setting-list__hint"},l.a.createElement(g.a,{id:"user.settings.security.noApps",defaultMessage:"No OAuth 2.0 Applications are authorized."})));const t=[];let a,s;Array.isArray(e)&&(a="authorized-apps__wrapper",s=l.a.createElement("div",{className:"authorized-apps__help"},l.a.createElement(g.a,{id:"user.settings.security.oauthAppsHelp",defaultMessage:"Applications act on your behalf to access your data based on the permissions you grant them."}))),t.push(l.a.createElement("div",{className:a,key:"authorizedApps"},e));const i=l.a.createElement("div",null,l.a.createElement(g.a,{id:"user.settings.security.oauthApps",defaultMessage:"OAuth 2.0 Applications"}),s);return l.a.createElement(v.a,{title:i,inputs:t,serverError:this.state.serverError,updateSection:this.handleUpdateSection,width:"full",cancelButtonText:l.a.createElement(g.a,{id:"user.settings.security.close",defaultMessage:"Close"})})}return l.a.createElement(S.a,{title:b.jb("user.settings.security.oauthApps","OAuth 2.0 Applications"),describe:l.a.createElement(g.a,{id:"user.settings.security.oauthAppsDescription",defaultMessage:"Click 'Edit' to manage your OAuth 2.0 Applications"}),section:"apps",updateSection:this.handleUpdateSection})}),this.state=this.getDefaultState()}getDefaultState(){return{currentPassword:"",newPassword:"",confirmPassword:"",passwordError:"",serverError:"",tokenError:"",authService:this.props.user.auth_service,savingPassword:!1}}componentDidMount(){this.props.enableOAuthServiceProvider&&this.loadAuthorizedOAuthApps()}render(){const e=this.props.user,t=this.createPasswordSection();let a,s,i,n=0;return n=this.props.enableSignUpWithGitLab?n+1:n,n=this.props.enableSignUpWithGoogle?n+1:n,n=this.props.enableSignUpWithOffice365?n+1:n,n=this.props.enableLdap?n+1:n,n=this.props.enableSaml?n+1:n,(this.props.enableSignUpWithEmail||""===e.auth_service)&&n>0&&this.props.experimentalEnableAuthenticationTransfer&&(a=this.createSignInSection()),this.props.enableOAuthServiceProvider&&(s=this.createOAuthAppsSection()),this.props.canUseAccessTokens&&(i=l.a.createElement(qt,{user:this.props.user,active:"tokens"===this.props.activeSection,updateSection:this.handleUpdateSection,setRequireConfirm:this.props.setRequireConfirm})),l.a.createElement("div",null,l.a.createElement("div",{className:"modal-header"},l.a.createElement(g.a,{id:"user.settings.security.close",defaultMessage:"Close"},e=>l.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":e,onClick:this.props.closeModal},l.a.createElement("span",{"aria-hidden":"true"},"×"))),l.a.createElement("h4",{className:"modal-title",ref:"title"},l.a.createElement("div",{className:"modal-back"},l.a.createElement(g.a,{id:"generic_icons.collapse",defaultMessage:"Collapse Icon"},e=>l.a.createElement("i",{className:"fa fa-angle-left",title:e,onClick:this.props.collapseModal}))),l.a.createElement(g.a,{id:"user.settings.security.title",defaultMessage:"Security Settings"}))),l.a.createElement("div",{className:"user-settings"},l.a.createElement("h3",{className:"tab-header"},l.a.createElement(g.a,{id:"user.settings.security.title",defaultMessage:"Security Settings"})),l.a.createElement("div",{className:"divider-dark first"}),t,l.a.createElement("div",{className:"divider-light"}),l.a.createElement(Dt,{active:"mfa"===this.props.activeSection,updateSection:this.handleUpdateSection}),l.a.createElement("div",{className:"divider-light"}),s,l.a.createElement("div",{className:"divider-light"}),i,l.a.createElement("div",{className:"divider-light"}),a,l.a.createElement("div",{className:"divider-dark"}),l.a.createElement("br",null),l.a.createElement(Pt.a,{className:"security-links color--link",dialogType:Ct},l.a.createElement(g.a,{id:"user.settings.security.viewHistory.icon",defaultMessage:"Access History Icon"},e=>l.a.createElement("i",{className:"fa fa-clock-o",title:e})),l.a.createElement(g.a,{id:"user.settings.security.viewHistory",defaultMessage:"View Access History"})),l.a.createElement(Pt.a,{className:"security-links color--link mt-2",dialogType:At},l.a.createElement(g.a,{id:"user.settings.security.logoutActiveSessions.icon",defaultMessage:"Active Sessions Icon"},e=>l.a.createElement("i",{className:"fa fa-clock-o",title:e})),l.a.createElement(g.a,{id:"user.settings.security.logoutActiveSessions",defaultMessage:"View and Log Out of Active Sessions"}))))}}Bt(Gt,"propTypes",{user:r.a.object,activeSection:r.a.string,updateSection:r.a.func,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,setRequireConfirm:r.a.func.isRequired,canUseAccessTokens:r.a.bool,enableOAuthServiceProvider:r.a.bool,enableSignUpWithEmail:r.a.bool,enableSignUpWithGitLab:r.a.bool,enableSignUpWithGoogle:r.a.bool,enableLdap:r.a.bool,enableSaml:r.a.bool,enableSignUpWithOffice365:r.a.bool,experimentalEnableAuthenticationTransfer:r.a.bool,passwordConfig:r.a.object,militaryTime:r.a.bool,actions:r.a.shape({getMe:r.a.func.isRequired,updateUserPassword:r.a.func.isRequired,getAuthorizedOAuthApps:r.a.func.isRequired,deauthorizeOAuthApp:r.a.func.isRequired})}),Bt(Gt,"defaultProps",{user:{},activeSection:""});var Ht=Object(s.connect)((function(e,t){const a=Object(d.getConfig)(e),s="true"===a.EnableUserAccessTokens,i=pt.hasUserAccessTokenRole(t.user.roles)||pt.isSystemAdmin(t.user.roles);return{canUseAccessTokens:s&&i,enableOAuthServiceProvider:"true"===a.EnableOAuthServiceProvider,enableSignUpWithEmail:"true"===a.EnableSignUpWithEmail,enableSignUpWithGitLab:"true"===a.EnableSignUpWithGitLab,enableSignUpWithGoogle:"true"===a.EnableSignUpWithGoogle,enableLdap:"true"===a.EnableLdap,enableSaml:"true"===a.EnableSaml,enableSignUpWithOffice365:"true"===a.EnableSignUpWithOffice365,experimentalEnableAuthenticationTransfer:"true"===a.ExperimentalEnableAuthenticationTransfer,passwordConfig:Object(b.D)(a),militaryTime:Object(u.getBool)(e,p.B.CATEGORY_DISPLAY_SETTINGS,p.B.USE_MILITARY_TIME,!1)}}),(function(e){return{actions:Object(c.bindActionCreators)({getMe:h.getMe,updateUserPassword:h.updateUserPassword,getAuthorizedOAuthApps:ht.getAuthorizedOAuthApps,deauthorizeOAuthApp:ht.deauthorizeOAuthApp},e)}}))(Gt);function Vt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class Yt extends l.a.Component{constructor(e){super(e),Vt(this,"getStateFromProps",()=>{const{closeUnusedDirectMessages:e,channelSwitcherOption:t,channelSidebarOrganizationOption:a,sidebarPreference:{grouping:s,sorting:i},unreadsAtTop:n,favoriteAtTop:r}=this.props;return{settings:{close_unused_direct_messages:e,channel_switcher_section:t,channel_sidebar_organization:a,grouping:s,unreadsAtTop:n,favoriteAtTop:r,sorting:i},isSaving:!1}}),Vt(this,"trackSettingChangeIfNecessary",e=>{this.state.settings[e]!==this.props.sidebarPreference[e]&&Object(He.d)("settings","user_settings_update",{field:"sidebar."+e,value:this.state.settings[e]})}),Vt(this,"updateSetting",(e,t)=>{const a=this.state.settings;a[e]=t,this.setState(a)}),Vt(this,"handleSubmit",e=>{const{actions:t,user:a}=this.props,s=[];if("channel_grouping"===e||"channel_sorting"===e){const e={grouping:this.state.settings.grouping,unreads_at_top:this.state.settings.unreadsAtTop,favorite_at_top:this.state.settings.favoriteAtTop,sorting:this.state.settings.sorting};s.push({user_id:a.id,category:p.Q.Preferences.CATEGORY_SIDEBAR_SETTINGS,name:"",value:JSON.stringify(e)}),this.trackSettingChangeIfNecessary("grouping"),this.trackSettingChangeIfNecessary("sorting"),this.trackSettingChangeIfNecessary("unreadsAtTop"),this.trackSettingChangeIfNecessary("favoriteAtTop"),this.trackSettingChangeIfNecessary("newSidebar")}else s.push({user_id:a.id,category:p.Q.Preferences.CATEGORY_SIDEBAR_SETTINGS,name:e,value:this.state.settings[e]}),Object(He.d)("settings","user_settings_update",{field:"sidebar."+e,value:this.state.settings[e]});this.setState({isSaving:!0}),t.savePreferences(a.id,s).then(()=>{this.updateSection("")})}),Vt(this,"getPreviousSection",e=>{const{showChannelOrganization:t,channelSidebarOrganizationOption:a}=this.props;switch(e){case"autoCloseDM":return"true"===a?"channelSidebarOrganization":"channelSwitcher";case"groupChannels":case"channelSidebarOrganization":return"dummySectionName";case"channelSwitcher":return t?"groupChannels":"dummySectionName";default:return null}}),Vt(this,"updateSection",e=>{this.setState(this.getStateFromProps()),this.setState({isSaving:!1}),this.props.updateSection(e)}),Vt(this,"renderAutoCloseDMLabel",e=>"after_seven_days"===e?l.a.createElement(g.a,{id:"user.settings.sidebar.after_seven_days",defaultMessage:"After 7 days with no new messages"}):l.a.createElement(g.a,{id:"user.settings.sidebar.never",defaultMessage:"Never"})),Vt(this,"renderAutoCloseDMSection",()=>{let e;return e="autoCloseDM"===this.props.activeSection?l.a.createElement(v.a,{title:l.a.createElement(g.a,{id:"user.settings.sidebar.autoCloseDMTitle",defaultMessage:"Automatically Close Direct Messages"}),inputs:[l.a.createElement("fieldset",{key:"autoCloseDMSetting"},l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"autoCloseDMAfterSevenDays",type:"radio",name:"autoCloseDM",checked:"after_seven_days"===this.state.settings.close_unused_direct_messages,onChange:this.updateSetting.bind(this,"close_unused_direct_messages","after_seven_days")}),l.a.createElement(g.a,{id:"user.settings.sidebar.after_seven_days",defaultMessage:"After 7 days with no new messages"}))),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"autoCloseDMNever",type:"radio",name:"autoCloseDM",checked:"never"===this.state.settings.close_unused_direct_messages,onChange:this.updateSetting.bind(this,"close_unused_direct_messages","never")}),l.a.createElement(g.a,{id:"user.settings.sidebar.never",defaultMessage:"Never"}))),l.a.createElement("div",{className:"mt-5"},l.a.createElement(g.a,{id:"user.settings.sidebar.autoCloseDMDesc",defaultMessage:"Direct Message conversations can be reopened with the “+” button in the sidebar or using the Channel Switcher (CTRL+K)."})))],setting:"close_unused_direct_messages",submit:this.handleSubmit,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.updateSection}):l.a.createElement(S.a,{title:l.a.createElement(g.a,{id:"user.settings.sidebar.autoCloseDMTitle",defaultMessage:"Automatically Close Direct Messages"}),describe:this.renderAutoCloseDMLabel(this.state.settings.close_unused_direct_messages),section:"autoCloseDM",updateSection:this.updateSection}),l.a.createElement(l.a.Fragment,null,e,l.a.createElement("div",{className:"divider-dark"}))}),Vt(this,"renderOrganizationLabel",()=>{const{sidebarPreference:{sorting:e,grouping:t},unreadsAtTop:a,favoriteAtTop:s}=this.props,i=[];let n,r;"by_type"===t?i.push(l.a.createElement(g.a,{key:"by_type",id:"user.settings.sidebar.groupByTypeShort",defaultMessage:"Group by channel type"})):i.push(l.a.createElement(g.a,{key:"none",id:"user.settings.sidebar.groupByNoneShort",defaultMessage:"No grouping"})),"alpha"===e?(n=Object(E.b)("user.settings.sidebar.sortAlphaShort"),r="sorted alphabetically"):(n=Object(E.b)("user.settings.sidebar.sortRecentShort"),r="sorted by recency"),i.push(l.a.createElement("span",{key:"comma"},", ")),i.push(l.a.createElement(g.a,{key:"sorting",id:n,defaultMessage:r}));let o=null,c=null;return"true"===a&&"false"===s?(o=Object(E.b)("user.settings.sidebar.unreadsShort"),c="Unreads grouped separately"):"false"===a&&"true"===s?(o=Object(E.b)("user.settings.sidebar.favoritesShort"),c="Favorites grouped separately"):"true"===a&&"true"===s&&(o=Object(E.b)("user.settings.sidebar.unreadsFavoritesShort"),c="Unreads and favorites grouped separately"),o&&(i.push(l.a.createElement("br",{key:"break"})),i.push(l.a.createElement(g.a,{key:"atTop",id:o,defaultMessage:c}))),i}),Vt(this,"renderChannelSwitcherLabel",e=>"true"===e?l.a.createElement(g.a,{id:"user.settings.sidebar.on",defaultMessage:"On"}):l.a.createElement(g.a,{id:"user.settings.sidebar.off",defaultMessage:"Off"})),Vt(this,"renderChannelSidebarOrganizationSection",()=>{const e=l.a.createElement(Te.b,{id:Object(E.b)("user.settings.sidebar.channelSidebarOrganizationSection.desc"),defaultMessage:"When enabled, access experimental channel sidebar features, including collapsible sections and unreads filtering. [Learn more](!https://about.mattermost.com/default-sidebar/) or [give us feedback](!https://about.mattermost.com/default-sidebar-survey/)"});let t=l.a.createElement(S.a,{title:l.a.createElement(g.a,{id:Object(E.b)("user.settings.sidebar.channelSidebarOrganizationSectionTitle"),defaultMessage:"Experimental Sidebar Features"}),describe:this.renderChannelSwitcherLabel(this.props.channelSidebarOrganizationOption),section:"channelSidebarOrganization",updateSection:this.updateSection});return"channelSidebarOrganization"===this.props.activeSection&&(t=l.a.createElement(v.a,{title:l.a.createElement(g.a,{id:Object(E.b)("user.settings.sidebar.channelSidebarOrganizationSectionTitle"),defaultMessage:"Experimental Sidebar Features"}),inputs:[l.a.createElement("fieldset",{key:"channelSidebarOrganizationSectionSetting"},l.a.createElement("legend",{className:"form-legend hidden-label"},l.a.createElement(g.a,{id:Object(E.b)("user.settings.sidebar.channelSidebarOrganizationSectionTitle"),defaultMessage:"Experimental Sidebar Features"})),l.a.createElement("div",{id:"channelSidebarOrganizationRadioOn",className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"channelSidebarOrganizationSectionEnabled",type:"radio",name:"channelSidebarOrganization",checked:"true"===this.state.settings.channel_sidebar_organization,onChange:this.updateSetting.bind(this,"channel_sidebar_organization","true")}),l.a.createElement(g.a,{id:"user.settings.sidebar.on",defaultMessage:"On"})),l.a.createElement("br",null)),l.a.createElement("div",{id:"channelSidebarOrganizationRadioOff",className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"channelSidebarOrganizationSectionOff",type:"radio",name:"channelSidebarOrganization",checked:"false"===this.state.settings.channel_sidebar_organization,onChange:this.updateSetting.bind(this,"channel_sidebar_organization","false")}),l.a.createElement(g.a,{id:"user.settings.sidebar.off",defaultMessage:"Off"})),l.a.createElement("br",null)),l.a.createElement("div",{id:"channelSidebarOrganizationelpText"},l.a.createElement("br",null),e))],setting:"channel_sidebar_organization",submit:this.handleSubmit,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.updateSection})),l.a.createElement(l.a.Fragment,null,t,l.a.createElement("div",{className:"divider-light"}))}),Vt(this,"renderChannelOrganizationSection",()=>{const{grouping:e,sorting:t}=this.state.settings;let a;if("groupChannels"===this.props.activeSection){const s=[];s.push(l.a.createElement("fieldset",{key:"groupingSectionSetting"},l.a.createElement("legend",{className:"form-legend"},l.a.createElement(g.a,{id:"user.settings.sidebar.groupChannelsTitle",defaultMessage:"Channel grouping"})),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"byTypeOption",type:"radio",name:"groupChannels",checked:"by_type"===e,onChange:this.updateSetting.bind(this,"grouping","by_type")}),l.a.createElement(g.a,{id:"user.settings.sidebar.groupByType",defaultMessage:"Channels grouped by type"}))),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"noneOption",type:"radio",name:"groupChannels",checked:"none"===e,onChange:this.updateSetting.bind(this,"grouping","none")}),l.a.createElement(g.a,{id:"user.settings.sidebar.groupByNone",defaultMessage:"Combine all channel types"}))),l.a.createElement("div",{className:"mt-5"},l.a.createElement(g.a,{id:"user.settings.sidebar.groupDesc",defaultMessage:"Group channels by type, or combine all types into a list."})))),s.push(l.a.createElement("hr",{key:"sortingDivider"})),s.push(l.a.createElement("fieldset",{key:"sortingOptions"},l.a.createElement("legend",{className:"form-legend"},l.a.createElement(g.a,{id:"user.settings.sidebar.sortChannelsTitle",defaultMessage:"Channel sorting"})),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"recentSectionEnabled",type:"radio",name:"sortChannels",checked:"recent"===t,onChange:this.updateSetting.bind(this,"sorting","recent")}),l.a.createElement(g.a,{id:"user.settings.sidebar.sortRecent",defaultMessage:"Recency"}))),l.a.createElement("div",{className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"alphaSectionEnabled",type:"radio",name:"sortChannels",checked:"alpha"===t,onChange:this.updateSetting.bind(this,"sorting","alpha")}),l.a.createElement(g.a,{id:"user.settings.sidebar.sortAlpha",defaultMessage:"Alphabetically"}))),l.a.createElement("div",{className:"mt-5"},l.a.createElement(g.a,{id:"user.settings.sidebar.sortDesc",defaultMessage:"Sort channels alphabetically, or by most recent post."})))),s.push(l.a.createElement("hr",{key:"divider"})),s.push(l.a.createElement("fieldset",{key:"unreadOption"},l.a.createElement("div",{className:"checkbox"},l.a.createElement("label",null,l.a.createElement("input",{id:"unreadAtTopOption",type:"checkbox",checked:"true"===this.state.settings.unreadsAtTop,onChange:e=>this.updateSetting("unreadsAtTop",e.target.checked.toString())}),l.a.createElement(g.a,{id:"user.settings.sidebar.unreads",defaultMessage:"Unreads grouped separately"}))),l.a.createElement("div",{className:"mt-5"},l.a.createElement(g.a,{id:"user.settings.sidebar.unreadsDesc",defaultMessage:"Group unread channels separately until read."})))),s.push(l.a.createElement("hr",{key:"groupingDivider"})),s.push(l.a.createElement("fieldset",{key:"favoriteOption"},l.a.createElement("div",{className:"checkbox"},l.a.createElement("label",null,l.a.createElement("input",{id:"favoriteAtTopOption",type:"checkbox",checked:"true"===this.state.settings.favoriteAtTop,onChange:e=>this.updateSetting("favoriteAtTop",e.target.checked.toString())}),l.a.createElement(g.a,{id:"user.settings.sidebar.favorites",defaultMessage:"Favorites grouped separately"}))),l.a.createElement("div",null,l.a.createElement("br",null),l.a.createElement(g.a,{id:"user.settings.sidebar.favoritesDesc",defaultMessage:"Channels marked as favorites will be grouped separately."})))),a=l.a.createElement(v.a,{title:l.a.createElement(g.a,{id:"user.settings.sidebar.groupAndSortChannelsTitle",defaultMessage:"Channel Grouping and Sorting"}),inputs:s,setting:"channel_grouping",submit:this.handleSubmit,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.updateSection})}else a=l.a.createElement(S.a,{title:l.a.createElement(g.a,{id:"user.settings.sidebar.groupAndSortChannelsTitle",defaultMessage:"Channel Grouping and Sorting"}),describe:this.renderOrganizationLabel(),section:"groupChannels",updateSection:this.updateSection});return l.a.createElement(l.a.Fragment,null,a,l.a.createElement("div",{className:"divider-light"}))}),Vt(this,"renderChannelSwitcherSection",()=>{let e=Object(E.b)("user.settings.sidebar.channelSwitcherSectionDesc.windows"),t="The channel switcher is shown at the bottom of the sidebar and is used to jump between channels quickly. It can also be accessed using CTRL + K.";Object(b.Z)()&&(e=Object(E.b)("user.settings.sidebar.channelSwitcherSectionDesc.mac"),t="The channel switcher is shown at the bottom of the sidebar and is used to jump between channels quickly. It can also be accessed using CMD + K.");const a=l.a.createElement(g.a,{id:e,defaultMessage:t});return"channelSwitcher"===this.props.activeSection?l.a.createElement(v.a,{title:l.a.createElement(g.a,{id:"user.settings.sidebar.channelSwitcherSectionTitle",defaultMessage:"Channel Switcher"}),inputs:[l.a.createElement("fieldset",{key:"channelSwitcherSectionSetting"},l.a.createElement("legend",{className:"form-legend hidden-label"},l.a.createElement(g.a,{id:"user.settings.sidebar.channelSwitcherSectionTitle",defaultMessage:"Channel Switcher"})),l.a.createElement("div",{id:"channelSwitcherRadioOn",className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"channelSwitcherSectionEnabled",type:"radio",name:"channelSwitcher",checked:"true"===this.state.settings.channel_switcher_section,onChange:this.updateSetting.bind(this,"channel_switcher_section","true")}),l.a.createElement(g.a,{id:"user.settings.sidebar.on",defaultMessage:"On"})),l.a.createElement("br",null)),l.a.createElement("div",{id:"channelSwitcherRadioOff",className:"radio"},l.a.createElement("label",null,l.a.createElement("input",{id:"channelSwitcherSectionOff",type:"radio",name:"channelSwitcher",checked:"false"===this.state.settings.channel_switcher_section,onChange:this.updateSetting.bind(this,"channel_switcher_section","false")}),l.a.createElement(g.a,{id:"user.settings.sidebar.off",defaultMessage:"Off"})),l.a.createElement("br",null)),l.a.createElement("div",{id:"channelSwitcherHelpText"},l.a.createElement("br",null),a))],setting:"channel_switcher_section",submit:this.handleSubmit,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.updateSection}):l.a.createElement(S.a,{title:l.a.createElement(g.a,{id:"user.settings.sidebar.channelSwitcherSectionTitle",defaultMessage:"Channel Switcher"}),describe:this.renderChannelSwitcherLabel(this.props.channelSwitcherOption),section:"channelSwitcher",updateSection:this.updateSection})}),this.state=this.getStateFromProps()}render(){const{showUnusedOption:e,showChannelOrganization:t,showChannelSidebarOrganization:a,channelSidebarOrganizationOption:s}=this.props,i="false"===s,n=t&&i?this.renderChannelOrganizationSection():null,r=a?this.renderChannelSidebarOrganizationSection():null,o=e?this.renderAutoCloseDMSection():null,c=i?this.renderChannelSwitcherSection():null;return l.a.createElement("div",null,l.a.createElement("div",{className:"modal-header"},l.a.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},l.a.createElement("span",{"aria-hidden":"true"},"×")),l.a.createElement("h4",{className:"modal-title",ref:"title"},l.a.createElement("div",{className:"modal-back",onClick:this.props.collapseModal},l.a.createElement(Y.a,{className:"fa fa-angle-left",title:{id:Object(E.b)("generic_icons.collapse"),defaultMessage:"Collapse Icon"}})),l.a.createElement(g.a,{id:"user.settings.sidebar.title",defaultMessage:"Sidebar Settings"}))),l.a.createElement("div",{id:"sidebarTitle",className:"user-settings"},l.a.createElement("h3",{className:"tab-header"},l.a.createElement(g.a,{id:"user.settings.sidebar.title",defaultMessage:"Sidebar Settings"})),l.a.createElement("div",{className:"divider-dark first"}),r,n,c,e?l.a.createElement("div",{className:"divider-light"}):l.a.createElement("div",{className:"divider-dark"}),o))}}Vt(Yt,"propTypes",{actions:r.a.shape({savePreferences:r.a.func.isRequired}).isRequired,user:r.a.object,closeUnusedDirectMessages:r.a.string.isRequired,showUnusedOption:r.a.bool.isRequired,showChannelOrganization:r.a.bool.isRequired,showChannelSidebarOrganization:r.a.bool.isRequired,channelSwitcherOption:r.a.string.isRequired,channelSidebarOrganizationOption:r.a.string.isRequired,sidebarPreference:r.a.shape({grouping:r.a.string.isRequired,sorting:r.a.string.isRequired}).isRequired,unreadsAtTop:r.a.string.isRequired,favoriteAtTop:r.a.string.isRequired,updateSection:r.a.func,activeSection:r.a.string,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired});var Kt,Wt,Qt,Jt=Object(s.connect)((function(e){const t=Object(d.getConfig)(e),a=Object(u.get)(e,C.Preferences.CATEGORY_SIDEBAR_SETTINGS,"close_unused_direct_messages","after_seven_days"),s=Object(u.get)(e,C.Preferences.CATEGORY_SIDEBAR_SETTINGS,"channel_switcher_section","true"),n=Object(u.getNewSidebarPreference)(e),r=Object(u.getSidebarPreferences)(e);return{closeUnusedDirectMessages:a,sidebarPreference:r,unreadsAtTop:r.unreads_at_top,favoriteAtTop:r.favorite_at_top,channelSwitcherOption:s,channelSidebarOrganizationOption:String(n),showChannelOrganization:"true"===t.ExperimentalChannelOrganization,showChannelSidebarOrganization:"disabled"!==t.ExperimentalChannelSidebarOrganization,showUnusedOption:"true"===t.CloseUnusedDirectMessages,user:Object(i.getCurrentUser)(e)}}),(function(e){return{actions:Object(c.bindActionCreators)({savePreferences:m.savePreferences},e)}}))(Yt);class Xt extends l.a.PureComponent{render(){return"general"===this.props.activeTab?l.a.createElement("div",null,l.a.createElement(Ze,{user:this.props.user,activeSection:this.props.activeSection,updateSection:this.props.updateSection,updateTab:this.props.updateTab,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):"security"===this.props.activeTab?l.a.createElement("div",null,l.a.createElement(Ht,{user:this.props.user,activeSection:this.props.activeSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal,setRequireConfirm:this.props.setRequireConfirm})):"notifications"===this.props.activeTab?l.a.createElement("div",null,l.a.createElement(mt,{user:this.props.user,activeSection:this.props.activeSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):"display"===this.props.activeTab?l.a.createElement("div",null,l.a.createElement(Fe,{user:this.props.user,activeSection:this.props.activeSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal,setEnforceFocus:this.props.setEnforceFocus,setRequireConfirm:this.props.setRequireConfirm})):"sidebar"===this.props.activeTab?l.a.createElement("div",null,l.a.createElement(Jt,{activeSection:this.props.activeSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):"advanced"===this.props.activeTab?l.a.createElement("div",null,l.a.createElement(A,{activeSection:this.props.activeSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):l.a.createElement("div",null)}}Kt=Xt,Wt="propTypes",Qt={user:r.a.object.isRequired,activeTab:r.a.string,activeSection:r.a.string,updateSection:r.a.func,updateTab:r.a.func,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,setEnforceFocus:r.a.func.isRequired,setRequireConfirm:r.a.func.isRequired},Wt in Kt?Object.defineProperty(Kt,Wt,{value:Qt,enumerable:!0,configurable:!0,writable:!0}):Kt[Wt]=Qt;t.default=Object(s.connect)((function(e){return{user:Object(i.getCurrentUser)(e)}}))(Xt)}}]);
//# sourceMappingURL=12.eb6d162bbfb9bf9d22ba.js.map